{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-12T06:54:47.397381Z", "invocation_id": "58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:35.933370Z", "completed_at": "2025-02-12T06:54:35.993636Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:36.012755Z", "completed_at": "2025-02-12T06:54:39.477447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.547171115875244, "adapter_response": {"_message": "CREATE TABLE (26.0 rows, 1.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 26, "bytes_processed": 1437, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "b3b56ef3-3461-46b1-97e6-b76af0a2dc59", "slot_ms": 1291}, "message": "CREATE TABLE (26.0 rows, 1.4 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.prep_books", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`diego_library_final_project`.`books`\n),\n\ncleaned AS (\n    SELECT\n        book_id,\n        title,\n        author,\n        release_year,\n        created_at\n    FROM source\n)\n\nSELECT * FROM cleaned\n", "relation_name": "`purwadika`.`diego_dwh_library_preparation`.`prep_books`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:35.939045Z", "completed_at": "2025-02-12T06:54:36.000150Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:36.031493Z", "completed_at": "2025-02-12T06:54:39.609098Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.678447723388672, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 960.0 Bytes processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 960, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "861b6e30-f392-43b2-a6cd-e701d4209fd7", "slot_ms": 1222}, "message": "CREATE TABLE (20.0 rows, 960.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_dpd.prep_rents", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`diego_library_final_project`.`rents`\n)\n\nSELECT *\nFROM source\n", "relation_name": "`purwadika`.`diego_dwh_library_preparation`.`prep_rents`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:35.951981Z", "completed_at": "2025-02-12T06:54:35.993281Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:35.993873Z", "completed_at": "2025-02-12T06:54:39.718281Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.7873549461364746, "adapter_response": {"_message": "CREATE TABLE (22.0 rows, 1.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 22, "bytes_processed": 1430, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "32be2bb1-a7a5-4aeb-b760-c7ccbad8d7c3", "slot_ms": 1035}, "message": "CREATE TABLE (22.0 rows, 1.4 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.prep_users", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`diego_library_final_project`.`users`\n),\n\ncleaned AS (\n    SELECT\n        user_id,\n        name,\n        email,\n        gender,\n        created_at\n    FROM source\n)\n\nSELECT * FROM cleaned\n", "relation_name": "`purwadika`.`diego_dwh_library_preparation`.`prep_users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:39.484211Z", "completed_at": "2025-02-12T06:54:39.493132Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:39.493504Z", "completed_at": "2025-02-12T06:54:41.953902Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.4722633361816406, "adapter_response": {"_message": "CREATE TABLE (26.0 rows, 1.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 26, "bytes_processed": 1437, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "43db6025-d7c0-47a4-94b9-e73920711d20", "slot_ms": 1041}, "message": "CREATE TABLE (26.0 rows, 1.4 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.dim_books", "compiled": true, "compiled_code": "\n\nWITH books AS (\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_books` \n)\n\nSELECT * FROM books\n", "relation_name": "`purwadika`.`diego_dwh_library_dimfact`.`dim_books`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:39.721254Z", "completed_at": "2025-02-12T06:54:39.724414Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:39.724665Z", "completed_at": "2025-02-12T06:54:42.414990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.696122884750366, "adapter_response": {"_message": "CREATE TABLE (22.0 rows, 1.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 22, "bytes_processed": 1430, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "8954925c-0708-44da-8086-91c28a19a513", "slot_ms": 760}, "message": "CREATE TABLE (22.0 rows, 1.4 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.dim_users", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_users`\n)\n\nSELECT * FROM source\n", "relation_name": "`purwadika`.`diego_dwh_library_dimfact`.`dim_users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:42.424608Z", "completed_at": "2025-02-12T06:54:42.436573Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:42.437129Z", "completed_at": "2025-02-12T06:54:44.849026Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.4264378547668457, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 3.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 3287, "bytes_billed": 31457280, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "fce6d908-ecbc-4709-8e8f-8b7352c44b05", "slot_ms": 1063}, "message": "CREATE TABLE (20.0 rows, 3.2 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.fact_rents", "compiled": true, "compiled_code": "\n\nWITH dim_books AS (\n\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`\n),\n\ndim_users AS (\n\n    SELECT * \n    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`\n),\n\nrents_staging AS (\n\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_rents`\n)\n\nSELECT\nrents_staging.rent_id,\nrents_staging.rent_date AS rent_date,\nrents_staging.return_date AS return_date,\ndim_users.user_id,\ndim_users.name AS user_name,\ndim_users.email AS email,\ndim_books.book_id,\ndim_books.title,\ndim_books.author,\ndim_books.release_year,\nrents_staging.created_at\n\nFROM rents_staging\n\nLEFT JOIN dim_users\non rents_staging.user_id = dim_users.user_id\n\nLEFT JOIN dim_books\non rents_staging.book_id = dim_books.book_id\n\n", "relation_name": "`purwadika`.`diego_dwh_library_dimfact`.`fact_rents`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-12T06:54:44.854120Z", "completed_at": "2025-02-12T06:54:44.859322Z"}, {"name": "execute", "started_at": "2025-02-12T06:54:44.859733Z", "completed_at": "2025-02-12T06:54:47.303366Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.4517059326171875, "adapter_response": {"_message": "CREATE TABLE (20.0 rows, 2.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 20, "bytes_processed": 2102, "bytes_billed": 31457280, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "b683433d-e0ae-4963-a3e2-7beaecfcf211", "slot_ms": 1291}, "message": "CREATE TABLE (20.0 rows, 2.1 KiB processed)", "failures": null, "unique_id": "model.dbt_dpd.dmart_user_book", "compiled": true, "compiled_code": "\n\nWITH fact_rents AS (\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`\n),\n\ndim_users AS (\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`\n),\n\ndim_books AS (\n    SELECT *\n    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`\n)\n\nSELECT \n    fact_rents.user_id,\n    fact_rents.user_name,\n    dim_users.email,\n    DATE(fact_rents.created_at) AS rent_date,\n    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa\n    COALESCE(CEIL(AVG(GREATEST(DATE_DIFF(fact_rents.created_at, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari\n    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user\n    fact_rents.created_at\n\nFROM fact_rents \nLEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id\nLEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id\nGROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at", "relation_name": "`purwadika`.`diego_dwh_library_marts`.`dmart_user_book`", "batch_results": null}], "elapsed_time": 13.603064775466919, "args": {"require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "log_format_file": "debug", "strict_mode": false, "log_level_file": "debug", "invocation_command": "dbt run --full-refresh --target dev", "full_refresh": true, "static_parser": true, "state_modified_compare_vars": false, "partial_parse_file_diff": true, "source_freshness_run_project_hooks": false, "macro_debugging": false, "select": [], "project_dir": "/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd", "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "version_check": true, "log_level": "info", "state_modified_compare_more_unrendered_values": false, "introspect": true, "log_format": "default", "indirect_selection": "eager", "defer": false, "profiles_dir": "/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd", "log_path": "/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs", "vars": {}, "which": "run", "empty": false, "populate_cache": true, "use_colors": true, "show_resource_report": false, "require_nested_cumulative_type_params": false, "cache_selected_only": false, "target": "dev", "skip_nodes_if_on_run_start_fails": false, "log_file_max_bytes": 10485760, "exclude": [], "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "use_colors_file": true, "write_json": true, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "print": true}}