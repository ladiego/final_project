[0m12:03:37.337646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9d9d0>]}


============================== 12:03:37.341893 | faf14708-54f8-40e4-aa62-0445feedfc7f ==============================
[0m12:03:37.341893 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:03:37.342421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:38.615593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faf14708-54f8-40e4-aa62-0445feedfc7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c437920>]}
[0m12:03:38.678043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faf14708-54f8-40e4-aa62-0445feedfc7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd9bf50>]}
[0m12:03:38.678697 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:03:38.919144 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:03:38.921393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:03:38.922145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'faf14708-54f8-40e4-aa62-0445feedfc7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421fa70>]}
[0m12:03:40.343024 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dpd.staging_users' (models/staging/staging_users.sql) depends on a source named 'diego_lbrary.users_data' which was not found
[0m12:03:40.346298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1208398, "process_in_blocks": "0", "process_kernel_time": 0.665418, "process_mem_max_rss": "181878784", "process_out_blocks": "0", "process_user_time": 3.161613}
[0m12:03:40.346732 [debug] [MainThread]: Command `dbt run` failed at 12:03:40.346642 after 3.12 seconds
[0m12:03:40.347213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c473b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12caafdd0>]}
[0m12:03:40.347839 [debug] [MainThread]: Flushing usage events
[0m12:03:41.662215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:32.174280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106606f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c8410>]}


============================== 12:05:32.179053 | e498a59d-35a0-4b88-a6be-2865dc78e0b0 ==============================
[0m12:05:32.179053 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:05:32.179827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:37.959665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e498a59d-35a0-4b88-a6be-2865dc78e0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a16ea0>]}
[0m12:05:38.011102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e498a59d-35a0-4b88-a6be-2865dc78e0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ce3170>]}
[0m12:05:38.011980 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:05:38.218136 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:05:38.219615 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:05:38.220362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e498a59d-35a0-4b88-a6be-2865dc78e0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaaf30>]}
[0m12:05:39.277245 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dpd.staging_users' (models/staging/staging_users.sql) depends on a source named 'diego_lbrary.users_data' which was not found
[0m12:05:39.282162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1671715, "process_in_blocks": "0", "process_kernel_time": 0.740317, "process_mem_max_rss": "205258752", "process_out_blocks": "0", "process_user_time": 3.109371}
[0m12:05:39.284147 [debug] [MainThread]: Command `dbt run` failed at 12:05:39.283599 after 7.17 seconds
[0m12:05:39.285095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127afa8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300aa0c0>]}
[0m12:05:39.286852 [debug] [MainThread]: Flushing usage events
[0m12:05:41.241709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:39.148809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104796630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104796540>]}


============================== 13:29:39.165318 | e70d28b6-0ade-491b-bf2e-d9d22aa54fe3 ==============================
[0m13:29:39.165318 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:29:39.166411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:39.351629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e70d28b6-0ade-491b-bf2e-d9d22aa54fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057553a0>]}
[0m13:29:39.377474 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.47321042, "process_in_blocks": "0", "process_kernel_time": 0.257754, "process_mem_max_rss": "94109696", "process_out_blocks": "0", "process_user_time": 1.239578}
[0m13:29:39.379073 [debug] [MainThread]: Command `dbt clean` succeeded at 13:29:39.378805 after 0.48 seconds
[0m13:29:39.379597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104796630>]}
[0m13:29:39.380137 [debug] [MainThread]: Flushing usage events
[0m13:29:41.109406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:53.678288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110267aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110797d10>]}


============================== 13:29:53.682799 | 8dae3a75-ece3-4e03-88b0-05544e196425 ==============================
[0m13:29:53.682799 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:29:53.683433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:53.788951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dae3a75-ece3-4e03-88b0-05544e196425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076f650>]}
[0m13:29:53.806924 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:53.807715 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:53.809905 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19084829, "process_in_blocks": "0", "process_kernel_time": 0.237703, "process_mem_max_rss": "99008512", "process_out_blocks": "0", "process_user_time": 1.21325}
[0m13:29:53.810437 [debug] [MainThread]: Command `dbt deps` succeeded at 13:29:53.810341 after 0.19 seconds
[0m13:29:53.810749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107943b0>]}
[0m13:29:53.811054 [debug] [MainThread]: Flushing usage events
[0m13:29:55.206036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:14.780306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109494830>]}


============================== 13:30:14.784899 | e4fa331b-fcd9-445d-a09d-7a9e9ebd4a9c ==============================
[0m13:30:14.784899 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:30:14.785685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:30:14.799552 [info ] [MainThread]: dbt version: 1.9.2
[0m13:30:14.799890 [info ] [MainThread]: python version: 3.12.5
[0m13:30:14.800266 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m13:30:14.800507 [info ] [MainThread]: os info: macOS-15.3-arm64-arm-64bit
[0m13:30:16.507625 [info ] [MainThread]: Using profiles dir at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd
[0m13:30:16.508175 [info ] [MainThread]: Using profiles.yml file at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/profiles.yml
[0m13:30:16.508519 [info ] [MainThread]: Using dbt_project.yml file at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/dbt_project.yml
[0m13:30:16.509321 [info ] [MainThread]: adapter type: bigquery
[0m13:30:16.509663 [info ] [MainThread]: adapter version: 1.9.1
[0m13:30:16.591908 [info ] [MainThread]: Configuration:
[0m13:30:16.592364 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:30:16.592617 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:30:16.592837 [info ] [MainThread]: Required dependencies:
[0m13:30:16.593185 [debug] [MainThread]: Executing "git --help"
[0m13:30:16.619565 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:30:16.620967 [debug] [MainThread]: STDERR: "b''"
[0m13:30:16.621507 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:30:16.622435 [info ] [MainThread]: Connection:
[0m13:30:16.623393 [info ] [MainThread]:   method: service-account
[0m13:30:16.623825 [info ] [MainThread]:   database: purwadika
[0m13:30:16.624415 [info ] [MainThread]:   execution_project: purwadika
[0m13:30:16.624836 [info ] [MainThread]:   schema: diego_library_final_project
[0m13:30:16.625199 [info ] [MainThread]:   location: None
[0m13:30:16.625614 [info ] [MainThread]:   priority: None
[0m13:30:16.625962 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:30:16.626308 [info ] [MainThread]:   impersonate_service_account: None
[0m13:30:16.626537 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:30:16.626745 [info ] [MainThread]:   job_retries: 1
[0m13:30:16.627184 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:30:16.627573 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m13:30:16.627905 [info ] [MainThread]:   timeout_seconds: None
[0m13:30:16.628217 [info ] [MainThread]:   client_id: None
[0m13:30:16.628515 [info ] [MainThread]:   token_uri: None
[0m13:30:16.628810 [info ] [MainThread]:   dataproc_region: None
[0m13:30:16.629100 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:30:16.629390 [info ] [MainThread]:   gcs_bucket: None
[0m13:30:16.629693 [info ] [MainThread]:   dataproc_batch: None
[0m13:30:16.630481 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:30:16.799932 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:30:16.800474 [debug] [MainThread]: On debug: select 1 as id
[0m13:30:16.800767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:16.801131 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/gcp_keys.json''
[0m13:30:16.801423 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m13:30:16.801647 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/gcp_keys.json'
[0m13:30:16.801890 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:30:16.802131 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:30:16.802337 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:30:16.802720 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 2.087862, "process_in_blocks": "0", "process_kernel_time": 0.59319, "process_mem_max_rss": "204587008", "process_out_blocks": "0", "process_user_time": 2.173777}
[0m13:30:16.803178 [debug] [MainThread]: Command `dbt debug` failed at 13:30:16.803089 after 2.09 seconds
[0m13:30:16.803538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3421b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f55bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8ceed0>]}
[0m13:30:16.803899 [debug] [MainThread]: Flushing usage events
[0m13:30:18.090834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:08.957047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ddf4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f0c80>]}


============================== 13:43:08.962038 | 81c9e716-634c-4a18-bb0c-4de2207db732 ==============================
[0m13:43:08.962038 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:43:08.962640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:09.125657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81c9e716-634c-4a18-bb0c-4de2207db732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e81eb0>]}
[0m13:43:09.146284 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.26085168, "process_in_blocks": "0", "process_kernel_time": 0.291933, "process_mem_max_rss": "99057664", "process_out_blocks": "0", "process_user_time": 1.368504}
[0m13:43:09.146904 [debug] [MainThread]: Command `dbt clean` succeeded at 13:43:09.146794 after 0.26 seconds
[0m13:43:09.147258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a97b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a94110>]}
[0m13:43:09.147712 [debug] [MainThread]: Flushing usage events
[0m13:43:10.987927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:17.058550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b76c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106296690>]}


============================== 13:43:17.063401 | 16b6fb4f-42c5-4787-b1a9-aa4084da6cb4 ==============================
[0m13:43:17.063401 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:43:17.064064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:17.080136 [info ] [MainThread]: dbt version: 1.9.2
[0m13:43:17.080530 [info ] [MainThread]: python version: 3.12.5
[0m13:43:17.081200 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m13:43:17.081623 [info ] [MainThread]: os info: macOS-15.3-arm64-arm-64bit
[0m13:43:18.797051 [info ] [MainThread]: Using profiles dir at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd
[0m13:43:18.797524 [info ] [MainThread]: Using profiles.yml file at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/profiles.yml
[0m13:43:18.797815 [info ] [MainThread]: Using dbt_project.yml file at /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/dbt_project.yml
[0m13:43:18.798070 [info ] [MainThread]: adapter type: bigquery
[0m13:43:18.798305 [info ] [MainThread]: adapter version: 1.9.1
[0m13:43:18.899260 [info ] [MainThread]: Configuration:
[0m13:43:18.899745 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:43:18.900032 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:43:18.900285 [info ] [MainThread]: Required dependencies:
[0m13:43:18.900828 [debug] [MainThread]: Executing "git --help"
[0m13:43:18.927206 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:43:18.928172 [debug] [MainThread]: STDERR: "b''"
[0m13:43:18.928577 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:43:18.928907 [info ] [MainThread]: Connection:
[0m13:43:18.929604 [info ] [MainThread]:   method: service-account
[0m13:43:18.930144 [info ] [MainThread]:   database: purwadika
[0m13:43:18.930676 [info ] [MainThread]:   execution_project: purwadika
[0m13:43:18.931204 [info ] [MainThread]:   schema: diego_library_final_project
[0m13:43:18.931628 [info ] [MainThread]:   location: None
[0m13:43:18.932044 [info ] [MainThread]:   priority: None
[0m13:43:18.932413 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:43:18.932766 [info ] [MainThread]:   impersonate_service_account: None
[0m13:43:18.933251 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:43:18.933614 [info ] [MainThread]:   job_retries: 1
[0m13:43:18.934048 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:43:18.934554 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m13:43:18.934917 [info ] [MainThread]:   timeout_seconds: None
[0m13:43:18.935403 [info ] [MainThread]:   client_id: None
[0m13:43:18.936084 [info ] [MainThread]:   token_uri: None
[0m13:43:18.936484 [info ] [MainThread]:   dataproc_region: None
[0m13:43:18.936815 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:43:18.937189 [info ] [MainThread]:   gcs_bucket: None
[0m13:43:18.937575 [info ] [MainThread]:   dataproc_batch: None
[0m13:43:18.938659 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:43:19.136462 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:43:19.137084 [debug] [MainThread]: On debug: select 1 as id
[0m13:43:19.137428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:20.149983 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:d03dbaa9-69c7-4d1d-a3cf-225307335f9c&page=queryresults
[0m13:43:21.031776 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:43:21.032615 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:43:21.033468 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.0421696, "process_in_blocks": "0", "process_kernel_time": 0.668349, "process_mem_max_rss": "208486400", "process_out_blocks": "0", "process_user_time": 2.58131}
[0m13:43:21.034485 [debug] [MainThread]: Command `dbt debug` succeeded at 13:43:21.034262 after 4.04 seconds
[0m13:43:21.035006 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:43:21.035550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132013350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b76c30>]}
[0m13:43:21.036171 [debug] [MainThread]: Flushing usage events
[0m13:43:22.288620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:38.433430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b31340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c8380>]}


============================== 13:43:38.439084 | f049f64c-98c9-445b-94f9-43a02e203295 ==============================
[0m13:43:38.439084 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:43:38.439862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:40.243455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f049f64c-98c9-445b-94f9-43a02e203295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294d40>]}
[0m13:43:40.297510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f049f64c-98c9-445b-94f9-43a02e203295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107279a60>]}
[0m13:43:40.298401 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:43:40.525345 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:43:40.526200 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:43:40.526579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f049f64c-98c9-445b-94f9-43a02e203295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106267f20>]}
[0m13:43:41.621605 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dpd.dim_users' (models/dimfact/dim_users.sql) depends on a node named 'users_staging' which was not found
[0m13:43:41.623003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2574012, "process_in_blocks": "0", "process_kernel_time": 0.650087, "process_mem_max_rss": "201506816", "process_out_blocks": "0", "process_user_time": 3.466915}
[0m13:43:41.623708 [debug] [MainThread]: Command `dbt run` failed at 13:43:41.623589 after 3.26 seconds
[0m13:43:41.624194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107242240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125360ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105151430>]}
[0m13:43:41.624608 [debug] [MainThread]: Flushing usage events
[0m13:43:42.893906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:31.177056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8200>]}


============================== 13:44:31.181806 | 1512f146-6252-48df-8030-0a28049e4ff6 ==============================
[0m13:44:31.181806 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:44:31.182447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:33.099725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1512f146-6252-48df-8030-0a28049e4ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c9fa0>]}
[0m13:44:33.174574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1512f146-6252-48df-8030-0a28049e4ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641fe60>]}
[0m13:44:33.175543 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:44:33.430256 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:44:33.431097 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:44:33.431432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1512f146-6252-48df-8030-0a28049e4ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106867f50>]}
[0m13:44:34.717826 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dpd.dim_books' (models/dimfact/dim_books.sql) depends on a node named 'books_staging' which was not found
[0m13:44:34.719127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6126244, "process_in_blocks": "0", "process_kernel_time": 0.747977, "process_mem_max_rss": "202883072", "process_out_blocks": "0", "process_user_time": 3.60381}
[0m13:44:34.719879 [debug] [MainThread]: Command `dbt run` failed at 13:44:34.719746 after 3.61 seconds
[0m13:44:34.720453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106818cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a777fe0>]}
[0m13:44:34.720992 [debug] [MainThread]: Flushing usage events
[0m13:44:36.575169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:29.039189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c8350>]}


============================== 13:45:29.045808 | 84283c34-656d-4695-bb80-e1e7878408c1 ==============================
[0m13:45:29.045808 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:45:29.046478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:30.919214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c9df0>]}
[0m13:45:30.971590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105434920>]}
[0m13:45:30.972269 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:45:31.178807 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:45:31.179688 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:45:31.180068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159555580>]}
[0m13:45:32.376134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.datamarts
- models.purwadika.dimfact
- models.purwadika.staging
[0m13:45:32.394492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ab80e0>]}
[0m13:45:32.498565 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:45:32.505107 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:45:32.533505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159af6450>]}
[0m13:45:32.534058 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:45:32.534621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b24980>]}
[0m13:45:32.537290 [info ] [MainThread]: 
[0m13:45:32.537813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:32.538177 [info ] [MainThread]: 
[0m13:45:32.538818 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:32.543918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:45:32.544333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:33.309113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m13:45:33.309883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:33.767728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104675d30>]}
[0m13:45:33.768468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:33.923561 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m13:45:33.924240 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m13:45:33.924697 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m13:45:33.925262 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m13:45:33.925965 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m13:45:33.926536 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m13:45:33.927178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m13:45:33.927852 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m13:45:33.928377 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m13:45:33.928781 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m13:45:33.929162 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m13:45:33.929513 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m13:45:33.940562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m13:45:33.946855 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m13:45:33.950517 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m13:45:33.951913 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m13:45:33.952411 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m13:45:33.975064 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m13:45:34.125684 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m13:45:34.128039 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m13:45:34.132059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m13:45:34.133995 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:45:34.134529 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:45:34.135255 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:45:34.135859 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:45:34.136331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:34.136695 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:45:35.081767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:104de83d-b081-461b-af3f-e55223198766&page=queryresults
[0m13:45:35.313767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:eec52458-7b1f-40d7-ae11-73071900c6dc&page=queryresults
[0m13:45:35.314537 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7e8ff458-29ec-44fc-b7d9-de2430a07461&page=queryresults
[0m13:45:37.208440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159f31a60>]}
[0m13:45:37.209319 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15938fda0>]}
[0m13:45:37.210708 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.28s]
[0m13:45:37.211394 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.28s]
[0m13:45:37.212341 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m13:45:37.212845 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m13:45:37.213935 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m13:45:37.214440 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m13:45:37.215094 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m13:45:37.215511 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:45:37.222731 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:45:37.223228 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m13:45:37.224637 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m13:45:37.225220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m13:45:37.225593 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:45:37.229501 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:45:37.232670 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m13:45:37.239572 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m13:45:37.244135 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:45:37.251182 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:45:37.254030 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m13:45:37.255025 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:45:37.255638 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    );
  
[0m13:45:37.256585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:45:37.560275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ae74a0>]}
[0m13:45:37.561601 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.63s]
[0m13:45:37.563174 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m13:45:37.975063 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8214e2fd-18dd-4216-b398-6dac53feee73&page=queryresults
[0m13:45:37.985818 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4f6b345a-a88b-4684-be66-d1a6601c55b9&page=queryresults
[0m13:45:39.918832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ae6ed0>]}
[0m13:45:39.921627 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.69s]
[0m13:45:39.922859 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m13:45:39.996936 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aa33c50>]}
[0m13:45:39.997694 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.78s]
[0m13:45:39.998394 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m13:45:39.999770 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m13:45:40.000360 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m13:45:40.001068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m13:45:40.001476 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:45:40.180814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:45:40.181941 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:45:40.186288 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:45:40.187431 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:45:40.187954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:40.753141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dc0d5244-d62f-4ad2-823d-fb7939e0a22a&page=queryresults
[0m13:45:42.833524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aaa97f0>]}
[0m13:45:42.836843 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.83s]
[0m13:45:42.837860 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:45:42.839587 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:45:42.840249 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m13:45:42.840907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m13:45:42.841268 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:45:42.849841 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:45:42.850943 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:45:42.856329 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:45:42.857312 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      


WITH fact_rents AS(

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
)

SELECT 

    fact_rents.user_id,
    DATE(fact_rents.created_at) AS rent_date,
    fact_rents.user_name,
    fact_rents.email,
    COUNT(fact_rents.book_id) AS sum_of_book,

FROM fact_rents
GROUP BY user_name, user_id
    );
  
[0m13:45:42.857810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:45:43.465932 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:97e3e0ec-e9ca-4442-a7f4-25d4b180d8e8&page=queryresults
[0m13:45:43.553223 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:97e3e0ec-e9ca-4442-a7f4-25d4b180d8e8&page=queryresults
[0m13:45:43.566921 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [25:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:45:43.567680 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84283c34-656d-4695-bb80-e1e7878408c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ef8d70>]}
[0m13:45:43.568473 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.73s]
[0m13:45:43.569274 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:45:43.569905 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [25:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m13:45:43.573639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:43.698003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:43.698405 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:45:43.698669 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m13:45:43.698896 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:45:43.699122 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m13:45:43.699510 [info ] [MainThread]: 
[0m13:45:43.699818 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.16 seconds (11.16s).
[0m13:45:43.701609 [debug] [MainThread]: Command end result
[0m13:45:43.727409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:45:43.731792 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:45:43.738811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:45:43.739153 [info ] [MainThread]: 
[0m13:45:43.739563 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:45:43.739947 [info ] [MainThread]: 
[0m13:45:43.740611 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [25:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:45:43.741059 [info ] [MainThread]: 
[0m13:45:43.741396 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:45:43.742159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.779337, "process_in_blocks": "0", "process_kernel_time": 0.987979, "process_mem_max_rss": "216465408", "process_out_blocks": "0", "process_user_time": 5.8265}
[0m13:45:43.742844 [debug] [MainThread]: Command `dbt run` failed at 13:45:43.742742 after 14.78 seconds
[0m13:45:43.743389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052dc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b66f00>]}
[0m13:45:43.743742 [debug] [MainThread]: Flushing usage events
[0m13:45:45.049456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:27.410550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c82f0>]}


============================== 14:01:27.416842 | 2098b6c1-223e-48a8-bf18-965e1a3cbca5 ==============================
[0m14:01:27.416842 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:01:27.417535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:01:29.911367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2098b6c1-223e-48a8-bf18-965e1a3cbca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108381a60>]}
[0m14:01:29.991882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2098b6c1-223e-48a8-bf18-965e1a3cbca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7ff80>]}
[0m14:01:29.993281 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:01:30.254461 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:01:30.435033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:30.435943 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m14:01:30.658244 [error] [MainThread]: Encountered an error:
Compilation Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  expected token ',', got '='
    line 3
      --         materialized='incremental',
[0m14:01:30.659313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3671598, "process_in_blocks": "0", "process_kernel_time": 0.982343, "process_mem_max_rss": "202326016", "process_out_blocks": "0", "process_user_time": 3.581664}
[0m14:01:30.660807 [debug] [MainThread]: Command `dbt run` failed at 14:01:30.660359 after 3.37 seconds
[0m14:01:30.661717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa168d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd44c50>]}
[0m14:01:30.662402 [debug] [MainThread]: Flushing usage events
[0m14:01:32.447360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:42.316960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f69070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105693fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105693e60>]}


============================== 14:02:42.322523 | 374ea352-fe46-4a72-9e2b-8e367fa089eb ==============================
[0m14:02:42.322523 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:02:42.323223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:42.570264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '374ea352-fe46-4a72-9e2b-8e367fa089eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103081b20>]}
[0m14:02:42.597457 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.4163024, "process_in_blocks": "0", "process_kernel_time": 0.499292, "process_mem_max_rss": "92422144", "process_out_blocks": "0", "process_user_time": 1.976341}
[0m14:02:42.598204 [debug] [MainThread]: Command `dbt clean` succeeded at 14:02:42.598044 after 0.42 seconds
[0m14:02:42.598698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f69070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105693fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566f110>]}
[0m14:02:42.599343 [debug] [MainThread]: Flushing usage events
[0m14:02:43.861609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:57.997643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c4500>]}


============================== 14:02:58.003118 | 1c43cfb8-b871-4682-abf5-75d05c0fe8c5 ==============================
[0m14:02:58.003118 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:02:58.003903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:03:00.364195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105496150>]}
[0m14:03:00.436584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9d3e30>]}
[0m14:03:00.437676 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:03:00.728012 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:03:00.729984 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:03:00.730703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e2660>]}
[0m14:03:02.373562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.datamarts
- models.purwadika.staging
- models.purwadika.dimfact
[0m14:03:02.400411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d4440>]}
[0m14:03:02.532686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:03:02.537075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:03:02.585997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4f1b80>]}
[0m14:03:02.586683 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:03:02.587063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f526b40>]}
[0m14:03:02.589620 [info ] [MainThread]: 
[0m14:03:02.590104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:02.590536 [info ] [MainThread]: 
[0m14:03:02.591649 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:03:02.599543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:03:02.600482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:03.597211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:03:03.598511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:04.097490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104006a20>]}
[0m14:03:04.098522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:04.255881 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:03:04.256554 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:03:04.257112 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:03:04.257898 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:03:04.258749 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:03:04.259502 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:03:04.260112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:03:04.260827 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:03:04.261430 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:03:04.261883 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:03:04.262334 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:03:04.262808 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:03:04.287543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:03:04.306282 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:03:04.307498 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:03:04.308861 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:03:04.309407 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:03:04.309869 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:03:04.417306 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:04.423743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:03:04.424482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:05.269693 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:03:05.271842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:03:05.272353 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:03:05.274495 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:03:05.275256 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:03:05.277225 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:03:05.619041 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:236b47ea-f783-44c4-b811-5a447aa57c6b&page=queryresults
[0m14:03:05.669367 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:61605f55-ce66-48a2-822c-53b7479b1980&page=queryresults
[0m14:03:06.724274 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4d226cfe-1d9e-4c82-90b0-df6d5c4591be&page=queryresults
[0m14:03:07.389074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef2f950>]}
[0m14:03:07.390448 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.13s]
[0m14:03:07.391224 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:03:08.114672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f50e120>]}
[0m14:03:08.118476 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.85s]
[0m14:03:08.119348 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:03:08.121795 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m14:03:08.122993 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:03:08.124339 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m14:03:08.125018 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:03:08.138870 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:03:08.142866 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m14:03:08.148838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:03:08.604828 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:03:08.609018 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:03:08.670198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f859dc0>]}
[0m14:03:08.671777 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 4.41s]
[0m14:03:08.672704 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:03:08.673908 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m14:03:08.674778 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:03:08.675670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m14:03:08.676425 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:03:08.689231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:03:08.690282 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m14:03:08.696486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:08.921673 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:176c885a-9352-4318-8900-d70a2919ca87&page=queryresults
[0m14:03:09.180520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:03:09.181890 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:03:09.514154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c08cbac9-dc88-489e-a727-6f14e4e7ec08&page=queryresults
[0m14:03:10.589315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd94f0>]}
[0m14:03:10.590720 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.46s]
[0m14:03:10.591484 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m14:03:11.171545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f523ef0>]}
[0m14:03:11.172595 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.50s]
[0m14:03:11.173316 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m14:03:11.175188 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m14:03:11.175802 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:03:11.177106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m14:03:11.180388 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:03:11.189841 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:03:11.191032 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:03:11.202375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:03:11.771186 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:03:11.781338 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:03:12.132373 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:17d5c45c-1155-42c3-8bec-b1777c183dcb&page=queryresults
[0m14:03:14.058001 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd58f80>]}
[0m14:03:14.060544 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.88s]
[0m14:03:14.061589 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:03:14.064049 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:03:14.064694 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:03:14.065369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m14:03:14.066040 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:03:14.078783 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:03:14.080172 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:03:14.129382 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:03:14.130981 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    f.user_id,
    u.user_name,
    u.email,
    DATE(f.created_at) AS rent_date,
    COUNT(f.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    AVG(DATE_DIFF(f.return_date, f.created_at, DAY)) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    ARRAY_AGG(DISTINCT b.category ORDER BY COUNT(*) DESC LIMIT 1)[SAFE_OFFSET(0)] AS most_frequent_category -- Kategori buku yang paling sering dipinjam

FROM fact_rents f
LEFT JOIN dim_users u ON f.user_id = u.user_id
LEFT JOIN dim_books b ON f.book_id = b.book_id

GROUP BY f.user_id, u.user_name, u.email, rent_date;
    );
  
[0m14:03:14.132552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:03:14.958683 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:e4f8d13b-660a-4b94-aba5-cbefa2bb1b4b&page=queryresults
[0m14:03:14.959715 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:e4f8d13b-660a-4b94-aba5-cbefa2bb1b4b&page=queryresults
[0m14:03:14.974744 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:03:14.975697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c43cfb8-b871-4682-abf5-75d05c0fe8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcbd490>]}
[0m14:03:14.976623 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.91s]
[0m14:03:14.977328 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:03:14.978143 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:03:14.986370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:15.152323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:15.152833 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m14:03:15.153153 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:03:15.153443 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:03:15.153708 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:03:15.154244 [info ] [MainThread]: 
[0m14:03:15.154627 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m14:03:15.156842 [debug] [MainThread]: Command end result
[0m14:03:15.380551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:03:15.383131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:03:15.391708 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:03:15.392246 [info ] [MainThread]: 
[0m14:03:15.392868 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:03:15.393290 [info ] [MainThread]: 
[0m14:03:15.393883 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:03:15.394378 [info ] [MainThread]: 
[0m14:03:15.394875 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:03:15.395511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.479517, "process_in_blocks": "0", "process_kernel_time": 1.430377, "process_mem_max_rss": "217235456", "process_out_blocks": "0", "process_user_time": 7.179351}
[0m14:03:15.396097 [debug] [MainThread]: Command `dbt run` failed at 14:03:15.395994 after 17.48 seconds
[0m14:03:15.396515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105464350>]}
[0m14:03:15.396900 [debug] [MainThread]: Flushing usage events
[0m14:03:17.073555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:15.800342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070276e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc83e0>]}


============================== 14:08:15.806416 | 0a2cf607-37fc-4072-92ab-54ce322da9fb ==============================
[0m14:08:15.806416 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:08:15.807234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:18.349429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705a2d0>]}
[0m14:08:18.449706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a604080>]}
[0m14:08:18.450974 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:08:18.737452 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:08:18.919550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:08:18.920531 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m14:08:19.294789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.datamarts
- models.purwadika.staging
- models.purwadika.dimfact
[0m14:08:19.316156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12abdae40>]}
[0m14:08:19.450625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:08:19.462295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:08:19.505607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad852e0>]}
[0m14:08:19.506832 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:08:19.507866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a6e2090>]}
[0m14:08:19.512536 [info ] [MainThread]: 
[0m14:08:19.513422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:19.514739 [info ] [MainThread]: 
[0m14:08:19.515995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:08:19.524936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:08:19.526109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:20.417520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:08:20.418880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:20.948818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a5ac6b0>]}
[0m14:08:20.950370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:21.119961 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:08:21.120786 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:08:21.122393 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:08:21.121835 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:08:21.123362 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:08:21.124776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:08:21.125573 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:08:21.123963 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:08:21.126333 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:08:21.126979 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:08:21.127985 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:08:21.174444 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:08:21.197576 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:08:21.199348 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:08:21.200068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:08:21.201493 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:08:21.202018 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:08:21.209322 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:08:21.391583 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:21.392569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:21.390088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:22.386595 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:08:22.390732 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:08:22.391056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:08:22.393601 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:08:22.394313 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:08:22.395059 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:08:22.771030 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:52285cd0-ebae-4dcb-91f7-d3f1be0d8361&page=queryresults
[0m14:08:22.830835 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2ce54d56-ea45-4700-a506-9122dac030d2&page=queryresults
[0m14:08:23.010216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f3ef8bff-90ac-46b9-8f9e-85a8830e8278&page=queryresults
[0m14:08:24.564182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a52ff50>]}
[0m14:08:24.566264 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.43s]
[0m14:08:24.567240 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:08:24.568545 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m14:08:24.569253 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:08:24.570012 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m14:08:24.570473 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:08:24.577591 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:08:24.578693 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m14:08:24.582817 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:24.776797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a661370>]}
[0m14:08:24.778367 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.65s]
[0m14:08:24.780163 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:08:24.781780 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m14:08:24.782725 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:08:24.783749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m14:08:24.784387 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:08:24.791268 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:08:24.792827 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m14:08:24.796296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:24.980978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbaa510>]}
[0m14:08:24.982339 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.86s]
[0m14:08:24.983224 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:08:25.287425 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:08:25.290038 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:08:25.306733 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:08:25.308585 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:08:25.614682 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:91f8cae1-bc9b-4534-acb6-f0f3b4dbffd0&page=queryresults
[0m14:08:25.654259 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fa8f1e60-3384-466b-84c6-28d193bb11bd&page=queryresults
[0m14:08:27.550447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0d8bc0>]}
[0m14:08:27.553955 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.77s]
[0m14:08:27.555007 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m14:08:27.746636 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0e4fe0>]}
[0m14:08:27.747431 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.18s]
[0m14:08:27.748090 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m14:08:27.751404 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m14:08:27.752051 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:08:27.752657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m14:08:27.753074 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:08:27.770616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:08:27.772776 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:08:27.778320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:28.287901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:08:28.296121 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:08:28.568061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6e6671c3-0f83-4c9e-84fc-5a91b91bb13d&page=queryresults
[0m14:08:30.519090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf13da0>]}
[0m14:08:30.521376 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.77s]
[0m14:08:30.522837 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:08:30.528471 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:08:30.529566 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:08:30.531080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m14:08:30.532217 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:08:30.553224 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:08:30.555221 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:08:30.612060 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:08:30.613316 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    f.user_id,
    u.user_name,
    u.email,
    DATE(f.created_at) AS rent_date,
    COUNT(f.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    AVG(DATE_DIFF(f.return_date, f.created_at, DAY)) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    MIN(b.release_year) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents f
LEFT JOIN dim_users u ON f.user_id = u.user_id
LEFT JOIN dim_books b ON f.book_id = b.book_id

GROUP BY f.user_id, u.user_name, u.email, rent_date;
    );
  
[0m14:08:30.613913 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:31.352576 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:a7771b53-15bc-4456-a1e8-2b24c7e4630b&page=queryresults
[0m14:08:31.354134 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:a7771b53-15bc-4456-a1e8-2b24c7e4630b&page=queryresults
[0m14:08:31.378823 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:08:31.380796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a2cf607-37fc-4072-92ab-54ce322da9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d10bbf0>]}
[0m14:08:31.384038 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.85s]
[0m14:08:31.385240 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:08:31.386135 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:08:31.395592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:31.566570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:31.567136 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:08:31.567465 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:08:31.567782 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:08:31.568058 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m14:08:31.568598 [info ] [MainThread]: 
[0m14:08:31.568979 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.05 seconds (12.05s).
[0m14:08:31.572409 [debug] [MainThread]: Command end result
[0m14:08:31.610847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:08:31.614416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:08:31.623543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:08:31.624041 [info ] [MainThread]: 
[0m14:08:31.624452 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:31.624809 [info ] [MainThread]: 
[0m14:08:31.625199 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:52]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:08:31.625717 [info ] [MainThread]: 
[0m14:08:31.626743 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:08:31.628574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.933336, "process_in_blocks": "0", "process_kernel_time": 1.513962, "process_mem_max_rss": "203636736", "process_out_blocks": "0", "process_user_time": 6.492046}
[0m14:08:31.630095 [debug] [MainThread]: Command `dbt run` failed at 14:08:31.629865 after 15.94 seconds
[0m14:08:31.631156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a19ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12997f8f0>]}
[0m14:08:31.632126 [debug] [MainThread]: Flushing usage events
[0m14:08:33.685895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:51.325551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146a9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cc41a0>]}


============================== 14:14:51.330606 | fadbe986-3f20-4580-b5ea-338e241a175b ==============================
[0m14:14:51.330606 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:14:51.331453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:51.511576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fadbe986-3f20-4580-b5ea-338e241a175b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d59280>]}
[0m14:14:51.542714 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.310854, "process_in_blocks": "0", "process_kernel_time": 0.333613, "process_mem_max_rss": "96681984", "process_out_blocks": "0", "process_user_time": 1.549225}
[0m14:14:51.543474 [debug] [MainThread]: Command `dbt clean` succeeded at 14:14:51.543340 after 0.31 seconds
[0m14:14:51.543970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d81c10>]}
[0m14:14:51.544495 [debug] [MainThread]: Flushing usage events
[0m14:14:53.236945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:43.346883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132aafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113962090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11362a420>]}


============================== 14:15:43.353516 | 537472fd-08f3-443e-b149-7a3ae68ddf8d ==============================
[0m14:15:43.353516 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:15:43.354513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:45.541551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a42b10>]}
[0m14:15:45.613535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113165430>]}
[0m14:15:45.614360 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:15:45.874583 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:15:45.875842 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:15:45.876345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134087a40>]}
[0m14:15:47.282619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.datamarts
- models.purwadika.staging
- models.purwadika.dimfact
[0m14:15:47.299015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134087ec0>]}
[0m14:15:47.388618 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:15:47.398053 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:15:47.426653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13459af00>]}
[0m14:15:47.427294 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:15:47.427704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134638aa0>]}
[0m14:15:47.430026 [info ] [MainThread]: 
[0m14:15:47.430650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:47.431135 [info ] [MainThread]: 
[0m14:15:47.431852 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:15:47.436999 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:15:47.437811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:48.542050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:15:48.542908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:48.986565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13459c770>]}
[0m14:15:48.987670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:49.144675 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:15:49.145878 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:15:49.146391 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:15:49.145456 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:15:49.147103 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:15:49.148146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:15:49.147710 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:15:49.148906 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:15:49.149342 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:15:49.149808 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:15:49.150334 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:15:49.157327 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:15:49.170628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:15:49.180003 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:15:49.184607 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:15:49.186321 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:15:49.186797 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:15:49.192588 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:15:49.310902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:49.313076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:15:49.308113 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:50.269876 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:15:50.270716 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:15:50.271853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:15:50.273685 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:15:50.276908 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:15:50.278119 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:15:50.622063 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f94ed8b9-279b-47fe-9129-3063db60f69e&page=queryresults
[0m14:15:50.654239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7bc09169-e0b7-478d-8c96-98c3abe3765d&page=queryresults
[0m14:15:50.745050 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6510d782-e33c-447d-b9d4-8d07c38dadca&page=queryresults
[0m14:15:52.715040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13402fb00>]}
[0m14:15:52.717152 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.56s]
[0m14:15:52.718084 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:15:52.719858 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m14:15:52.720597 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:15:52.721384 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m14:15:52.721844 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:15:52.731050 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:15:52.732114 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m14:15:52.735621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:52.910055 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134550590>]}
[0m14:15:52.911102 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.76s]
[0m14:15:52.911817 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:15:52.992970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134eb6750>]}
[0m14:15:52.993708 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.84s]
[0m14:15:52.994321 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:15:52.994938 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m14:15:52.995511 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:15:52.995951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m14:15:52.996302 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:15:53.000983 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:15:53.001951 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m14:15:53.008395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:15:53.355981 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:15:53.357319 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:15:53.444998 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:15:53.446142 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:15:53.663778 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bbbf02be-f206-4107-8164-4a419163d467&page=queryresults
[0m14:15:53.743888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:64c409a4-affb-4e09-90f4-243bbbb5dec1&page=queryresults
[0m14:15:55.536199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134eb30e0>]}
[0m14:15:55.537363 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.81s]
[0m14:15:55.539002 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m14:15:55.670053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ed8a40>]}
[0m14:15:55.671281 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.67s]
[0m14:15:55.672107 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m14:15:55.673486 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m14:15:55.674157 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:15:55.674788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m14:15:55.675332 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:15:55.683792 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:15:55.685003 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:15:55.689697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:56.279517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:15:56.281221 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:15:56.558256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6ab87368-ed33-42ba-92ee-582e3e45d8d2&page=queryresults
[0m14:15:58.750552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13449a7b0>]}
[0m14:15:58.753001 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 3.07s]
[0m14:15:58.756372 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:15:58.760015 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:15:58.760697 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:15:58.761353 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m14:15:58.762524 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:15:58.776504 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:15:58.779851 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:15:58.829115 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:15:58.830200 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    f.user_id,
    u.user_name,
    u.email,
    DATE(f.created_at) AS rent_date,
    COUNT(f.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(f.return_date, f.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(b.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents f
LEFT JOIN dim_users u ON f.user_id = u.user_id
LEFT JOIN dim_books b ON f.book_id = b.book_id

GROUP BY f.user_id, u.user_name, u.email, DATE(f.created_at);
    );
  
[0m14:15:58.830676 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:15:59.572208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1194445f-b2c1-4b50-a652-35e2ff856f67&page=queryresults
[0m14:15:59.573705 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1194445f-b2c1-4b50-a652-35e2ff856f67&page=queryresults
[0m14:15:59.592608 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:61]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:15:59.593859 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537472fd-08f3-443e-b149-7a3ae68ddf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f92a80>]}
[0m14:15:59.595334 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.83s]
[0m14:15:59.596645 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:15:59.597787 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:61]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:15:59.607138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:59.777322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:59.778356 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:15:59.778993 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:15:59.779737 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m14:15:59.780388 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:15:59.781758 [info ] [MainThread]: 
[0m14:15:59.782484 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.35 seconds (12.35s).
[0m14:15:59.785329 [debug] [MainThread]: Command end result
[0m14:16:00.067259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:16:00.069609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:16:00.075840 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:16:00.076197 [info ] [MainThread]: 
[0m14:16:00.076532 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:16:00.076803 [info ] [MainThread]: 
[0m14:16:00.077277 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Expected ")" but got ";" at [43:61]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:16:00.077859 [info ] [MainThread]: 
[0m14:16:00.078498 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:16:00.079877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.845354, "process_in_blocks": "0", "process_kernel_time": 1.260674, "process_mem_max_rss": "215351296", "process_out_blocks": "0", "process_user_time": 6.790092}
[0m14:16:00.080843 [debug] [MainThread]: Command `dbt run` failed at 14:16:00.080737 after 16.85 seconds
[0m14:16:00.081399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113277ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6ef00>]}
[0m14:16:00.083143 [debug] [MainThread]: Flushing usage events
[0m14:16:02.291045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:14.947600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ef680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c43b0>]}


============================== 14:30:14.953441 | a27242cb-b348-4b15-997a-bac20ea4ebb0 ==============================
[0m14:30:14.953441 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:30:14.954234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:17.118346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106658e00>]}
[0m14:30:17.190096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edfa70>]}
[0m14:30:17.191143 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:30:17.420621 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:30:17.521440 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:30:17.522109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c34b410>]}
[0m14:30:18.871275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dimfact
- models.staging
- models.datamarts
[0m14:30:18.884839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc387a0>]}
[0m14:30:18.974343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:30:18.978160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:30:19.007233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc5ecf0>]}
[0m14:30:19.007857 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:30:19.008250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc73c50>]}
[0m14:30:19.010473 [info ] [MainThread]: 
[0m14:30:19.010906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:19.011221 [info ] [MainThread]: 
[0m14:30:19.011768 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:19.016293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:30:19.016754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:19.962046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:30:19.963253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:20.493408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105106a80>]}
[0m14:30:20.494219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:20.658988 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:30:20.659796 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:30:20.661707 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:30:20.661217 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:30:20.662346 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:30:20.663173 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:30:20.663914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:30:20.666037 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:30:20.666529 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:30:20.666927 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:30:20.667351 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:30:20.668003 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:30:20.693624 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:30:20.695993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:30:20.700249 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:30:20.702075 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:30:20.702647 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:30:20.703087 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:30:20.870521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:30:20.873940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:20.877966 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:21.794938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:30:21.800707 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:30:21.790930 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:30:21.802799 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:30:21.803494 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:30:21.804208 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:30:22.145052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e3c3ee9a-76a0-4201-b423-c487d6e76324&page=queryresults
[0m14:30:22.173503 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:da498e31-a4c7-4af2-9cbb-ae131e0f873f&page=queryresults
[0m14:30:22.174935 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9b57dc9a-ad45-46a0-b8f3-bec45f037b10&page=queryresults
[0m14:30:24.103960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643a930>]}
[0m14:30:24.104938 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.44s]
[0m14:30:24.107297 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:30:24.108395 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m14:30:24.109227 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:30:24.110035 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m14:30:24.110623 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:30:24.119558 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:30:24.121168 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m14:30:24.126978 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:30:24.634254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ccc16a0>]}
[0m14:30:24.637087 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.97s]
[0m14:30:24.637916 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:30:24.646029 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc33770>]}
[0m14:30:24.646987 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.98s]
[0m14:30:24.647938 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:30:24.648735 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m14:30:24.649320 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:30:24.650068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m14:30:24.650829 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:30:24.657344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:30:24.659661 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m14:30:24.667657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:25.162906 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:30:25.165027 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:30:25.227665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:30:25.229427 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:30:25.453516 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:39470820-ac3f-4538-8f00-80d6b508fd3d&page=queryresults
[0m14:30:25.555021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5328cd8a-d5c3-4612-8f3c-ec166c487f16&page=queryresults
[0m14:30:27.237008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c872360>]}
[0m14:30:27.237983 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.59s]
[0m14:30:27.238840 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m14:30:27.610980 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c160950>]}
[0m14:30:27.611786 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.50s]
[0m14:30:27.612448 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m14:30:27.613661 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m14:30:27.614312 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:30:27.614891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m14:30:27.615323 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:30:27.623280 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:30:27.624483 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:30:27.628826 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:28.101884 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:30:28.104326 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:30:28.389038 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b85f9a2f-fae4-4022-8e93-17836caf808c&page=queryresults
[0m14:30:30.267090 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c979e20>]}
[0m14:30:30.269660 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.65s]
[0m14:30:30.270785 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:30:30.272785 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:30:30.273902 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:30:30.274730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m14:30:30.275263 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:30:30.280652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:30:30.281910 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:30:30.328262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:30:30.329773 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    dim_users.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, dim_users.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m14:30:30.330430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:30.949031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a36265ac-f45f-4806-a454-deb84a399c79&page=queryresults
[0m14:30:31.012772 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a36265ac-f45f-4806-a454-deb84a399c79&page=queryresults
[0m14:30:31.034627 [debug] [Thread-1 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [32:15]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:30:31.035527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a27242cb-b348-4b15-997a-bac20ea4ebb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3dc710>]}
[0m14:30:31.037274 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.76s]
[0m14:30:31.038670 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:30:31.040450 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [32:15]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:30:31.045248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:31.211644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:31.212421 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:30:31.212872 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:30:31.213287 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:30:31.213638 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m14:30:31.214239 [info ] [MainThread]: 
[0m14:30:31.214667 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m14:30:31.216739 [debug] [MainThread]: Command end result
[0m14:30:31.245811 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:30:31.249250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:30:31.259745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:30:31.260307 [info ] [MainThread]: 
[0m14:30:31.260852 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:30:31.261337 [info ] [MainThread]: 
[0m14:30:31.261975 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [32:15]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:30:31.262505 [info ] [MainThread]: 
[0m14:30:31.263273 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:30:31.264204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.413065, "process_in_blocks": "0", "process_kernel_time": 1.145037, "process_mem_max_rss": "219824128", "process_out_blocks": "0", "process_user_time": 6.850408}
[0m14:30:31.265002 [debug] [MainThread]: Command `dbt run` failed at 14:30:31.264893 after 16.41 seconds
[0m14:30:31.265529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f68440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5602f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c561b20>]}
[0m14:30:31.265934 [debug] [MainThread]: Flushing usage events
[0m14:30:33.127090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:57.734945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959bdd0>]}


============================== 14:31:57.740703 | 8dc3b9cb-18db-45f5-b203-a63e202c51da ==============================
[0m14:31:57.740703 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:31:57.741370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:31:59.731296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086941d0>]}
[0m14:31:59.792351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a626060>]}
[0m14:31:59.793261 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:32:00.018793 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:32:00.171496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:00.172301 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m14:32:00.447556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dimfact
- models.staging
- models.datamarts
[0m14:32:00.462838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afc6690>]}
[0m14:32:00.542206 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:32:00.545719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:32:00.576739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af653d0>]}
[0m14:32:00.578205 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:32:00.578782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afa4dd0>]}
[0m14:32:00.582270 [info ] [MainThread]: 
[0m14:32:00.582966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:00.583447 [info ] [MainThread]: 
[0m14:32:00.584229 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:00.588860 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:32:00.589603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:01.407609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:32:01.408816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:01.875907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8a8170>]}
[0m14:32:01.876933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:02.034525 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:32:02.035179 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:32:02.035744 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:32:02.036442 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:32:02.037173 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:32:02.037757 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:32:02.038318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:32:02.038918 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:32:02.040002 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:32:02.040751 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:32:02.041196 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:32:02.041795 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:32:02.084521 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:32:02.087847 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:32:02.088430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:32:02.089827 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:32:02.090230 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:32:02.090668 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:32:02.210556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:32:02.212842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:02.213374 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:32:03.044266 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:32:03.044898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:32:03.045440 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:32:03.046949 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:32:03.047557 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:32:03.048236 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:32:03.349012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0cd3c332-2bf3-4c96-abee-d81d77325e30&page=queryresults
[0m14:32:03.351664 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0913e17f-a32d-4bcd-b2af-726e3dd394f3&page=queryresults
[0m14:32:03.410855 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5360373a-2cdf-48a4-9a69-92553da88bfa&page=queryresults
[0m14:32:05.331545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a82fa10>]}
[0m14:32:05.332763 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.29s]
[0m14:32:05.333610 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:32:05.334543 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m14:32:05.335102 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:32:05.335673 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m14:32:05.336047 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:32:05.341216 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:32:05.342169 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m14:32:05.345060 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:32:05.576179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7d6600>]}
[0m14:32:05.576865 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.54s]
[0m14:32:05.577418 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:32:05.578099 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m14:32:05.578708 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:32:05.579144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m14:32:05.579479 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:32:05.584041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:32:05.585015 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m14:32:05.590334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:05.815049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7f4fb0>]}
[0m14:32:05.816182 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.78s]
[0m14:32:05.816982 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:32:05.957443 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:32:05.958773 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:32:06.038537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:32:06.039760 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:32:06.314152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7eef4775-a437-4647-8256-46ae1439211f&page=queryresults
[0m14:32:06.332296 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:eb2cd80f-277d-4e29-af54-5717f4fd175d&page=queryresults
[0m14:32:08.178180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7ab350>]}
[0m14:32:08.180080 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.60s]
[0m14:32:08.180868 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m14:32:08.242550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7a9bb0>]}
[0m14:32:08.243496 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.91s]
[0m14:32:08.244175 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m14:32:08.245421 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m14:32:08.245978 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:32:08.246487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m14:32:08.246903 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:32:08.256998 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:32:08.258051 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:32:08.261190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:32:08.727889 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:32:08.729615 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:32:09.095870 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9986e57c-0833-4dcb-8ba2-56599ec60c76&page=queryresults
[0m14:32:10.981190 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e880260>]}
[0m14:32:10.985312 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.73s]
[0m14:32:10.986643 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:32:10.988638 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:32:10.989347 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:32:10.989962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m14:32:10.990328 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:32:10.999679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:32:11.001131 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:32:11.042867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:32:11.043794 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, dim_users.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m14:32:11.044262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:11.699695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3b18ce38-c4ca-4fa1-a54c-d68a1e208515&page=queryresults
[0m14:32:11.803205 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3b18ce38-c4ca-4fa1-a54c-d68a1e208515&page=queryresults
[0m14:32:11.822704 [debug] [Thread-1 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:32:11.823555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dc3b9cb-18db-45f5-b203-a63e202c51da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aeaa630>]}
[0m14:32:11.824288 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.83s]
[0m14:32:11.824865 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:32:11.825427 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:32:11.827946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:11.981555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:11.982357 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:32:11.982893 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:32:11.983230 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:32:11.983511 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m14:32:11.983979 [info ] [MainThread]: 
[0m14:32:11.984356 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m14:32:11.985872 [debug] [MainThread]: Command end result
[0m14:32:12.016361 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:32:12.024173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:32:12.030953 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:32:12.031305 [info ] [MainThread]: 
[0m14:32:12.031948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:12.032489 [info ] [MainThread]: 
[0m14:32:12.032919 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:32:12.033218 [info ] [MainThread]: 
[0m14:32:12.033522 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:32:12.034089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.400656, "process_in_blocks": "0", "process_kernel_time": 0.950371, "process_mem_max_rss": "202522624", "process_out_blocks": "0", "process_user_time": 5.522141}
[0m14:32:12.034667 [debug] [MainThread]: Command `dbt run` failed at 14:32:12.034589 after 14.40 seconds
[0m14:32:12.035082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afd15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093393a0>]}
[0m14:32:12.035412 [debug] [MainThread]: Flushing usage events
[0m14:32:14.018417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:41.805056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105862090>]}


============================== 14:34:41.811131 | 8101b8dc-3161-4f4f-87d5-644a153d62fa ==============================
[0m14:34:41.811131 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:34:41.811943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:34:42.012993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8101b8dc-3161-4f4f-87d5-644a153d62fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103481b50>]}
[0m14:34:42.064736 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.36385572, "process_in_blocks": "0", "process_kernel_time": 0.357879, "process_mem_max_rss": "96813056", "process_out_blocks": "0", "process_user_time": 1.661455}
[0m14:34:42.067762 [debug] [MainThread]: Command `dbt clean` succeeded at 14:34:42.067504 after 0.37 seconds
[0m14:34:42.068596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105862300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105636120>]}
[0m14:34:42.069281 [debug] [MainThread]: Flushing usage events
[0m14:34:43.561456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:50.952451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c82c0>]}


============================== 14:34:50.958241 | 8d8d71b2-1038-4d50-9bde-af047fa28b00 ==============================
[0m14:34:50.958241 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:34:50.959029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:53.161769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685a090>]}
[0m14:34:53.241942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5ffbc0>]}
[0m14:34:53.243084 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:34:53.463906 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:34:53.464924 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:34:53.465584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107677d10>]}
[0m14:34:54.858319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.datamarts
- models.staging
- models.dimfact
[0m14:34:54.870220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fad6ea0>]}
[0m14:34:54.952797 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:34:54.955886 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:34:54.978652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fbf7e30>]}
[0m14:34:54.979249 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:34:54.979640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc247a0>]}
[0m14:34:54.981753 [info ] [MainThread]: 
[0m14:34:54.982174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:54.982469 [info ] [MainThread]: 
[0m14:34:54.982957 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:54.987962 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:34:54.988626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:55.752944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:34:55.753760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:56.279117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d2e10>]}
[0m14:34:56.282087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:56.448164 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:34:56.449368 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:34:56.452215 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:34:56.451357 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:34:56.453655 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:34:56.454385 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:34:56.455615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:34:56.456342 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:34:56.457008 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:34:56.457557 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:34:56.457958 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:34:56.458408 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:34:56.494570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:34:56.495579 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:34:56.496441 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:34:56.498116 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:34:56.498657 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:34:56.499026 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:34:56.610944 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:34:56.613653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:56.614220 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:34:57.440902 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:34:57.441846 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:34:57.438733 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:34:57.443833 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:34:57.444518 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:34:57.445307 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:34:57.715409 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:993008b3-8858-4c27-ad5d-1c7b4cf4b7c2&page=queryresults
[0m14:34:57.716195 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:85e00188-d985-4ecc-a8d5-54a88cb95e56&page=queryresults
[0m14:34:57.769037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b6609ec3-d398-4fa1-801b-5528edf1cc5f&page=queryresults
[0m14:34:59.676176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff53f50>]}
[0m14:34:59.676783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f62fc80>]}
[0m14:34:59.677961 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.22s]
[0m14:34:59.678940 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.22s]
[0m14:34:59.679819 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:34:59.680542 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:34:59.681915 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m14:34:59.682446 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:34:59.683079 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m14:34:59.683564 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:34:59.696104 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:34:59.697457 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m14:34:59.701489 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:34:59.943222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc24260>]}
[0m14:34:59.944207 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.49s]
[0m14:34:59.945102 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:34:59.945892 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_books
[0m14:34:59.946634 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:34:59.947361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_books)
[0m14:34:59.947915 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:34:59.953138 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:34:59.954172 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_books
[0m14:34:59.958144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:35:00.299611 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:35:00.301183 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:35:00.419796 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:35:00.421249 [debug] [Thread-2 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:35:00.624333 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b754ea1c-0d4d-46bb-bc8f-32cdefcb3f6d&page=queryresults
[0m14:35:00.708335 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:924a12eb-154d-4d02-9cbe-55e33ca81bb6&page=queryresults
[0m14:35:02.263173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb79a60>]}
[0m14:35:02.267286 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.58s]
[0m14:35:02.274642 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m14:35:03.078088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc1a5a0>]}
[0m14:35:03.078975 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.13s]
[0m14:35:03.079827 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_books
[0m14:35:03.081514 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m14:35:03.082267 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:35:03.082929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m14:35:03.083395 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:35:03.262474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:35:03.263460 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:35:03.266114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:03.674423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:35:03.675640 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:35:03.930842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:897741ed-12cc-4027-a96a-63de125b3205&page=queryresults
[0m14:35:05.804775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff27170>]}
[0m14:35:05.806078 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.72s]
[0m14:35:05.806862 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:35:05.808470 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:35:05.809105 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:35:05.809823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m14:35:05.810341 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:35:05.825369 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:35:05.827025 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:35:05.878094 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:35:05.879350 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    dim_users.name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, dim_users.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m14:35:05.879876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:35:06.494799 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f2f93b53-6a46-41b9-97ee-5bc5893c2510&page=queryresults
[0m14:35:06.574654 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f2f93b53-6a46-41b9-97ee-5bc5893c2510&page=queryresults
[0m14:35:06.588362 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:35:06.589176 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8d71b2-1038-4d50-9bde-af047fa28b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13849f9e0>]}
[0m14:35:06.590225 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.78s]
[0m14:35:06.591109 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:35:06.591840 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:35:06.598993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:06.755080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:06.755572 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:35:06.756015 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m14:35:06.756504 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m14:35:06.756791 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:35:06.757237 [info ] [MainThread]: 
[0m14:35:06.757836 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m14:35:06.759750 [debug] [MainThread]: Command end result
[0m14:35:06.796061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:35:06.799339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:35:06.807017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:35:06.807447 [info ] [MainThread]: 
[0m14:35:06.807992 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:06.808534 [info ] [MainThread]: 
[0m14:35:06.808955 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Name user_name not found inside dim_users at [43:40]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:35:06.809281 [info ] [MainThread]: 
[0m14:35:06.809618 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:35:06.810246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.939698, "process_in_blocks": "0", "process_kernel_time": 1.110899, "process_mem_max_rss": "216743936", "process_out_blocks": "0", "process_user_time": 6.741892}
[0m14:35:06.810848 [debug] [MainThread]: Command `dbt run` failed at 14:35:06.810755 after 15.94 seconds
[0m14:35:06.811271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc665a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc65280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc65c40>]}
[0m14:35:06.811632 [debug] [MainThread]: Flushing usage events
[0m14:35:08.149656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:16.155499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adbbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c8500>]}


============================== 14:36:16.161188 | c9153038-d25a-4b7d-8cb8-b40803874908 ==============================
[0m14:36:16.161188 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:36:16.161983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m14:36:18.327346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12edf1ca0>]}
[0m14:36:18.409698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b495430>]}
[0m14:36:18.410810 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:36:18.698030 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:36:18.890292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:18.891535 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m14:36:19.229570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.datamarts
- models.staging
- models.dimfact
[0m14:36:19.249522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9c66c0>]}
[0m14:36:19.337255 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:36:19.340412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:36:19.371139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f965490>]}
[0m14:36:19.371810 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:36:19.372209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8aa420>]}
[0m14:36:19.374719 [info ] [MainThread]: 
[0m14:36:19.375220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:19.375546 [info ] [MainThread]: 
[0m14:36:19.376091 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:19.381022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:36:19.381948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:20.187536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m14:36:20.188292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:20.660519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1ac6b0>]}
[0m14:36:20.661335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:36:20.837988 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:36:20.838754 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:36:20.840382 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:36:20.839638 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m14:36:20.841066 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m14:36:20.842020 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m14:36:20.842803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m14:36:20.843342 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m14:36:20.844400 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m14:36:20.844966 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:36:20.845419 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:36:20.845822 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:36:20.889466 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:36:20.890089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:36:20.891756 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:36:20.892896 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:36:20.898918 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:36:20.933150 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:36:21.029162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:36:21.036723 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:36:21.034356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:22.028347 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:36:22.033105 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:36:22.033558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:36:22.035008 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:36:22.035808 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m14:36:22.037188 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:36:22.381219 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2e574c79-c6df-4398-9836-82231ed53104&page=queryresults
[0m14:36:22.389922 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e7e983a7-e2b1-4b17-967b-4eaed492736b&page=queryresults
[0m14:36:22.408926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:93c5c494-9e0a-48a3-94ba-6613d2cf066f&page=queryresults
[0m14:36:24.141685 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f12fe60>]}
[0m14:36:24.143571 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.30s]
[0m14:36:24.144438 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:36:24.145681 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m14:36:24.146159 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m14:36:24.146943 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m14:36:24.147499 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m14:36:24.156981 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m14:36:24.158814 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m14:36:24.163462 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:36:24.457067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f967530>]}
[0m14:36:24.458449 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.61s]
[0m14:36:24.459626 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:36:24.460601 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m14:36:24.461294 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m14:36:24.461880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m14:36:24.462291 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m14:36:24.469335 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m14:36:24.474207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb2bdd0>]}
[0m14:36:24.480702 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m14:36:24.480085 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.63s]
[0m14:36:24.488567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:36:24.489705 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:36:24.816704 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m14:36:24.817916 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m14:36:24.994050 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m14:36:24.995409 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:36:25.122331 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dad134b5-0a4c-4bb5-8115-9c03a72d7baf&page=queryresults
[0m14:36:25.362502 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:06a19bca-769e-428a-aeeb-e0b4d74d3250&page=queryresults
[0m14:36:26.923738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe4cbf0>]}
[0m14:36:26.931114 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.46s]
[0m14:36:26.935378 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m14:36:27.010593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdad6d0>]}
[0m14:36:27.011325 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.86s]
[0m14:36:27.012095 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m14:36:27.013618 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m14:36:27.014239 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m14:36:27.015128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m14:36:27.015686 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m14:36:27.023439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m14:36:27.024661 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m14:36:27.032314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:27.588418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m14:36:27.590152 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m14:36:27.939961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:93176b6c-d70c-4cb6-96b9-caa119daf797&page=queryresults
[0m14:36:29.801421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fedfa10>]}
[0m14:36:29.803462 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.79s]
[0m14:36:29.804315 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:36:29.806353 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:36:29.807266 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m14:36:29.807969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m14:36:29.808430 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m14:36:29.819901 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m14:36:29.821178 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m14:36:29.864546 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m14:36:29.865809 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m14:36:29.866519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:36:30.540181 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c84bc21f-8dd2-4d49-9d3e-123f40df0b52&page=queryresults
[0m14:36:30.630172 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c84bc21f-8dd2-4d49-9d3e-123f40df0b52&page=queryresults
[0m14:36:30.645939 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:36:30.646625 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9153038-d25a-4b7d-8cb8-b40803874908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acda630>]}
[0m14:36:30.647564 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.84s]
[0m14:36:30.648723 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:36:30.649532 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m14:36:30.655491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:30.810315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:30.811113 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m14:36:30.811476 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:36:30.811804 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m14:36:30.812121 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m14:36:30.812747 [info ] [MainThread]: 
[0m14:36:30.813186 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.44 seconds (11.44s).
[0m14:36:30.815063 [debug] [MainThread]: Command end result
[0m14:36:30.860744 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:36:30.868450 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:36:30.888662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:36:30.889249 [info ] [MainThread]: 
[0m14:36:30.889702 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:30.890058 [info ] [MainThread]: 
[0m14:36:30.891139 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m14:36:30.891769 [info ] [MainThread]: 
[0m14:36:30.892437 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:36:30.895300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.839619, "process_in_blocks": "0", "process_kernel_time": 1.180595, "process_mem_max_rss": "203767808", "process_out_blocks": "0", "process_user_time": 5.820299}
[0m14:36:30.897878 [debug] [MainThread]: Command `dbt run` failed at 14:36:30.897347 after 14.84 seconds
[0m14:36:30.899227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f855160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5b4470>]}
[0m14:36:30.900031 [debug] [MainThread]: Flushing usage events
[0m14:36:32.553545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:08.361299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c8230>]}


============================== 14:48:08.367036 | 37c3b843-4e3d-419d-9b41-88c3cfcd35be ==============================
[0m14:48:08.367036 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:48:08.367744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:10.585367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435a1e0>]}
[0m14:48:10.656572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205866f0>]}
[0m14:48:10.657455 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:48:10.894920 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:48:10.990483 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:48:10.991058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125590ce0>]}
[0m14:48:12.380626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_dpd.datamarts
[0m14:48:12.394522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12573bbf0>]}
[0m14:48:12.479710 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:48:12.483057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:48:12.510078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125755310>]}
[0m14:48:12.510686 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:48:12.511072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250f3530>]}
[0m14:48:12.513261 [info ] [MainThread]: 
[0m14:48:12.513708 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:12.514019 [info ] [MainThread]: 
[0m14:48:12.514546 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:48:12.520130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:48:12.520691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:12.521599 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:48:12.522592 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:48:12.523235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:12.523821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:14.245741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_staging)
[0m14:48:14.247030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_dimfact)
[0m14:48:14.248126 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_staging"
"
[0m14:48:14.248705 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_dimfact"
"
[0m14:48:14.263945 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_staging"} */
create schema if not exists `purwadika`.`diego_dwh_library_staging`
  
[0m14:48:14.266696 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_dimfact: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_dimfact"} */
create schema if not exists `purwadika`.`diego_dwh_library_dimfact`
  
[0m14:48:14.267450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:14.267917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:15.480005 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:7ff31696-41ac-4ad0-97df-e954cf80b620&page=queryresults
[0m14:48:15.577185 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1ce085c8-74fc-4cf2-a9b2-9d9d831ceb1c&page=queryresults
[0m14:48:16.560881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m14:48:16.561580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:16.562169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_dimfact, now list_purwadika_diego_library_final_project)
[0m14:48:16.562930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_staging, now list_purwadika_diego_dwh_library_dimfact)
[0m14:48:16.717441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:16.718534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:17.684461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12571ca70>]}
[0m14:48:17.685648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:17.841184 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:48:17.841852 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:48:17.843187 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:48:17.842619 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m14:48:17.843943 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m14:48:17.844755 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m14:48:17.845395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m14:48:17.845898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_rents)
[0m14:48:17.846335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m14:48:17.846865 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:48:17.847403 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:48:17.847891 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:48:17.864969 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:48:17.870274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:48:17.875378 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:48:17.876879 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:48:17.877430 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:48:17.901206 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:48:18.243842 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:48:18.240206 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:48:18.245885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:48:18.247310 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m14:48:18.247886 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m14:48:18.248429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:18.248921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:18.249402 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m14:48:18.607856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:19.141450 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3640b986-14e8-4448-aeef-e2c1f15c32e5&page=queryresults
[0m14:48:19.142849 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3640b986-14e8-4448-aeef-e2c1f15c32e5&page=queryresults
[0m14:48:19.143680 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0bd648c4-89c5-4fcd-b092-b2577c282889&page=queryresults
[0m14:48:19.144830 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0bd648c4-89c5-4fcd-b092-b2577c282889&page=queryresults
[0m14:48:19.151293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:11bf896a-f19b-4355-b34f-044a0995eb66&page=queryresults
[0m14:48:19.152411 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:11bf896a-f19b-4355-b34f-044a0995eb66&page=queryresults
[0m14:48:19.165792 [debug] [Thread-1 (]: Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql
[0m14:48:19.168272 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m14:48:19.172471 [debug] [Thread-3 (]: Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql
[0m14:48:19.173452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125cd3110>]}
[0m14:48:19.173888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125cf97c0>]}
[0m14:48:19.175126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c3b843-4e3d-419d-9b41-88c3cfcd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405a4b0>]}
[0m14:48:19.174766 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_books  [[31mERROR[0m in 1.32s]
[0m14:48:19.175974 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 1.33s]
[0m14:48:19.177408 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:48:19.176866 [error] [Thread-3 (]: 3 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_users  [[31mERROR[0m in 1.33s]
[0m14:48:19.178108 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:48:19.178819 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_books' to be skipped because of status 'error'.  Reason: Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql.
[0m14:48:19.179475 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:48:19.181066 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m14:48:19.181907 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m14:48:19.182781 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_users' to be skipped because of status 'error'.  Reason: Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql.
[0m14:48:19.183443 [info ] [Thread-4 (]: 4 of 7 SKIP relation diego_dwh_library_dimfact.dim_books ....................... [[33mSKIP[0m]
[0m14:48:19.185568 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_users
[0m14:48:19.186267 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m14:48:19.186890 [info ] [Thread-2 (]: 5 of 7 SKIP relation diego_dwh_library_dimfact.dim_users ....................... [[33mSKIP[0m]
[0m14:48:19.187698 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_users
[0m14:48:19.188689 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m14:48:19.189260 [info ] [Thread-1 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m14:48:19.189822 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:48:19.190623 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:48:19.191083 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_library_final_project.dmart_user_book ............... [[33mSKIP[0m]
[0m14:48:19.191557 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:48:19.192965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:19.359431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:19.359998 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m14:48:19.360382 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:48:19.360725 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m14:48:19.361229 [info ] [MainThread]: 
[0m14:48:19.361859 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m14:48:19.363402 [debug] [MainThread]: Command end result
[0m14:48:19.394877 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:48:19.397405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:48:19.404974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:48:19.405397 [info ] [MainThread]: 
[0m14:48:19.405879 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:48:19.406298 [info ] [MainThread]: 
[0m14:48:19.406728 [error] [MainThread]:   Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql
[0m14:48:19.407061 [info ] [MainThread]: 
[0m14:48:19.407421 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m14:48:19.407728 [info ] [MainThread]: 
[0m14:48:19.408075 [error] [MainThread]:   Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql
[0m14:48:19.408375 [info ] [MainThread]: 
[0m14:48:19.408712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m14:48:19.409442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.140444, "process_in_blocks": "0", "process_kernel_time": 1.085236, "process_mem_max_rss": "222117888", "process_out_blocks": "0", "process_user_time": 7.06676}
[0m14:48:19.410076 [debug] [MainThread]: Command `dbt run` failed at 14:48:19.409969 after 11.14 seconds
[0m14:48:19.410731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049edc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257a3cb0>]}
[0m14:48:19.411605 [debug] [MainThread]: Flushing usage events
[0m14:48:20.852266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:57.148832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497dd0>]}


============================== 14:49:57.155396 | df396b3b-091f-42ed-82b9-82d510b07c3d ==============================
[0m14:49:57.155396 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:49:57.156168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:49:57.341103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df396b3b-091f-42ed-82b9-82d510b07c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534fe0>]}
[0m14:49:57.367781 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.31908932, "process_in_blocks": "0", "process_kernel_time": 0.340591, "process_mem_max_rss": "98762752", "process_out_blocks": "0", "process_user_time": 1.605909}
[0m14:49:57.368474 [debug] [MainThread]: Command `dbt clean` succeeded at 14:49:57.368352 after 0.32 seconds
[0m14:49:57.368875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497fb0>]}
[0m14:49:57.369266 [debug] [MainThread]: Flushing usage events
[0m14:49:58.786355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:05.923943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106886150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc84a0>]}


============================== 14:50:05.930145 | 736f147c-f489-4a6c-bb8d-e5e8c4726ae8 ==============================
[0m14:50:05.930145 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:50:05.930846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:50:07.973776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dd760>]}
[0m14:50:08.045504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287a8e00>]}
[0m14:50:08.046339 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:50:08.328414 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m14:50:08.329429 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:08.329866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288e5130>]}
[0m14:50:09.724291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12916a780>]}
[0m14:50:09.806291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:50:09.811970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:50:09.838772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290eaff0>]}
[0m14:50:09.839429 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m14:50:09.839836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b86420>]}
[0m14:50:09.842113 [info ] [MainThread]: 
[0m14:50:09.842761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:09.843407 [info ] [MainThread]: 
[0m14:50:09.844185 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:09.849311 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:50:09.850015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:09.850892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:50:09.851639 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m14:50:09.852272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:09.852661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:11.641036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_marts)
[0m14:50:11.643938 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_marts"
"
[0m14:50:11.666732 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_marts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_marts"} */
create schema if not exists `purwadika`.`diego_dwh_library_marts`
  
[0m14:50:11.667280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:12.755688 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1ef05801-9013-4648-90ed-34d5881af7f1&page=queryresults
[0m14:50:13.780977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m14:50:13.781616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_marts, now list_purwadika_diego_dwh_library_staging)
[0m14:50:13.782186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m14:50:13.782665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:13.783243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:13.783583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:17.037550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290c3050>]}
[0m14:50:17.039985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:17.196904 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m14:50:17.197446 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m14:50:17.197891 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m14:50:17.199131 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m14:50:17.200287 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m14:50:17.201035 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m14:50:17.201755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m14:50:17.202181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m14:50:17.202545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m14:50:17.202942 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m14:50:17.203260 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m14:50:17.203661 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m14:50:17.226066 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m14:50:17.230775 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m14:50:17.237669 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m14:50:17.240149 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m14:50:17.240760 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m14:50:17.247273 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m14:50:17.450338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m14:50:17.452845 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m14:50:17.449605 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m14:50:17.454776 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m14:50:17.455305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:17.621084 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m14:50:17.621701 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m14:50:17.622824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:17.623414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:18.323507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:843dc948-6274-4f27-a859-8f8d9c013730&page=queryresults
[0m14:50:18.324674 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:843dc948-6274-4f27-a859-8f8d9c013730&page=queryresults
[0m14:50:18.337708 [debug] [Thread-1 (]: Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql
[0m14:50:18.341155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1295f8e00>]}
[0m14:50:18.342443 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_books  [[31mERROR[0m in 1.14s]
[0m14:50:18.343942 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m14:50:18.344959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:67e0733f-c227-4625-8979-8b349e947358&page=queryresults
[0m14:50:18.346416 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_books' to be skipped because of status 'error'.  Reason: Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql.
[0m14:50:18.347270 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:67e0733f-c227-4625-8979-8b349e947358&page=queryresults
[0m14:50:18.352066 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:05a2dd2c-a3f7-43d1-89c8-31aeba95ffe4&page=queryresults
[0m14:50:18.354529 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m14:50:18.355053 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:05a2dd2c-a3f7-43d1-89c8-31aeba95ffe4&page=queryresults
[0m14:50:18.355580 [info ] [Thread-4 (]: 4 of 7 SKIP relation diego_dwh_library_dimfact.dim_books ....................... [[33mSKIP[0m]
[0m14:50:18.356693 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m14:50:18.360134 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m14:50:18.361079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12960dee0>]}
[0m14:50:18.361974 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 1.16s]
[0m14:50:18.362800 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m14:50:18.363733 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m14:50:18.365460 [debug] [Thread-3 (]: Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql
[0m14:50:18.366000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736f147c-f489-4a6c-bb8d-e5e8c4726ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12912a930>]}
[0m14:50:18.366985 [error] [Thread-3 (]: 3 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_users  [[31mERROR[0m in 1.16s]
[0m14:50:18.368070 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m14:50:18.368670 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_users' to be skipped because of status 'error'.  Reason: Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql.
[0m14:50:18.369466 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m14:50:18.370179 [info ] [Thread-1 (]: 5 of 7 SKIP relation diego_dwh_library_dimfact.dim_users ....................... [[33mSKIP[0m]
[0m14:50:18.370657 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m14:50:18.371190 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m14:50:18.371829 [info ] [Thread-2 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m14:50:18.372497 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m14:50:18.373188 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m14:50:18.373928 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m14:50:18.374527 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m14:50:18.376001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:18.538090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:18.538581 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m14:50:18.538906 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m14:50:18.539195 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m14:50:18.539659 [info ] [MainThread]: 
[0m14:50:18.540042 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m14:50:18.541756 [debug] [MainThread]: Command end result
[0m14:50:18.576298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m14:50:18.581118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m14:50:18.592248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m14:50:18.593025 [info ] [MainThread]: 
[0m14:50:18.593908 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:50:18.594419 [info ] [MainThread]: 
[0m14:50:18.594901 [error] [MainThread]:   Database Error in model staging_books (models/staging/staging_books.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_books.sql
[0m14:50:18.595267 [info ] [MainThread]: 
[0m14:50:18.595690 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m14:50:18.596115 [info ] [MainThread]: 
[0m14:50:18.596596 [error] [MainThread]:   Database Error in model staging_users (models/staging/staging_users.sql)
  Not found: Dataset purwadika:diego_dwh_library_staging was not found in location asia-southeast2
  compiled code at target/run/dbt_dpd/models/staging/staging_users.sql
[0m14:50:18.597014 [info ] [MainThread]: 
[0m14:50:18.597576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m14:50:18.598416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.7749605, "process_in_blocks": "0", "process_kernel_time": 0.991375, "process_mem_max_rss": "205864960", "process_out_blocks": "0", "process_user_time": 6.512948}
[0m14:50:18.599243 [debug] [MainThread]: Command `dbt run` failed at 14:50:18.599101 after 12.78 seconds
[0m14:50:18.599973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107992420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d0c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129050770>]}
[0m14:50:18.600543 [debug] [MainThread]: Flushing usage events
[0m14:50:19.654035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:06.023316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b66330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8320>]}


============================== 15:02:06.029064 | 4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689 ==============================
[0m15:02:06.029064 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:02:06.029802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:08.263700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eca450>]}
[0m15:02:08.330276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e99460>]}
[0m15:02:08.331132 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:02:08.590311 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m15:02:08.704452 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:02:08.705110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a290aa0>]}
[0m15:02:10.088112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.dimfact
- models.purwadika.datamart
- models.purwadika.staging
[0m15:02:10.102993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a44a1e0>]}
[0m15:02:10.188512 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m15:02:10.192088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m15:02:10.218691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a45e450>]}
[0m15:02:10.219396 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m15:02:10.219866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a484e60>]}
[0m15:02:10.222410 [info ] [MainThread]: 
[0m15:02:10.222911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:10.223273 [info ] [MainThread]: 
[0m15:02:10.223864 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:02:10.228771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m15:02:10.229375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:11.280173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m15:02:11.281075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:11.797981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d06a50>]}
[0m15:02:11.798792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:11.962356 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m15:02:11.963156 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m15:02:11.964634 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m15:02:11.964086 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m15:02:11.965520 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m15:02:11.966483 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m15:02:11.967238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m15:02:11.967935 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m15:02:11.968763 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m15:02:11.969381 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m15:02:11.969921 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m15:02:11.970527 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m15:02:12.001403 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m15:02:12.003628 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m15:02:12.006015 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m15:02:12.007320 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m15:02:12.007809 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m15:02:12.008740 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m15:02:12.159516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:12.160235 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:02:12.160939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:02:13.064154 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m15:02:13.065012 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m15:02:13.069498 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m15:02:13.071792 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m15:02:13.072517 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m15:02:13.073147 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m15:02:13.408933 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8c97a93c-2c9e-4f12-a290-c22aca70b0bd&page=queryresults
[0m15:02:13.413498 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:77a86cc4-f71b-4fe1-9ca7-e92981c1d204&page=queryresults
[0m15:02:13.430734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:067caabd-debb-420d-b114-a58be1893e1c&page=queryresults
[0m15:02:15.291135 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891b230>]}
[0m15:02:15.292541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db6540>]}
[0m15:02:15.293629 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.32s]
[0m15:02:15.295532 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m15:02:15.294724 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 3.32s]
[0m15:02:15.296704 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m15:02:15.297430 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m15:02:15.298029 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m15:02:15.298527 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_books
[0m15:02:15.299055 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m15:02:15.299548 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m15:02:15.300033 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m15:02:15.300840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_books)
[0m15:02:15.308743 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m15:02:15.309822 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_books
[0m15:02:15.315428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m15:02:15.316681 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m15:02:15.317156 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_books
[0m15:02:15.320681 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:02:15.323574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:15.639279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2ec2c0>]}
[0m15:02:15.640075 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 3.67s]
[0m15:02:15.641413 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m15:02:15.905725 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m15:02:15.907008 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m15:02:15.925439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m15:02:15.927120 [debug] [Thread-1 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m15:02:16.193715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:187caf16-8c80-44ae-a0f9-292cfb9ae4eb&page=queryresults
[0m15:02:16.223709 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8d3f48da-53c8-4926-b1c8-19bfad10f049&page=queryresults
[0m15:02:17.806864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fe11c0>]}
[0m15:02:17.808041 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.51s]
[0m15:02:17.809572 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_books
[0m15:02:18.044170 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068baf90>]}
[0m15:02:18.044959 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.75s]
[0m15:02:18.045607 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m15:02:18.046603 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m15:02:18.047167 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m15:02:18.047676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m15:02:18.048059 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m15:02:18.054310 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m15:02:18.055153 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m15:02:18.057866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:02:18.519678 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m15:02:18.520909 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_library_final_project`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_library_final_project`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m15:02:18.837859 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:df77bd0d-e755-41de-a225-c43c9047da99&page=queryresults
[0m15:02:20.708417 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7a10>]}
[0m15:02:20.710626 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.66s]
[0m15:02:20.711765 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m15:02:20.713569 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m15:02:20.714314 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m15:02:20.714887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m15:02:20.715314 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m15:02:20.733544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m15:02:20.735459 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m15:02:20.779833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m15:02:20.781055 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT 
        user_id,
        user_name,
        book_id,
        created_at,  -- Pastikan kolom ini ada
        return_date
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT 
        user_id,
        email 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT 
        book_id,
        release_year
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m15:02:20.781635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:21.432183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fe0af73e-2163-4d91-bcad-9aba15304503&page=queryresults
[0m15:02:21.499117 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fe0af73e-2163-4d91-bcad-9aba15304503&page=queryresults
[0m15:02:21.522741 [debug] [Thread-1 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m15:02:21.524028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2c8dc7-be04-46fb-aa43-eb5b2f8c1689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a61e7b0>]}
[0m15:02:21.526297 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.81s]
[0m15:02:21.527805 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m15:02:21.528641 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m15:02:21.534384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:21.709349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:21.710450 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m15:02:21.711652 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m15:02:21.712051 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m15:02:21.712328 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m15:02:21.712851 [info ] [MainThread]: 
[0m15:02:21.713198 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m15:02:21.714883 [debug] [MainThread]: Command end result
[0m15:02:21.747680 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m15:02:21.752168 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m15:02:21.764321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m15:02:21.765346 [info ] [MainThread]: 
[0m15:02:21.766392 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:02:21.767217 [info ] [MainThread]: 
[0m15:02:21.767843 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m15:02:21.768237 [info ] [MainThread]: 
[0m15:02:21.768814 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:02:21.770571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.831799, "process_in_blocks": "0", "process_kernel_time": 1.125094, "process_mem_max_rss": "223412224", "process_out_blocks": "0", "process_user_time": 7.049386}
[0m15:02:21.771957 [debug] [MainThread]: Command `dbt run` failed at 15:02:21.771487 after 15.83 seconds
[0m15:02:21.773784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d62090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a41d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b66330>]}
[0m15:02:21.774380 [debug] [MainThread]: Flushing usage events
[0m15:02:23.496358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:44.815097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11917b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a5a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a5a600>]}


============================== 15:16:44.823063 | b2046c2b-3c55-4da8-a501-ab4585c1cc41 ==============================
[0m15:16:44.823063 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:16:44.824044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:16:45.015756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2046c2b-3c55-4da8-a501-ab4585c1cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107881a60>]}
[0m15:16:45.045981 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.3322655, "process_in_blocks": "0", "process_kernel_time": 0.441278, "process_mem_max_rss": "96731136", "process_out_blocks": "0", "process_user_time": 1.769637}
[0m15:16:45.046731 [debug] [MainThread]: Command `dbt clean` succeeded at 15:16:45.046603 after 0.33 seconds
[0m15:16:45.047156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119945fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119566780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a57110>]}
[0m15:16:45.047724 [debug] [MainThread]: Flushing usage events
[0m15:16:46.753602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:16.529562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c82f0>]}


============================== 15:17:16.536252 | 31b6c84c-dc19-4949-af0e-6832a971e3c0 ==============================
[0m15:17:16.536252 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:17:16.537043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:18.812504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098961b0>]}
[0m15:17:18.881999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62fd10>]}
[0m15:17:18.884268 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:17:19.132121 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m15:17:19.133263 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:17:19.133909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a843d10>]}
[0m15:17:20.610359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.purwadika.staging
- models.purwadika.dimfact
- models.purwadika.datamart
[0m15:17:20.629675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125451b80>]}
[0m15:17:20.729927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m15:17:20.733097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m15:17:20.764077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1254e4b90>]}
[0m15:17:20.764683 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m15:17:20.765080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124f9b440>]}
[0m15:17:20.768054 [info ] [MainThread]: 
[0m15:17:20.768644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:20.769226 [info ] [MainThread]: 
[0m15:17:20.769942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:20.775700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m15:17:20.776338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:21.876197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_library_final_project)
[0m15:17:21.877492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:22.353165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108506960>]}
[0m15:17:22.354006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:22.532247 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m15:17:22.533151 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m15:17:22.534632 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m15:17:22.534098 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_library_final_project.staging_books ... [RUN]
[0m15:17:22.535737 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_library_final_project.staging_rents ... [RUN]
[0m15:17:22.536630 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_library_final_project.staging_users ... [RUN]
[0m15:17:22.537345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_library_final_project, now model.dbt_dpd.staging_books)
[0m15:17:22.538270 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_rents'
[0m15:17:22.539111 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_dpd.staging_users'
[0m15:17:22.539704 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m15:17:22.540318 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m15:17:22.540826 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m15:17:22.577837 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m15:17:22.583105 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m15:17:22.585931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m15:17:22.589082 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m15:17:22.590024 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m15:17:22.590586 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m15:17:22.752971 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:17:22.753743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:22.754526 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:17:23.628357 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m15:17:23.631091 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m15:17:23.634377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m15:17:23.636256 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m15:17:23.637989 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m15:17:23.639304 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m15:17:24.004928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:001558a0-2436-448a-9a6d-22399e59fae9&page=queryresults
[0m15:17:24.008031 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bd683823-8e1c-494c-849a-294e30c0d9bf&page=queryresults
[0m15:17:24.008835 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:914efdb0-ef41-413c-b0cf-ddab7bb8e4d4&page=queryresults
[0m15:17:25.694824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12550e0f0>]}
[0m15:17:25.696905 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_library_final_project.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.15s]
[0m15:17:25.698059 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m15:17:25.700831 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m15:17:25.701639 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_library_final_project.dim_books ....... [RUN]
[0m15:17:25.702393 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m15:17:25.702820 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m15:17:25.713301 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m15:17:25.715094 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m15:17:25.719973 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:17:25.920945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1254dc980>]}
[0m15:17:25.922431 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_library_final_project.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.38s]
[0m15:17:25.923626 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m15:17:26.034120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12590f440>]}
[0m15:17:26.034928 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_library_final_project.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.50s]
[0m15:17:26.035583 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m15:17:26.036293 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m15:17:26.036966 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_library_final_project.dim_users ....... [RUN]
[0m15:17:26.037522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m15:17:26.037996 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m15:17:26.043227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m15:17:26.044251 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m15:17:26.048055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:26.521902 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m15:17:26.523282 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m15:17:26.594529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m15:17:26.595600 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_users`
)

SELECT * FROM source

    );
  
[0m15:17:26.820079 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5d005466-06be-4ee6-b533-e39cf90e76d9&page=queryresults
[0m15:17:26.862651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e114238b-a7a5-48e3-b1ab-ce038c44f376&page=queryresults
[0m15:17:28.492143 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e80d40>]}
[0m15:17:28.493728 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_library_final_project.dim_books .. [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.79s]
[0m15:17:28.495597 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m15:17:28.591503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e80050>]}
[0m15:17:28.592759 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_library_final_project.dim_users .. [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.55s]
[0m15:17:28.593840 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m15:17:28.595811 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m15:17:28.596614 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_library_final_project.fact_rents ...... [RUN]
[0m15:17:28.597269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m15:17:28.597766 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m15:17:28.768415 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m15:17:28.769276 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m15:17:28.771686 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:17:29.257885 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m15:17:29.259120 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m15:17:29.494894 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:10e882cf-536c-4c4d-8901-a39f91d0248b&page=queryresults
[0m15:17:31.186382 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dc5760>]}
[0m15:17:31.189826 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_library_final_project.fact_rents . [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.59s]
[0m15:17:31.191100 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m15:17:31.193309 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m15:17:31.193928 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_library_final_project.dmart_user_book . [RUN]
[0m15:17:31.194549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m15:17:31.195029 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m15:17:31.208566 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m15:17:31.210189 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m15:17:31.221393 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m15:17:31.223164 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_library_final_project`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT 
        user_id,
        user_name,
        book_id,
        created_at,  -- Pastikan kolom ini ada
        return_date
    FROM `purwadika`.`diego_library_final_project`.`fact_rents`
),

dim_users AS (
    SELECT 
        user_id,
        email 
    FROM `purwadika`.`diego_library_final_project`.`dim_users`
),

dim_books AS (
    SELECT 
        book_id,
        release_year
    FROM `purwadika`.`diego_library_final_project`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id

GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m15:17:31.224396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:17:31.958350 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0bff1c8b-c286-4cad-997b-54a59d632468&page=queryresults
[0m15:17:32.038738 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0bff1c8b-c286-4cad-997b-54a59d632468&page=queryresults
[0m15:17:32.054183 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m15:17:32.055465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6c84c-dc19-4949-af0e-6832a971e3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125934cb0>]}
[0m15:17:32.056754 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_library_final_project.dmart_user_book  [[31mERROR[0m in 0.86s]
[0m15:17:32.057616 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m15:17:32.058276 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m15:17:32.061585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:32.213140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:32.213654 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m15:17:32.213994 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m15:17:32.214290 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m15:17:32.214556 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m15:17:32.215051 [info ] [MainThread]: 
[0m15:17:32.215407 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m15:17:32.216951 [debug] [MainThread]: Command end result
[0m15:17:32.247033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m15:17:32.250407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m15:17:32.259236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m15:17:32.259697 [info ] [MainThread]: 
[0m15:17:32.260200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:32.260639 [info ] [MainThread]: 
[0m15:17:32.261251 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m15:17:32.261763 [info ] [MainThread]: 
[0m15:17:32.262486 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:17:32.263229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.840913, "process_in_blocks": "0", "process_kernel_time": 1.364439, "process_mem_max_rss": "202670080", "process_out_blocks": "0", "process_user_time": 7.142238}
[0m15:17:32.263950 [debug] [MainThread]: Command `dbt run` failed at 15:17:32.263850 after 15.84 seconds
[0m15:17:32.264419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125507ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098602c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109861310>]}
[0m15:17:32.264797 [debug] [MainThread]: Flushing usage events
[0m15:17:33.823849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:54.154794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2db7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c52d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b996750>]}


============================== 19:27:54.159006 | a30bdf37-6a8f-4f1e-a958-a027c85ffc36 ==============================
[0m19:27:54.159006 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:27:54.159368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:27:54.258704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a30bdf37-6a8f-4f1e-a958-a027c85ffc36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c955100>]}
[0m19:27:54.277376 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16685784, "process_in_blocks": "0", "process_kernel_time": 0.178986, "process_mem_max_rss": "98680832", "process_out_blocks": "0", "process_user_time": 0.77522}
[0m19:27:54.277725 [debug] [MainThread]: Command `dbt clean` succeeded at 19:27:54.277670 after 0.17 seconds
[0m19:27:54.277920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2db7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c86fe90>]}
[0m19:27:54.278108 [debug] [MainThread]: Flushing usage events
[0m19:27:56.485292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:17.614336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297f80>]}


============================== 19:51:17.618408 | 1f997a67-5f6c-4331-a6be-6336eda052f0 ==============================
[0m19:51:17.618408 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:51:17.618893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init dbt_dpd', 'send_anonymous_usage_stats': 'True'}
[0m19:51:17.633463 [info ] [MainThread]: Setting up your profile.
[0m19:51:34.388052 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 16.833208, "process_in_blocks": "0", "process_kernel_time": 0.203994, "process_mem_max_rss": "98009088", "process_out_blocks": "0", "process_user_time": 0.990228}
[0m19:51:34.391112 [debug] [MainThread]: Command `dbt init` succeeded at 19:51:34.390708 after 16.84 seconds
[0m19:51:34.392365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e65700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106329520>]}
[0m19:51:34.393185 [debug] [MainThread]: Flushing usage events
[0m19:51:36.371614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:00.400799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b993ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9c4290>]}


============================== 20:02:00.404856 | 0864ac40-9a7a-4e84-91e3-9ba22a880446 ==============================
[0m20:02:00.404856 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:02:00.405377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:00.540394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0864ac40-9a7a-4e84-91e3-9ba22a880446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba55190>]}
[0m20:02:00.557495 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2154295, "process_in_blocks": "0", "process_kernel_time": 0.224751, "process_mem_max_rss": "98140160", "process_out_blocks": "0", "process_user_time": 1.097294}
[0m20:02:00.557956 [debug] [MainThread]: Command `dbt clean` succeeded at 20:02:00.557877 after 0.22 seconds
[0m20:02:00.558231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b993ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f6a80>]}
[0m20:02:00.558498 [debug] [MainThread]: Flushing usage events
[0m20:02:02.586798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:10.713982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dcc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8140>]}


============================== 20:02:10.718154 | 78d654f3-4437-4bdd-a257-9027eccfb6ce ==============================
[0m20:02:10.718154 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:02:10.718723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m20:02:12.149756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517dc10>]}
[0m20:02:12.191581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106719eb0>]}
[0m20:02:12.192152 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:02:12.352556 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:02:12.353328 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:02:12.353648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217e2660>]}
[0m20:02:13.244907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b7aed0>]}
[0m20:02:13.321540 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:02:13.324185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:02:13.345088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121be78f0>]}
[0m20:02:13.345814 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:02:13.346226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217e2cc0>]}
[0m20:02:13.347785 [info ] [MainThread]: 
[0m20:02:13.348108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:02:13.348323 [info ] [MainThread]: 
[0m20:02:13.348776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:13.353342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:02:13.353911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:02:13.354190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:13.354637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:02:13.354871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:13.355308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:15.122905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_dimfact)
[0m20:02:15.124128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_staging)
[0m20:02:15.124692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_marts)
[0m20:02:15.125850 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_dimfact"
"
[0m20:02:15.126412 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_staging"
"
[0m20:02:15.126896 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_marts"
"
[0m20:02:15.140804 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_dimfact: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_dimfact"} */
create schema if not exists `purwadika`.`diego_dwh_library_dimfact`
  
[0m20:02:15.142867 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_staging"} */
create schema if not exists `purwadika`.`diego_dwh_library_staging`
  
[0m20:02:15.144325 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_marts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_marts"} */
create schema if not exists `purwadika`.`diego_dwh_library_marts`
  
[0m20:02:15.144738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:15.145139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:15.145495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:15.914144 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:93d09274-5464-46af-9473-b960d7550640&page=queryresults
[0m20:02:16.058613 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7838594d-74bf-4939-9274-e75010bc7dba&page=queryresults
[0m20:02:16.228284 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:36102c73-c8b6-4f3c-8c82-a3874852340d&page=queryresults
[0m20:02:26.431687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_marts, now list_purwadika_diego_dwh_library_dimfact)
[0m20:02:26.432965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_staging, now list_purwadika_diego_dwh_library_staging)
[0m20:02:26.433578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_dimfact, now list_purwadika_diego_dwh_library_marts)
[0m20:02:26.434003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:26.434471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:26.434833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:27.120420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a22ff0>]}
[0m20:02:27.121421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:27.226848 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:02:27.227948 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:02:27.228303 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:02:27.227608 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:02:27.228736 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:02:27.229276 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:02:27.229808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m20:02:27.230295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m20:02:27.230792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m20:02:27.231144 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:02:27.231440 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:02:27.231808 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:02:27.244182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:02:27.247045 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:02:27.251503 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:02:27.252719 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:02:27.253054 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:02:27.253320 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:02:27.375549 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:02:27.376200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:02:27.378212 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:02:27.379594 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m20:02:27.379971 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:02:27.380278 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:02:27.380613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:02:27.380930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:02:27.381319 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:02:28.379049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d0d0c255-3b54-4769-bc90-60390d6b626c&page=queryresults
[0m20:02:28.390607 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:651bcdc6-4a3d-4fa1-8f9f-bbfc3c10a01c&page=queryresults
[0m20:02:28.391781 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:04c7aae4-725d-416f-a8d8-d1432bb8b712&page=queryresults
[0m20:02:30.557928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12162ba70>]}
[0m20:02:30.558259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121687200>]}
[0m20:02:30.559106 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107677a10>]}
[0m20:02:30.558805 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.32s]
[0m20:02:30.559683 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.33s]
[0m20:02:30.560239 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.32s]
[0m20:02:30.561036 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:02:30.561685 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:02:30.562249 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:02:30.563310 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:02:30.563744 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:02:30.564165 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:02:30.564589 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_users
[0m20:02:30.565072 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:02:30.565638 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:02:30.570631 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:02:30.571094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_users)
[0m20:02:30.571591 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:02:30.574692 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:02:30.575464 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_users
[0m20:02:30.577712 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:02:30.578002 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:02:30.581654 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:02:30.582236 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m20:02:30.582571 [debug] [Thread-2 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m20:02:30.582933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:02:30.583407 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:02:31.545685 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:21f52efa-a23f-4d5a-83b2-2cb236b6f74b&page=queryresults
[0m20:02:31.567176 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8aae75c5-3cda-4b7e-a767-99e5bb5e5bfb&page=queryresults
[0m20:02:33.605769 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d632f0>]}
[0m20:02:33.607007 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.04s]
[0m20:02:33.607793 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:02:33.695235 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126927e90>]}
[0m20:02:33.696068 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.12s]
[0m20:02:33.696829 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_users
[0m20:02:33.697928 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m20:02:33.698563 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:02:33.699172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m20:02:33.699622 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:02:33.706857 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:02:33.707984 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:02:33.711431 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:02:33.712157 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m20:02:33.712528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:02:34.411281 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:07fbbfbb-560d-45df-a4b9-9a73883bf664&page=queryresults
[0m20:02:36.499488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d817c0>]}
[0m20:02:36.500500 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.80s]
[0m20:02:36.501334 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:02:36.502369 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:02:36.502921 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:02:36.503402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:02:36.503778 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:02:36.508998 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:02:36.510246 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:02:36.513673 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:02:36.514464 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT 
        user_id,
        user_name,
        book_id,
        created_at,  -- Pastikan kolom ini ada
        return_date
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT 
        user_id,
        email 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT 
        book_id,
        release_year
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m20:02:36.514809 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:02:37.381239 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a0052fec-88a2-478c-bf86-6367eaa079d5&page=queryresults
[0m20:02:37.446280 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a0052fec-88a2-478c-bf86-6367eaa079d5&page=queryresults
[0m20:02:37.461570 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:02:37.462043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d654f3-4437-4bdd-a257-9027eccfb6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab20f0>]}
[0m20:02:37.462505 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.96s]
[0m20:02:37.462899 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:02:37.463484 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:02:37.465997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:02:37.561091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:37.561436 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m20:02:37.561644 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:02:37.561825 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:02:37.561995 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:02:37.562298 [info ] [MainThread]: 
[0m20:02:37.562541 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 24.21 seconds (24.21s).
[0m20:02:37.563537 [debug] [MainThread]: Command end result
[0m20:02:37.581253 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:02:37.583430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:02:37.588554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:02:37.588866 [info ] [MainThread]: 
[0m20:02:37.589137 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:02:37.589358 [info ] [MainThread]: 
[0m20:02:37.589611 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:02:37.589813 [info ] [MainThread]: 
[0m20:02:37.590038 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:02:37.590493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.931524, "process_in_blocks": "0", "process_kernel_time": 0.65631, "process_mem_max_rss": "210599936", "process_out_blocks": "0", "process_user_time": 5.205452}
[0m20:02:37.590946 [debug] [MainThread]: Command `dbt run` failed at 20:02:37.590886 after 26.93 seconds
[0m20:02:37.591245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d9af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dcc20>]}
[0m20:02:37.591485 [debug] [MainThread]: Flushing usage events
[0m20:02:39.062833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:20.897192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107199a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c8350>]}


============================== 20:19:20.901274 | 38e8f7bb-3cc2-4033-b127-aacb8b9f699b ==============================
[0m20:19:20.901274 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:19:20.901794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:19:22.335143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13014d730>]}
[0m20:19:22.373466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106146210>]}
[0m20:19:22.373976 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:19:22.515600 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:19:22.608844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:22.609341 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:19:22.785584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1307a8cb0>]}
[0m20:19:22.834964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:19:22.837145 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:19:22.854574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13087d730>]}
[0m20:19:22.854984 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:19:22.855488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305b2960>]}
[0m20:19:22.857214 [info ] [MainThread]: 
[0m20:19:22.857557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:22.857892 [info ] [MainThread]: 
[0m20:19:22.858599 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:19:22.862972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:19:22.863290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:22.863818 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:19:22.864057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:22.864457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:19:22.864854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:24.288300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:19:24.289020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:19:24.289417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:24.289919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:19:24.290351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:24.290813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:24.946879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1307a9e50>]}
[0m20:19:24.947823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:25.057689 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:19:25.058264 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:19:25.059426 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:19:25.059033 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:19:25.060159 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:19:25.060816 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:19:25.061510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m20:19:25.061975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m20:19:25.062476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m20:19:25.062946 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:19:25.063233 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:19:25.063520 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:19:25.078610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:19:25.082938 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:19:25.087468 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:19:25.089091 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:19:25.089553 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:19:25.095353 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:19:25.148543 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:19:25.151165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:25.151998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:25.778021 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:19:25.779476 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m20:19:25.782217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:19:25.782782 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:19:25.824646 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:19:25.825368 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:19:26.193117 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d0194d2e-13a7-413f-9255-6e3a5f0d9dd2&page=queryresults
[0m20:19:26.195371 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0c64049c-fe24-4da0-b91e-115ca77a35f0&page=queryresults
[0m20:19:26.196089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7f0e7500-c2fb-4bc5-bcc3-3a8d4ee75486&page=queryresults
[0m20:19:27.871261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130dfae70>]}
[0m20:19:27.871656 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106732f00>]}
[0m20:19:27.872007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e34ef0>]}
[0m20:19:27.872702 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.81s]
[0m20:19:27.873348 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.81s]
[0m20:19:27.874445 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:19:27.874007 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 2.81s]
[0m20:19:27.874909 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:19:27.875601 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:19:27.875972 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:19:27.876590 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m20:19:27.877143 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:19:27.877708 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:19:27.878313 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:19:27.878844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m20:19:27.879256 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:19:27.879554 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:19:27.882737 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:19:27.885844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:19:27.886779 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:19:27.887072 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m20:19:27.888985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:19:27.891799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:28.397831 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:19:28.399003 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:19:28.442653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:19:28.445930 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:19:28.656833 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:55b5418f-206c-48da-b1c2-58656eccfe1b&page=queryresults
[0m20:19:28.914987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:94572531-06b6-4cc3-a18b-7bcfeb5ead28&page=queryresults
[0m20:19:30.248763 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e54890>]}
[0m20:19:30.250186 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.37s]
[0m20:19:30.250961 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:19:30.455122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e46750>]}
[0m20:19:30.455942 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.58s]
[0m20:19:30.456616 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m20:19:30.457809 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m20:19:30.458442 [info ] [Thread-2 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:19:30.459239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.fact_rents)
[0m20:19:30.459735 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:19:30.470727 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:19:30.472448 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:19:30.474856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:30.863571 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:19:30.865073 [debug] [Thread-2 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:19:31.139934 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:71d901a6-2ee4-4231-bee5-1646249dd579&page=queryresults
[0m20:19:33.009662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e08050>]}
[0m20:19:33.010519 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.55s]
[0m20:19:33.011470 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:19:33.012400 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:19:33.013013 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:19:33.013673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:19:33.014072 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:19:33.019329 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:19:33.021199 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:19:33.046737 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:19:33.047688 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT 
        user_id,
        user_name,
        book_id,
        created_at,  -- Pastikan kolom ini ada
        return_date
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT 
        user_id,
        email 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT 
        book_id,
        release_year
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m20:19:33.048086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:19:33.594565 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e1696f09-80f3-454f-a879-6e178edde20c&page=queryresults
[0m20:19:33.676885 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e1696f09-80f3-454f-a879-6e178edde20c&page=queryresults
[0m20:19:33.689157 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:19:33.689831 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e8f7bb-3cc2-4033-b127-aacb8b9f699b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e16ff0>]}
[0m20:19:33.690321 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.68s]
[0m20:19:33.690796 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:19:33.691207 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:19:33.693950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:33.791693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:33.792028 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:19:33.792237 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:19:33.792427 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m20:19:33.792607 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:19:33.792903 [info ] [MainThread]: 
[0m20:19:33.793259 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m20:19:33.795152 [debug] [MainThread]: Command end result
[0m20:19:33.813045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:19:33.815798 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:19:33.821440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:19:33.821971 [info ] [MainThread]: 
[0m20:19:33.822318 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:19:33.822850 [info ] [MainThread]: 
[0m20:19:33.823180 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:19:33.823406 [info ] [MainThread]: 
[0m20:19:33.823661 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:19:33.824166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.985698, "process_in_blocks": "0", "process_kernel_time": 0.647553, "process_mem_max_rss": "223739904", "process_out_blocks": "0", "process_user_time": 4.076359}
[0m20:19:33.824617 [debug] [MainThread]: Command `dbt run` failed at 20:19:33.824558 after 12.99 seconds
[0m20:19:33.824946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077421b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c523c0>]}
[0m20:19:33.825204 [debug] [MainThread]: Flushing usage events
[0m20:19:35.917257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:26.695970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e73bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e73f80>]}


============================== 20:20:26.700073 | 497d6f5f-2dc5-4802-b461-7f8220d43641 ==============================
[0m20:20:26.700073 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:20:26.700560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:26.824683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497d6f5f-2dc5-4802-b461-7f8220d43641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb7410>]}
[0m20:20:26.847406 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20583504, "process_in_blocks": "0", "process_kernel_time": 0.220376, "process_mem_max_rss": "98893824", "process_out_blocks": "0", "process_user_time": 1.023219}
[0m20:20:26.847867 [debug] [MainThread]: Command `dbt clean` succeeded at 20:20:26.847790 after 0.21 seconds
[0m20:20:26.848142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6f530>]}
[0m20:20:26.848400 [debug] [MainThread]: Flushing usage events
[0m20:20:28.205006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:46.245927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106918530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074692e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c83e0>]}


============================== 20:38:46.248981 | bd065f0a-8f13-40c8-9dc5-ee160e52860f ==============================
[0m20:38:46.248981 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:38:46.249316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:47.266115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106994440>]}
[0m20:38:47.289635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071819a0>]}
[0m20:38:47.289965 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:38:47.382220 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:38:47.382674 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:38:47.382873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9602f0>]}
[0m20:38:47.874051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884770>]}
[0m20:38:47.903959 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:38:47.905053 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:38:47.917383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2deea0>]}
[0m20:38:47.917629 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:38:47.917806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2f5b50>]}
[0m20:38:47.918662 [info ] [MainThread]: 
[0m20:38:47.918856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:47.918999 [info ] [MainThread]: 
[0m20:38:47.919231 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:38:47.920996 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:38:47.921204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:47.921468 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:38:47.921730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:38:47.921935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:47.922080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:49.367704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:38:49.368535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:38:49.369217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:38:49.369666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.370332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.370853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.946854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884770>]}
[0m20:38:49.947781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:50.043410 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:38:50.043748 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:38:50.043949 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:38:50.044235 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:38:50.044546 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:38:50.044844 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:38:50.045146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m20:38:50.045335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m20:38:50.045507 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m20:38:50.045674 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:38:50.045832 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:38:50.045989 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:38:50.051133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:38:50.053375 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:38:50.055523 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:38:50.056283 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:38:50.056474 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:38:50.056650 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:38:50.079152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:50.079909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:50.081053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:50.616431 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:38:50.618348 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:38:50.618571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:38:50.619263 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:38:50.619583 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:38:50.619832 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m20:38:50.896902 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f86f4952-94e5-46ef-92dd-b9c48eef9a1c&page=queryresults
[0m20:38:50.901553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:56fb89c6-d77c-49ab-8bbd-93700d4e9af1&page=queryresults
[0m20:38:50.910953 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0c6a8a48-f544-41d6-a209-ff488d530029&page=queryresults
[0m20:38:52.554588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec2ff50>]}
[0m20:38:52.554841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ece3980>]}
[0m20:38:52.555217 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 2.51s]
[0m20:38:52.555913 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:38:52.555640 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.51s]
[0m20:38:52.556313 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:38:52.556591 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m20:38:52.556839 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:38:52.557105 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m20:38:52.557287 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:38:52.559472 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:38:52.559952 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m20:38:52.561290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:38:52.628394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5ac0b0>]}
[0m20:38:52.628733 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.58s]
[0m20:38:52.629024 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:38:52.629284 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m20:38:52.629481 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:38:52.629672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m20:38:52.629866 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:38:52.631718 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:38:52.632124 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m20:38:52.633285 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:53.050971 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:38:53.054082 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:38:53.288291 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:38:53.290579 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:38:53.316920 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a37c24c2-11ec-4189-934c-41a4ce899ef7&page=queryresults
[0m20:38:53.578348 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f4d8f84c-b5c9-4787-a7fa-84f57f7c9b66&page=queryresults
[0m20:38:54.863640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2e8aa0>]}
[0m20:38:54.865240 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.23s]
[0m20:38:54.866219 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m20:38:55.326968 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1a3f20>]}
[0m20:38:55.328425 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.77s]
[0m20:38:55.329439 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m20:38:55.330819 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m20:38:55.331661 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:38:55.332357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m20:38:55.332994 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:38:55.342747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:38:55.344211 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:38:55.347590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:55.663844 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:38:55.666491 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:38:55.929373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8a263dc1-a965-43c1-a1db-3debe36336c5&page=queryresults
[0m20:38:57.751821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c253b30>]}
[0m20:38:57.753200 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.42s]
[0m20:38:57.754102 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:38:57.755779 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:38:57.756855 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:38:57.757639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:38:57.758122 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:38:57.763990 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:38:57.765262 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:38:57.790227 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:38:57.791052 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT 
        user_id,
        user_name,
        book_id,
        created_at,  -- Pastikan kolom ini ada
        return_date
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT 
        user_id,
        email 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT 
        book_id,
        release_year
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m20:38:57.791450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:58.345858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c56bc2cc-3784-4d64-ad45-e13ea6973de8&page=queryresults
[0m20:38:58.425203 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c56bc2cc-3784-4d64-ad45-e13ea6973de8&page=queryresults
[0m20:38:58.444049 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:38:58.444927 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd065f0a-8f13-40c8-9dc5-ee160e52860f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2eaff0>]}
[0m20:38:58.445771 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.69s]
[0m20:38:58.446393 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:38:58.447000 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:38:58.449087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:58.528597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:58.528846 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:38:58.528978 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:38:58.529095 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:38:58.529208 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:38:58.529382 [info ] [MainThread]: 
[0m20:38:58.529560 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m20:38:58.530215 [debug] [MainThread]: Command end result
[0m20:38:58.590180 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:38:58.591349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:38:58.593985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:38:58.594157 [info ] [MainThread]: 
[0m20:38:58.594354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:58.594517 [info ] [MainThread]: 
[0m20:38:58.594704 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:38:58.594849 [info ] [MainThread]: 
[0m20:38:58.595004 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:38:58.595225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.44973, "process_in_blocks": "0", "process_kernel_time": 0.414041, "process_mem_max_rss": "228474880", "process_out_blocks": "0", "process_user_time": 3.182885}
[0m20:38:58.595439 [debug] [MainThread]: Command `dbt run` failed at 20:38:58.595404 after 12.45 seconds
[0m20:38:58.595601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105406ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685b8f0>]}
[0m20:38:58.595754 [debug] [MainThread]: Flushing usage events
[0m20:39:01.838171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:42.328153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103339e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e98740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e983e0>]}


============================== 20:55:42.331215 | 0996090f-921a-489e-abb4-4ecd59c57083 ==============================
[0m20:55:42.331215 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:55:42.331576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:43.371630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e53d730>]}
[0m20:55:43.395408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e024e90>]}
[0m20:55:43.395732 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:55:43.490274 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:55:43.555870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:43.556229 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:55:43.671511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9de1e0>]}
[0m20:55:43.702905 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:55:43.704334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:55:43.717966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea70500>]}
[0m20:55:43.718257 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:55:43.718444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e44e3f0>]}
[0m20:55:43.719367 [info ] [MainThread]: 
[0m20:55:43.719557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:55:43.719697 [info ] [MainThread]: 
[0m20:55:43.719934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:55:43.721783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:55:43.722009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:43.722211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:55:43.722518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:55:43.722685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:43.722876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:45.887206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:55:45.888467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:55:45.889496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:55:45.890293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:45.890922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:45.891380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:46.493202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e615850>]}
[0m20:55:46.494243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:46.580016 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:55:46.580238 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:55:46.580414 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:55:46.580649 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:55:46.580917 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:55:46.581149 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:55:46.581366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m20:55:46.581528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m20:55:46.581678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m20:55:46.581849 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:55:46.581990 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:55:46.582123 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:55:46.589002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:55:46.590826 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:55:46.592600 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:55:46.594008 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:55:46.594251 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:55:46.594436 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:55:46.615146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:46.616454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:46.617568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:47.116096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:55:47.118401 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:55:47.118656 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:55:47.119969 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:55:47.120309 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m20:55:47.120625 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:55:47.422529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:39f69ecd-6209-4e3b-8697-16e001f6405e&page=queryresults
[0m20:55:47.520359 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b7811898-3454-44c5-aa91-0f53d4b87f27&page=queryresults
[0m20:55:47.543667 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1fd6fb17-ea2e-4a86-8db0-224edb5eed97&page=queryresults
[0m20:55:49.066308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e42f8f0>]}
[0m20:55:49.066894 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.48s]
[0m20:55:49.067287 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:55:49.067683 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:55:49.067932 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:55:49.068206 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:55:49.068394 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:55:49.070737 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:55:49.071174 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:55:49.072641 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:55:49.147756 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecd0ec0>]}
[0m20:55:49.148108 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 2.57s]
[0m20:55:49.148432 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:55:49.227932 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ece7050>]}
[0m20:55:49.228384 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.65s]
[0m20:55:49.228758 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:55:49.229122 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m20:55:49.229451 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:55:49.229732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m20:55:49.229951 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:55:49.232621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:55:49.233166 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m20:55:49.235001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:49.469983 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:55:49.471981 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:55:49.588478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:55:49.592022 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:55:49.738661 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:acc04fa9-4563-41e5-aa33-a8fc53902787&page=queryresults
[0m20:55:49.844549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a6fdb40d-3ad3-4556-a8c1-489adf5076ff&page=queryresults
[0m20:55:51.195604 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291fd010>]}
[0m20:55:51.196943 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.13s]
[0m20:55:51.197939 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:55:51.597478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292b7dd0>]}
[0m20:55:51.599114 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.37s]
[0m20:55:51.600545 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m20:55:51.602520 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m20:55:51.603263 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:55:51.603966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m20:55:51.604740 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:55:51.612876 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:55:51.614082 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:55:51.617337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:55:52.022100 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:55:52.025103 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:55:52.280432 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e68f86ae-c4d6-451f-b51b-2bb98a48d2f0&page=queryresults
[0m20:55:53.919510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef11eb0>]}
[0m20:55:53.920743 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.32s]
[0m20:55:53.921682 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:55:53.922822 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:55:53.923605 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:55:53.924844 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:55:53.925338 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:55:53.931253 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:55:53.933067 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:55:53.961627 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:55:53.962565 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m20:55:53.962945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:55:54.605090 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5682dcae-855b-4153-9acc-8eeb85d6f929&page=queryresults
[0m20:55:54.663955 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5682dcae-855b-4153-9acc-8eeb85d6f929&page=queryresults
[0m20:55:54.681962 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:55:54.682952 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0996090f-921a-489e-abb4-4ecd59c57083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eaae180>]}
[0m20:55:54.683881 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.76s]
[0m20:55:54.684629 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:55:54.685412 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:55:54.688321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:54.768589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:54.768893 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:55:54.769045 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:55:54.769175 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:55:54.769291 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:55:54.769511 [info ] [MainThread]: 
[0m20:55:54.769695 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m20:55:54.770380 [debug] [MainThread]: Command end result
[0m20:55:54.781677 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:55:54.786347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:55:54.792994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:55:54.793174 [info ] [MainThread]: 
[0m20:55:54.793371 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:55:54.793527 [info ] [MainThread]: 
[0m20:55:54.793706 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:55:54.793843 [info ] [MainThread]: 
[0m20:55:54.793991 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:55:54.794307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.501847, "process_in_blocks": "0", "process_kernel_time": 0.428449, "process_mem_max_rss": "220758016", "process_out_blocks": "0", "process_user_time": 2.817618}
[0m20:55:54.794663 [debug] [MainThread]: Command `dbt run` failed at 20:55:54.794624 after 12.50 seconds
[0m20:55:54.794891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e985f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e614770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e961df0>]}
[0m20:55:54.795049 [debug] [MainThread]: Flushing usage events
[0m20:55:56.994229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:18.070451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c3aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8320>]}


============================== 20:56:18.073409 | c5f06174-6ec2-48be-a461-bb546bca4117 ==============================
[0m20:56:18.073409 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:56:18.073824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:19.065154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c941a0>]}
[0m20:56:19.088787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdd1400>]}
[0m20:56:19.089126 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:56:19.190593 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:56:19.255134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:19.255472 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:56:19.361782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0bccb0>]}
[0m20:56:19.392130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:56:19.393377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:56:19.405601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1714f0>]}
[0m20:56:19.405851 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:56:19.406026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a516000>]}
[0m20:56:19.407120 [info ] [MainThread]: 
[0m20:56:19.407334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:19.407478 [info ] [MainThread]: 
[0m20:56:19.407714 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:56:19.409570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:56:19.409782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:19.409975 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:56:19.410276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:56:19.410492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:19.410647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:20.499444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:56:20.500612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:56:20.501420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:56:20.501942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:20.502537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:20.502984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:21.026320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a515940>]}
[0m20:56:21.027914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:21.124795 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:56:21.125090 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:56:21.125286 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:56:21.125531 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:56:21.125812 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:56:21.126093 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:56:21.126346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m20:56:21.126576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m20:56:21.126755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m20:56:21.126930 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:56:21.127084 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:56:21.127223 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:56:21.134434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:56:21.136148 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:56:21.137795 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:56:21.139488 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:56:21.139659 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:56:21.139808 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:56:21.162717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:21.163826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:21.165008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:21.700450 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:56:21.703086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:56:21.704637 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:56:21.704984 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:56:21.724054 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:56:21.724805 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m20:56:21.981533 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b00caf85-cd8c-4cc5-865b-a019e6e10eae&page=queryresults
[0m20:56:21.982304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e1a3bbaf-53e6-4a12-a219-c00eccb0179d&page=queryresults
[0m20:56:22.000833 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:eb8278fc-4fb2-4186-93ea-0d05e9ea4a77&page=queryresults
[0m20:56:23.610237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b28c260>]}
[0m20:56:23.610748 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.48s]
[0m20:56:23.611251 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:56:23.611631 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:56:23.611886 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:56:23.612292 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:56:23.612508 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:56:23.614971 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:56:23.615598 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:56:23.617102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:56:23.806062 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26a960>]}
[0m20:56:23.807006 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.68s]
[0m20:56:23.807533 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:56:23.807967 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m20:56:23.808315 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:56:23.808633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m20:56:23.808891 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:56:23.812158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:56:23.814392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b28e540>]}
[0m20:56:23.814903 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 2.69s]
[0m20:56:23.815240 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m20:56:23.815555 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:56:23.817415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:24.206026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:56:24.208741 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m20:56:24.279701 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:56:24.282785 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:56:24.468082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:00ebde8d-2a89-4168-b9ca-f11b1fe1a62f&page=queryresults
[0m20:56:24.528719 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ac24c593-f3ee-417e-a200-c8fb83e8c72f&page=queryresults
[0m20:56:25.996431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6f62a0>]}
[0m20:56:25.997924 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.19s]
[0m20:56:25.999053 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m20:56:26.046109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b0a1010>]}
[0m20:56:26.047119 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.43s]
[0m20:56:26.047916 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:56:26.048842 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m20:56:26.049533 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:56:26.050209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m20:56:26.050682 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:56:26.055903 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:56:26.056731 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:56:26.059499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:26.475955 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:56:26.478365 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`fact_rents` as DBT_INTERNAL_DEST
        using (

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    WHERE rents_staging.created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`user_name` = DBT_INTERNAL_SOURCE.`user_name`,`email` = DBT_INTERNAL_SOURCE.`email`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`rent_id`, `rent_date`, `return_date`, `user_id`, `user_name`, `email`, `book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m20:56:26.721509 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:68051ac4-145c-4433-aa85-ba051dbda7f8&page=queryresults
[0m20:56:28.394428 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b311340>]}
[0m20:56:28.396236 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mMERGE (0.0 rows, 5.7 KiB processed)[0m in 2.34s]
[0m20:56:28.397314 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:56:28.398660 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:56:28.399299 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:56:28.399955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m20:56:28.400405 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:56:28.406471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:56:28.407722 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:56:28.432771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:56:28.433452 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    --DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, --DATE(fact_rents.created_at)
    );
  
[0m20:56:28.433789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:28.849268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3fa04f49-9ac9-41bf-8ff8-f07e34d47408&page=queryresults
[0m20:56:28.851364 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3fa04f49-9ac9-41bf-8ff8-f07e34d47408&page=queryresults
[0m20:56:28.864889 [debug] [Thread-1 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:56:28.865714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f06174-6ec2-48be-a461-bb546bca4117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7b8b60>]}
[0m20:56:28.866487 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.47s]
[0m20:56:28.867103 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:56:28.867615 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:56:28.869622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:28.947813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:28.948010 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:56:28.948136 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:56:28.948249 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:56:28.948362 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m20:56:28.948532 [info ] [MainThread]: 
[0m20:56:28.948692 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.54 seconds (9.54s).
[0m20:56:28.949342 [debug] [MainThread]: Command end result
[0m20:56:28.960242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:56:28.961371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:56:28.964063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:56:28.964227 [info ] [MainThread]: 
[0m20:56:28.964410 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:28.964556 [info ] [MainThread]: 
[0m20:56:28.964726 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:56:28.964861 [info ] [MainThread]: 
[0m20:56:28.965001 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:56:28.965232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.929839, "process_in_blocks": "0", "process_kernel_time": 0.397771, "process_mem_max_rss": "224362496", "process_out_blocks": "0", "process_user_time": 2.810074}
[0m20:56:28.965492 [debug] [MainThread]: Command `dbt run` failed at 20:56:28.965452 after 10.93 seconds
[0m20:56:28.965680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a515dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f91fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c3aba0>]}
[0m20:56:28.965846 [debug] [MainThread]: Flushing usage events
[0m20:56:30.482727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:12.924705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438470>]}


============================== 20:57:12.928126 | 1feb973e-1bb9-4eef-9b63-a73cf075e2e5 ==============================
[0m20:57:12.928126 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:57:12.928522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:57:13.940703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c90a0>]}
[0m20:57:13.965263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c2e060>]}
[0m20:57:13.965607 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:57:14.060506 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:57:14.123746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:14.124071 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:57:14.230699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e3a090>]}
[0m20:57:14.261084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:57:14.262779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:57:14.275702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174713d0>]}
[0m20:57:14.275943 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:57:14.276113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174ada30>]}
[0m20:57:14.276986 [info ] [MainThread]: 
[0m20:57:14.277173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:14.277307 [info ] [MainThread]: 
[0m20:57:14.277528 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:14.279411 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:14.279627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:14.279833 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:14.280121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:14.280314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:14.280485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:15.555878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:57:15.557815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:57:15.558432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:15.559136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:57:15.559852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:15.560534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:16.152803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174b01d0>]}
[0m20:57:16.154449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:16.249024 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:57:16.249337 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:57:16.249537 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:57:16.249781 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:57:16.250091 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:57:16.250451 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:57:16.250717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m20:57:16.250909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m20:57:16.251066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m20:57:16.251228 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:57:16.251374 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:57:16.251511 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:57:16.258832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:57:16.260527 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:57:16.262190 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:57:16.263833 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:57:16.264031 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:57:16.264180 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:57:16.285794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:16.287144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:16.288307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:16.749991 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:57:16.751045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:57:16.752828 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m20:57:16.753172 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:57:16.760011 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:57:16.760549 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:57:16.986864 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5105f196-6045-4d01-93b3-8be45a845a0a&page=queryresults
[0m20:57:16.991755 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:be05aa08-28b0-49d6-92d6-a383905f2dc7&page=queryresults
[0m20:57:17.030416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:90a207aa-3029-4ba1-88cc-7b429fde4d27&page=queryresults
[0m20:57:18.673236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d63aa0>]}
[0m20:57:18.673630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179001a0>]}
[0m20:57:18.674098 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.42s]
[0m20:57:18.674606 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.42s]
[0m20:57:18.675058 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:57:18.675405 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:57:18.675823 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:57:18.676079 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m20:57:18.676395 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:57:18.676750 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:57:18.677111 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:57:18.677353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m20:57:18.677582 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:57:18.677793 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:57:18.680529 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:57:18.682874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:57:18.683582 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m20:57:18.683855 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:57:18.685465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:18.686906 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:57:18.988297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117572900>]}
[0m20:57:18.988782 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.74s]
[0m20:57:18.989308 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:57:19.115146 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:57:19.117129 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m20:57:19.133863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:57:19.135410 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m20:57:19.336447 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5f77a492-fb07-4cc6-a3e4-39fe333e9025&page=queryresults
[0m20:57:19.395267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6a049e27-5142-4a7f-96b4-d8c6abaa1403&page=queryresults
[0m20:57:21.021810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174b0260>]}
[0m20:57:21.023323 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.34s]
[0m20:57:21.024608 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:57:21.038757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117aa5460>]}
[0m20:57:21.039932 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.36s]
[0m20:57:21.041052 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m20:57:21.042400 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m20:57:21.043318 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:57:21.043991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m20:57:21.044480 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:57:21.049806 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:57:21.052041 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:57:21.054680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:21.393327 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:57:21.395756 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m20:57:21.628604 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bb7b73b6-6782-4476-8c93-bed60e6f95ba&page=queryresults
[0m20:57:24.167229 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117aaf440>]}
[0m20:57:24.168805 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 3.12s]
[0m20:57:24.169816 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:57:24.171089 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:57:24.171965 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:57:24.172604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:57:24.173089 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:57:24.180804 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:57:24.182212 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:57:24.185799 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:57:24.186949 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    --DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m20:57:24.187539 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:24.735344 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9343ff3a-3e7a-487c-be8a-760917f453b3&page=queryresults
[0m20:57:24.792810 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9343ff3a-3e7a-487c-be8a-760917f453b3&page=queryresults
[0m20:57:24.805160 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:57:24.805905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1feb973e-1bb9-4eef-9b63-a73cf075e2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ac3890>]}
[0m20:57:24.806617 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.63s]
[0m20:57:24.807326 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:57:24.807817 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:57:24.809767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:24.885906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:24.886105 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:57:24.886235 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:57:24.886349 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:57:24.886460 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:57:24.886629 [info ] [MainThread]: 
[0m20:57:24.886792 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m20:57:24.887442 [debug] [MainThread]: Command end result
[0m20:57:24.899233 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:57:24.900300 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:57:24.903263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:57:24.903425 [info ] [MainThread]: 
[0m20:57:24.903602 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:57:24.903741 [info ] [MainThread]: 
[0m20:57:24.903916 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:57:24.904053 [info ] [MainThread]: 
[0m20:57:24.904197 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:57:24.904427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.017302, "process_in_blocks": "0", "process_kernel_time": 0.397122, "process_mem_max_rss": "223330304", "process_out_blocks": "0", "process_user_time": 2.807602}
[0m20:57:24.904684 [debug] [MainThread]: Command `dbt run` failed at 20:57:24.904645 after 12.02 seconds
[0m20:57:24.904872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a174a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084386b0>]}
[0m20:57:24.905029 [debug] [MainThread]: Flushing usage events
[0m20:57:26.840978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:46.070550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104888290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dac920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dac5c0>]}


============================== 20:57:46.073531 | dfa749c7-f5f2-48a1-a964-5548acd49bdf ==============================
[0m20:57:46.073531 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:57:46.073966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:57:47.024965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423cfb0>]}
[0m20:57:47.048597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113831d00>]}
[0m20:57:47.048907 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:57:47.140360 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:57:47.202437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:47.202819 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:57:47.310866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc67e0>]}
[0m20:57:47.340327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:57:47.341455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:57:47.352594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d713a0>]}
[0m20:57:47.352842 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:57:47.353022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113db00e0>]}
[0m20:57:47.353880 [info ] [MainThread]: 
[0m20:57:47.354060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:47.354195 [info ] [MainThread]: 
[0m20:57:47.354419 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:47.356223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:47.356465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:47.356732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:47.356989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:47.357191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:57:47.431965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:48.541745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:57:48.542977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:57:48.543742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:57:48.544325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:48.544857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:48.545303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:49.098631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2fa600>]}
[0m20:57:49.100259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:49.194908 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:57:49.195172 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:57:49.195361 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:57:49.195603 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:57:49.195870 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:57:49.196134 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:57:49.196399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m20:57:49.196581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m20:57:49.196742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m20:57:49.196901 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:57:49.197050 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:57:49.197189 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:57:49.204187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:57:49.205931 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:57:49.207888 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:57:49.208422 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:57:49.208615 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:57:49.208794 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:57:49.230774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:49.231085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:49.232219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:49.759209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:57:49.759962 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:57:49.760817 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:57:49.761457 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:57:49.761782 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:57:49.762045 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m20:57:49.949839 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9d647133-0fff-4d2b-a102-0781c8ccee83&page=queryresults
[0m20:57:49.955615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:490129e2-0bd1-4399-a252-3ff797b56368&page=queryresults
[0m20:57:49.969110 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:287ec64d-2de1-49c8-adb4-6ef31655bc66&page=queryresults
[0m20:57:51.696957 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a6d50>]}
[0m20:57:51.697319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eac740>]}
[0m20:57:51.697876 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.50s]
[0m20:57:51.698466 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.50s]
[0m20:57:51.698973 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:57:51.699361 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:57:51.699852 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m20:57:51.700156 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m20:57:51.700515 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:57:51.700873 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:57:51.701270 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m20:57:51.701543 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m20:57:51.701809 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:57:51.702049 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:57:51.705095 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:57:51.707971 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:57:51.708586 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m20:57:51.708844 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m20:57:51.710687 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:57:51.712324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:51.940881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a2ea0>]}
[0m20:57:51.941490 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.74s]
[0m20:57:51.942155 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:57:52.115117 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:57:52.117427 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m20:57:52.244363 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:57:52.246433 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m20:57:52.389054 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c97415c1-5ad1-435b-8b35-d40a013109eb&page=queryresults
[0m20:57:52.479859 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:da025dc2-fa8a-4a73-955b-53909ae5d407&page=queryresults
[0m20:57:54.090711 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d7ddc0>]}
[0m20:57:54.092339 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.39s]
[0m20:57:54.093701 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m20:57:54.368820 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a7140>]}
[0m20:57:54.370295 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.67s]
[0m20:57:54.371287 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m20:57:54.372802 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m20:57:54.378063 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:57:54.379117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m20:57:54.379674 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:57:54.390374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:57:54.391521 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:57:54.394748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:54.768168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:57:54.770484 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m20:57:54.973335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f101748a-6a1f-4b67-a00f-96ae83c8c332&page=queryresults
[0m20:57:56.603234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d7cd40>]}
[0m20:57:56.604740 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.22s]
[0m20:57:56.606092 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:57:56.608225 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:57:56.609265 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:57:56.609992 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m20:57:56.610641 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:57:56.618151 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:57:56.619707 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:57:56.625041 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:57:56.626242 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, --DATE(fact_rents.created_at)
    );
  
[0m20:57:56.626750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:56.980745 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:012f4c87-1953-4559-81b0-00af74d37e15&page=queryresults
[0m20:57:56.982493 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:012f4c87-1953-4559-81b0-00af74d37e15&page=queryresults
[0m20:57:56.998395 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:57:56.999306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa749c7-f5f2-48a1-a964-5548acd49bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a6180>]}
[0m20:57:57.000136 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.39s]
[0m20:57:57.000754 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:57:57.001354 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:57:57.003389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:57.084330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:57.084556 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:57:57.084686 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:57:57.084805 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m20:57:57.084918 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:57:57.085120 [info ] [MainThread]: 
[0m20:57:57.085283 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m20:57:57.085940 [debug] [MainThread]: Command end result
[0m20:57:57.096448 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:57:57.098410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:57:57.101179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:57:57.101351 [info ] [MainThread]: 
[0m20:57:57.101538 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:57:57.101690 [info ] [MainThread]: 
[0m20:57:57.101878 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Syntax error: Unexpected ")" at [43:5]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:57:57.102027 [info ] [MainThread]: 
[0m20:57:57.102183 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:57:57.102423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.067506, "process_in_blocks": "0", "process_kernel_time": 0.389617, "process_mem_max_rss": "222248960", "process_out_blocks": "0", "process_user_time": 2.805101}
[0m20:57:57.102689 [debug] [MainThread]: Command `dbt run` failed at 20:57:57.102654 after 11.07 seconds
[0m20:57:57.102870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daca10>]}
[0m20:57:57.103022 [debug] [MainThread]: Flushing usage events
[0m20:57:58.485489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:16.681380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc0290>]}


============================== 20:58:16.684087 | d964a24e-4124-4635-82cd-bf1c6afd6b73 ==============================
[0m20:58:16.684087 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:58:16.684396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m20:58:17.684753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d5730>]}
[0m20:58:17.708662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153886e0>]}
[0m20:58:17.708975 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:58:17.799828 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m20:58:18.093869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:18.094336 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m20:58:18.241952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242c6c60>]}
[0m20:58:18.272154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:58:18.273380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:58:18.285822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242755b0>]}
[0m20:58:18.286067 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m20:58:18.286248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164ddd90>]}
[0m20:58:18.287132 [info ] [MainThread]: 
[0m20:58:18.287319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:18.287454 [info ] [MainThread]: 
[0m20:58:18.287679 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:58:18.289501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:58:18.289774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:18.290037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:58:18.290334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m20:58:18.290484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:18.290677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:19.401552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m20:58:19.402862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m20:58:19.403488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:19.403909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m20:58:19.404309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:19.404811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:20.030460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157f52e0>]}
[0m20:58:20.031720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:20.126235 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m20:58:20.126507 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m20:58:20.126698 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m20:58:20.126942 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m20:58:20.127210 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m20:58:20.127463 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m20:58:20.127704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m20:58:20.127871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m20:58:20.128023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m20:58:20.128181 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m20:58:20.128330 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m20:58:20.128468 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m20:58:20.135834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m20:58:20.137558 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m20:58:20.139153 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m20:58:20.140412 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m20:58:20.140632 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m20:58:20.140838 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m20:58:20.174790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:20.175156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:20.176948 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:20.688439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m20:58:20.689024 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m20:58:20.689323 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m20:58:20.690181 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m20:58:20.690539 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:58:20.690835 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m20:58:20.913478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d2fe07c6-5b87-44ae-93f3-bdab41b5f1ef&page=queryresults
[0m20:58:20.918108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:264c0756-f563-4cb8-b382-11ab4bf1af20&page=queryresults
[0m20:58:20.920298 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:053eb65c-2378-48c6-ade4-ad9a5cdf7f1f&page=queryresults
[0m20:58:22.569828 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11552fa70>]}
[0m20:58:22.570611 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.44s]
[0m20:58:22.571894 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m20:58:22.572244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243ab6e0>]}
[0m20:58:22.572821 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.44s]
[0m20:58:22.573370 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m20:58:22.573764 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m20:58:22.574851 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m20:58:22.575242 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243e17c0>]}
[0m20:58:22.575707 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m20:58:22.576003 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m20:58:22.576407 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.45s]
[0m20:58:22.576720 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m20:58:22.577023 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m20:58:22.577384 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m20:58:22.580041 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m20:58:22.580308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m20:58:22.580623 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m20:58:22.583010 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m20:58:22.583412 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m20:58:22.585054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:22.651993 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m20:58:22.656974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:22.993317 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m20:58:22.996844 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m20:58:23.035196 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m20:58:23.037566 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m20:58:23.191936 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2a3b4bef-18ec-49d5-9d81-c72799ce86ee&page=queryresults
[0m20:58:23.220431 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a854d7c0-8c18-4b53-bb60-ab3300e5df62&page=queryresults
[0m20:58:24.842308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245dac30>]}
[0m20:58:24.843684 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.27s]
[0m20:58:24.844583 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m20:58:24.860977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124737890>]}
[0m20:58:24.862420 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.28s]
[0m20:58:24.863328 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m20:58:24.864453 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m20:58:24.865297 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m20:58:24.865973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m20:58:24.866375 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m20:58:24.871976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m20:58:24.872996 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m20:58:24.875817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:25.290046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m20:58:25.291689 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m20:58:25.506130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2f38d132-82ca-46f7-9f35-ed03c054e483&page=queryresults
[0m20:58:27.123107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246db260>]}
[0m20:58:27.125106 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.26s]
[0m20:58:27.126807 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m20:58:27.128736 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m20:58:27.130187 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m20:58:27.140088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m20:58:27.140413 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m20:58:27.158280 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m20:58:27.160729 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m20:58:27.162641 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m20:58:27.163087 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email
    );
  
[0m20:58:27.163329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:27.613055 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f497dbc9-510a-4bfe-af27-542d6e705f16&page=queryresults
[0m20:58:27.683700 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f497dbc9-510a-4bfe-af27-542d6e705f16&page=queryresults
[0m20:58:27.702672 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [34:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:58:27.703661 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd964a24e-4124-4635-82cd-bf1c6afd6b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12472a480>]}
[0m20:58:27.704573 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.57s]
[0m20:58:27.705219 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m20:58:27.706055 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [34:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m20:58:27.708798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:27.787989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:27.788220 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m20:58:27.788357 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m20:58:27.788478 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m20:58:27.788613 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m20:58:27.788959 [info ] [MainThread]: 
[0m20:58:27.789136 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m20:58:27.789939 [debug] [MainThread]: Command end result
[0m20:58:27.800880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m20:58:27.802328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m20:58:27.805270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m20:58:27.805431 [info ] [MainThread]: 
[0m20:58:27.805606 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:58:27.805744 [info ] [MainThread]: 
[0m20:58:27.805918 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  SELECT list expression references fact_rents.created_at which is neither grouped nor aggregated at [34:10]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m20:58:27.806056 [info ] [MainThread]: 
[0m20:58:27.806210 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m20:58:27.806646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.159608, "process_in_blocks": "0", "process_kernel_time": 0.424196, "process_mem_max_rss": "218808320", "process_out_blocks": "0", "process_user_time": 2.865252}
[0m20:58:27.807035 [debug] [MainThread]: Command `dbt run` failed at 20:58:27.806980 after 11.16 seconds
[0m20:58:27.807278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106faabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243c71d0>]}
[0m20:58:27.807470 [debug] [MainThread]: Flushing usage events
[0m20:58:29.118998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:32.595922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e745c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108324680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108324320>]}


============================== 21:09:32.598689 | 562fa957-bf01-4fa3-9756-8104064558d2 ==============================
[0m21:09:32.598689 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:09:32.599002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:09:33.686577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4f20>]}
[0m21:09:33.711157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d4950>]}
[0m21:09:33.711510 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:09:33.805142 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:09:33.869108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:33.869442 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:09:33.974466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdc93a0>]}
[0m21:09:34.004317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:09:34.005728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:09:34.017806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe85640>]}
[0m21:09:34.018046 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:09:34.018217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fa090>]}
[0m21:09:34.019071 [info ] [MainThread]: 
[0m21:09:34.019259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:09:34.019396 [info ] [MainThread]: 
[0m21:09:34.019619 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:09:34.021401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:09:34.021612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:34.021813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:09:34.022093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:09:34.022318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:34.139403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:36.208170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:09:36.209295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:09:36.209952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:36.210462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:09:36.210943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:36.211453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:36.826092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec9f10>]}
[0m21:09:36.827346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:36.920691 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:09:36.920963 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:09:36.921156 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:09:36.921400 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:09:36.921690 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:09:36.922240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m21:09:36.921968 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:09:36.922492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m21:09:36.922661 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:09:36.922817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:09:36.922992 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:09:36.929992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:09:36.930182 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:09:36.931884 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:09:36.933679 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:09:36.934170 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:09:36.946279 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:09:36.946500 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:09:36.954104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:36.955263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:09:36.956551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:09:37.468454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:09:37.468864 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:09:37.470317 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:09:37.470608 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:09:37.496212 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:09:37.496913 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:09:37.756481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9dd41481-e798-4a89-b443-cac76d969762&page=queryresults
[0m21:09:37.782718 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7584d068-669c-425c-ab26-a723c0fdf031&page=queryresults
[0m21:09:37.785394 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0a754cc3-b911-4885-8a10-921000d368b6&page=queryresults
[0m21:09:39.682060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f847c20>]}
[0m21:09:39.682430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ef200>]}
[0m21:09:39.682982 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.76s]
[0m21:09:39.683872 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:09:39.683403 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.76s]
[0m21:09:39.684442 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:09:39.684787 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m21:09:39.685231 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:09:39.685534 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m21:09:39.685880 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m21:09:39.686205 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:09:39.686483 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:09:39.686722 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m21:09:39.689582 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:09:39.689886 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:09:39.692525 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:09:39.693746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe93860>]}
[0m21:09:39.694199 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.77s]
[0m21:09:39.694610 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:09:39.694847 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m21:09:39.695062 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m21:09:39.696722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:09:39.698195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:09:40.083537 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:09:40.086643 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:09:40.153276 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:09:40.156002 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:09:40.320812 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2ced8fe8-6717-4ffb-a66b-51c3823eb168&page=queryresults
[0m21:09:40.439985 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9215600f-2280-48f0-93e3-646720c9d90f&page=queryresults
[0m21:09:42.159591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102df680>]}
[0m21:09:42.161093 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.47s]
[0m21:09:42.162185 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m21:09:42.324824 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe922d0>]}
[0m21:09:42.326392 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.64s]
[0m21:09:42.327841 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m21:09:42.329247 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:09:42.330214 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:09:42.330861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m21:09:42.331311 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:09:42.340149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:09:42.341586 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:09:42.344707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:42.695665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:09:42.697779 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:09:42.946378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fc845d83-dc9b-41a0-8432-2f2c5e73ca0b&page=queryresults
[0m21:09:44.696685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b9f10>]}
[0m21:09:44.698055 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.37s]
[0m21:09:44.699024 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:09:44.700317 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:09:44.701203 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:09:44.701936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:09:44.702439 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:09:44.708516 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:09:44.710531 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:09:44.713900 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:09:44.714580 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m21:09:44.714988 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:09:45.249245 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8e48364a-29cf-4572-8537-80e77be9953d&page=queryresults
[0m21:09:45.319747 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8e48364a-29cf-4572-8537-80e77be9953d&page=queryresults
[0m21:09:45.336072 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:09:45.336959 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562fa957-bf01-4fa3-9756-8104064558d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103cb800>]}
[0m21:09:45.337848 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.63s]
[0m21:09:45.338563 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:09:45.339197 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:09:45.341417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:09:45.422956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:45.423158 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:09:45.423296 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:09:45.423424 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:09:45.423537 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:09:45.423718 [info ] [MainThread]: 
[0m21:09:45.423880 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m21:09:45.424545 [debug] [MainThread]: Command end result
[0m21:09:45.434930 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:09:45.435906 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:09:45.438806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:09:45.439034 [info ] [MainThread]: 
[0m21:09:45.439238 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:09:45.439386 [info ] [MainThread]: 
[0m21:09:45.439577 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:09:45.439804 [info ] [MainThread]: 
[0m21:09:45.439989 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:09:45.440242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.881113, "process_in_blocks": "0", "process_kernel_time": 0.431253, "process_mem_max_rss": "223674368", "process_out_blocks": "0", "process_user_time": 2.847268}
[0m21:09:45.440529 [debug] [MainThread]: Command `dbt run` failed at 21:09:45.440487 after 12.88 seconds
[0m21:09:45.440719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e745c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106686d20>]}
[0m21:09:45.440899 [debug] [MainThread]: Flushing usage events
[0m21:09:47.360677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:20:48.910015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106780680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106780320>]}


============================== 21:20:48.912890 | 7345852d-434f-4bf1-aa10-9b98a26b83cb ==============================
[0m21:20:48.912890 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:20:48.913211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:20:49.940260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c105c0>]}
[0m21:20:49.963811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f7500>]}
[0m21:20:49.964122 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:20:50.056655 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:20:50.118229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:20:50.118529 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/dimfact/fact_rents.sql
[0m21:20:50.226466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157f70b0>]}
[0m21:20:50.256239 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:20:50.257385 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:20:50.269390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157337a0>]}
[0m21:20:50.269628 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:20:50.269800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157f3b30>]}
[0m21:20:50.270662 [info ] [MainThread]: 
[0m21:20:50.270848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:50.270985 [info ] [MainThread]: 
[0m21:20:50.271237 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:20:50.273037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:20:50.273252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:50.273509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:20:50.273813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:20:50.273981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:50.274164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:51.646461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:20:51.647554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:51.648269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:20:51.649080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:20:51.739976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:51.743134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:52.177308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11553ce30>]}
[0m21:20:52.178634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:52.268367 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:20:52.268712 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:20:52.268916 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:20:52.269172 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:20:52.269436 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:20:52.269676 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:20:52.269916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:20:52.270088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m21:20:52.270245 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m21:20:52.270400 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:20:52.270554 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:20:52.270693 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:20:52.275689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:20:52.277602 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:20:52.279232 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:20:52.280761 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:20:52.280930 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:20:52.281077 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:20:52.303322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:20:52.303669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:52.304872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:52.779084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:20:52.779857 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:20:52.781087 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:20:52.781358 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:20:53.015750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:138bfb1c-80e6-45d9-9285-6c22be8c4d5c&page=queryresults
[0m21:20:53.083406 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:20:53.086940 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:20:53.280315 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4ebeaf04-35e5-4c64-9520-3b765286f0e4&page=queryresults
[0m21:20:54.327954 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0cdeb021-cdea-48ac-a81f-072d5487c189&page=queryresults
[0m21:20:54.985600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11512fd70>]}
[0m21:20:54.986370 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.71s]
[0m21:20:54.986893 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:20:54.987343 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:20:54.987675 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:20:54.988184 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:20:54.988515 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:20:54.991682 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:20:54.992477 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:20:54.994381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:20:55.326445 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:20:55.328066 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:20:55.524625 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dc2ad78b-f16d-43ad-b4f9-3c750ca197c3&page=queryresults
[0m21:20:56.495449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158d2600>]}
[0m21:20:56.496944 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 4.22s]
[0m21:20:56.498067 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:20:56.499294 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:20:56.500023 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:20:56.501004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:20:56.501646 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:20:56.507893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:20:56.508731 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:20:56.511626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:56.864243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:20:56.866420 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:20:57.072947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:34f086c9-1daa-42fc-abc6-57ab10e0b34e&page=queryresults
[0m21:20:57.425318 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157a0bc0>]}
[0m21:20:57.426286 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.44s]
[0m21:20:57.427081 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:20:57.954571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11529b440>]}
[0m21:20:57.956332 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 5.68s]
[0m21:20:57.957536 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:20:58.708280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11529b440>]}
[0m21:20:58.709926 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.21s]
[0m21:20:58.710959 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:20:58.712673 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m21:20:58.713810 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:20:58.714796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m21:20:58.715430 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:20:58.722797 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:20:58.725016 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:20:58.728218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:20:59.082440 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:20:59.085412 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
dim_books.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:20:59.276134 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ed219d49-824e-46ab-80fe-b399206f6a24&page=queryresults
[0m21:21:00.887474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115dafd70>]}
[0m21:21:00.889599 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.3 KiB processed)[0m in 2.17s]
[0m21:21:00.890766 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:21:00.892003 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:21:00.892891 [info ] [Thread-2 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:21:00.894011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dmart_user_book)
[0m21:21:00.894759 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:21:00.901470 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:21:00.902895 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:21:00.907011 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:21:00.908116 [debug] [Thread-2 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m21:21:00.908658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:01.391401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:20e7d780-4e83-4635-84ca-763c70b40a1e&page=queryresults
[0m21:21:01.462343 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:20e7d780-4e83-4635-84ca-763c70b40a1e&page=queryresults
[0m21:21:01.478106 [debug] [Thread-2 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:21:01.478900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7345852d-434f-4bf1-aa10-9b98a26b83cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159048c0>]}
[0m21:21:01.479736 [error] [Thread-2 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.59s]
[0m21:21:01.480392 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:21:01.480904 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:21:01.482835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:01.563169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:01.563386 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:21:01.563535 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:21:01.563653 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:21:01.563770 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:21:01.563942 [info ] [MainThread]: 
[0m21:21:01.564105 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.29 seconds (11.29s).
[0m21:21:01.564796 [debug] [MainThread]: Command end result
[0m21:21:01.575508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:21:01.576655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:21:01.579868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:21:01.580042 [info ] [MainThread]: 
[0m21:21:01.580224 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:21:01.580368 [info ] [MainThread]: 
[0m21:21:01.580539 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:21:01.580677 [info ] [MainThread]: 
[0m21:21:01.580821 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:21:01.581045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.706198, "process_in_blocks": "0", "process_kernel_time": 0.412148, "process_mem_max_rss": "224313344", "process_out_blocks": "0", "process_user_time": 2.858787}
[0m21:21:01.581312 [debug] [MainThread]: Command `dbt run` failed at 21:21:01.581272 after 12.71 seconds
[0m21:21:01.581495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115470140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cce420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fa090>]}
[0m21:21:01.581652 [debug] [MainThread]: Flushing usage events
[0m21:21:03.384815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:13.972211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc82c0>]}


============================== 21:24:13.975080 | 97ec6d73-9d78-4119-abbe-f1bc6deb6cc2 ==============================
[0m21:24:13.975080 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:24:13.975388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:24:14.985021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113396300>]}
[0m21:24:15.008441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b886e0>]}
[0m21:24:15.008747 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:24:15.101891 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:24:15.163689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:24:15.164015 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/dimfact/fact_rents.sql
[0m21:24:15.164219 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:24:15.273853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137354890>]}
[0m21:24:15.303031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:24:15.304509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:24:15.316277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137071d30>]}
[0m21:24:15.316511 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:24:15.316682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d7740>]}
[0m21:24:15.317530 [info ] [MainThread]: 
[0m21:24:15.317713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:15.317847 [info ] [MainThread]: 
[0m21:24:15.318071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:24:15.319836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:24:15.320056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:15.320312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:24:15.320615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:24:15.320835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:15.321009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:16.570918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:24:16.572695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:24:16.573801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:16.575056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:24:16.575672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:16.576507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:17.034999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137347ad0>]}
[0m21:24:17.036311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:17.127910 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:24:17.128173 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:24:17.128388 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:24:17.128625 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:24:17.128893 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:24:17.129145 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:24:17.129392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m21:24:17.129557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m21:24:17.129709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:24:17.129860 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:24:17.130001 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:24:17.130135 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:24:17.134994 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:24:17.136768 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:24:17.138759 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:24:17.140267 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:24:17.140458 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:24:17.140626 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:24:17.174158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:17.175540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:17.176256 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:17.629309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:24:17.630664 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:24:17.631257 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:24:17.632329 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:24:17.690731 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:24:17.691789 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:24:17.898068 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4964298d-8bf7-4402-b052-9ffa36ca735e&page=queryresults
[0m21:24:17.899554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:69cbc63c-af05-430d-b758-fe26231dfa87&page=queryresults
[0m21:24:17.921112 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:63d1dc54-686e-4984-a682-5548649b3505&page=queryresults
[0m21:24:19.588090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c2fa70>]}
[0m21:24:19.588775 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.46s]
[0m21:24:19.589271 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:24:19.589758 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:24:19.590170 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:24:19.590588 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:24:19.590863 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:24:19.594045 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:24:19.594582 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:24:19.596472 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:24:19.669232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d9b2f0>]}
[0m21:24:19.669610 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.54s]
[0m21:24:19.670137 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:24:19.847601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d9a9f0>]}
[0m21:24:19.848566 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.72s]
[0m21:24:19.849302 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:24:19.849987 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:24:19.850512 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:24:19.850977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:24:19.851354 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:24:19.856298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:24:19.857081 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:24:19.861116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:19.939814 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:24:19.940476 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:24:20.187408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:24:20.188688 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:afadbe02-770f-4abf-86ef-8007c2a6d3b5&page=queryresults
[0m21:24:20.191265 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:24:20.427611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:99248663-a9d3-4a91-a1b6-56c70eab9031&page=queryresults
[0m21:24:21.817653 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137907dd0>]}
[0m21:24:21.819210 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.23s]
[0m21:24:21.820268 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:24:22.164956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137886f90>]}
[0m21:24:22.166614 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.31s]
[0m21:24:22.167750 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:24:22.169296 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m21:24:22.170080 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:24:22.170704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m21:24:22.171167 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:24:22.177102 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:24:22.178278 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:24:22.181152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:22.591767 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:24:22.593327 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:24:22.819659 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6431ddec-65b9-4a93-b896-4af396afc1eb&page=queryresults
[0m21:24:24.480461 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379a0c50>]}
[0m21:24:24.482031 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.31s]
[0m21:24:24.483210 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:24:24.484569 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:24:24.485399 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:24:24.486141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:24:24.486735 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:24:24.494836 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:24:24.495958 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:24:24.499921 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:24:24.500804 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email
    );
  
[0m21:24:24.501290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:24.934798 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6a237228-1d25-442e-adef-7ed23d98e52f&page=queryresults
[0m21:24:24.994874 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6a237228-1d25-442e-adef-7ed23d98e52f&page=queryresults
[0m21:24:25.009982 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:24:25.010808 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97ec6d73-9d78-4119-abbe-f1bc6deb6cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13749c7d0>]}
[0m21:24:25.011679 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.52s]
[0m21:24:25.012413 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:24:25.013122 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:24:25.015306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:24:25.097433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:25.097652 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:24:25.097804 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:24:25.097919 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:24:25.098030 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:24:25.098194 [info ] [MainThread]: 
[0m21:24:25.098358 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m21:24:25.099018 [debug] [MainThread]: Command end result
[0m21:24:25.109654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:24:25.110743 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:24:25.113856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:24:25.114010 [info ] [MainThread]: 
[0m21:24:25.114184 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:24:25.114320 [info ] [MainThread]: 
[0m21:24:25.114488 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:24:25.114624 [info ] [MainThread]: 
[0m21:24:25.114766 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:24:25.115003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.178729, "process_in_blocks": "0", "process_kernel_time": 0.388558, "process_mem_max_rss": "231391232", "process_out_blocks": "0", "process_user_time": 2.811714}
[0m21:24:25.115263 [debug] [MainThread]: Command `dbt run` failed at 21:24:25.115224 after 11.18 seconds
[0m21:24:25.115446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a06b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ce0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1371476b0>]}
[0m21:24:25.115613 [debug] [MainThread]: Flushing usage events
[0m21:24:26.792321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:40.866178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108968b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c4710>]}


============================== 21:26:40.869333 | c8b6ead0-e806-4271-9fba-b45953ab04a1 ==============================
[0m21:26:40.869333 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:26:40.869697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:26:41.913340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082584a0>]}
[0m21:26:41.937145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae578f0>]}
[0m21:26:41.937547 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:26:42.027508 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:26:42.090650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:42.090969 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:26:42.198143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fac6a50>]}
[0m21:26:42.228869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:26:42.230598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:26:42.243138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa7c440>]}
[0m21:26:42.243375 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:26:42.243550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f90a0c0>]}
[0m21:26:42.244416 [info ] [MainThread]: 
[0m21:26:42.244602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:42.244737 [info ] [MainThread]: 
[0m21:26:42.244966 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:26:42.246771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:26:42.247020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:26:42.247178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:42.247414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:26:42.247550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:42.247784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:43.741106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:26:43.742207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:26:43.743016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:26:43.743468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:43.743932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:43.744302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:44.365857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e75d250>]}
[0m21:26:44.367285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:44.459751 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:26:44.460035 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:26:44.460235 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:26:44.460492 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:26:44.460771 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:26:44.461048 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:26:44.461284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:26:44.461450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:26:44.461625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:26:44.461802 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:26:44.461944 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:26:44.462080 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:26:44.469874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:26:44.471873 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:26:44.473662 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:26:44.475279 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:26:44.475513 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:26:44.481811 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:26:44.508069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:44.509581 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:44.510934 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:45.042808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:26:45.043563 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:26:45.044694 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:26:45.045398 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:26:45.045693 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:26:45.045941 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:26:45.281242 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ff255b9e-afbe-42c5-b105-07c76e6c3874&page=queryresults
[0m21:26:45.285628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d50bef30-774a-497d-8fbe-ce078b2eff23&page=queryresults
[0m21:26:45.392776 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:19ff01b9-7e68-428d-85ea-11f8b2774277&page=queryresults
[0m21:26:46.952834 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcd60c0>]}
[0m21:26:46.953183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b02fe60>]}
[0m21:26:46.953726 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.49s]
[0m21:26:46.954336 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.49s]
[0m21:26:46.954828 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:26:46.955221 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:26:46.955774 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:26:46.956035 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m21:26:46.956328 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:26:46.956636 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:26:46.956971 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:26:46.957229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m21:26:46.957454 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:26:46.957663 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:26:46.960542 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:26:46.963118 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:26:46.963640 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:26:46.963874 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m21:26:46.965486 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:46.966995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:47.099836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d29aa80>]}
[0m21:26:47.100187 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.64s]
[0m21:26:47.100487 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:26:47.396100 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:26:47.398166 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:26:47.516757 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:26:47.518726 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:26:47.605995 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a8334497-1261-4445-a15f-c002f957ce93&page=queryresults
[0m21:26:47.724437 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c9a74fb1-6195-42e7-922b-5b17f85bed98&page=queryresults
[0m21:26:49.224390 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d29d0a0>]}
[0m21:26:49.225947 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.27s]
[0m21:26:49.226913 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:26:49.391875 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d29aa80>]}
[0m21:26:49.393003 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.43s]
[0m21:26:49.393834 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m21:26:49.394712 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:26:49.395282 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:26:49.395752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m21:26:49.396079 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:26:49.400707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:26:49.402254 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:26:49.404881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:49.847177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:26:49.847860 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:26:50.071313 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1452fb6d-1b6b-4584-9dea-3c41bc32ee51&page=queryresults
[0m21:26:52.288017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d221670>]}
[0m21:26:52.289035 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.89s]
[0m21:26:52.289938 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:26:52.291022 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:26:52.291701 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:26:52.292351 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:26:52.292878 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:26:52.299014 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:26:52.299517 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:26:52.301193 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:26:52.301658 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.rent_date, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m21:26:52.301926 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:52.814693 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:aed6e900-87a6-4eef-9272-c67fb7cc8b18&page=queryresults
[0m21:26:52.894640 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:aed6e900-87a6-4eef-9272-c67fb7cc8b18&page=queryresults
[0m21:26:52.911802 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:26:52.913109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8b6ead0-e806-4271-9fba-b45953ab04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc90080>]}
[0m21:26:52.914246 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.62s]
[0m21:26:52.915163 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:26:52.915731 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:26:52.920913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:52.998828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:52.999037 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:26:52.999168 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:26:52.999282 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:26:52.999394 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:26:52.999584 [info ] [MainThread]: 
[0m21:26:52.999770 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.75 seconds (10.75s).
[0m21:26:53.000447 [debug] [MainThread]: Command end result
[0m21:26:53.011266 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:26:53.012899 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:26:53.016183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:26:53.016346 [info ] [MainThread]: 
[0m21:26:53.016530 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:53.016671 [info ] [MainThread]: 
[0m21:26:53.016842 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:26:53.016978 [info ] [MainThread]: 
[0m21:26:53.017149 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:26:53.017495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.186826, "process_in_blocks": "0", "process_kernel_time": 0.422238, "process_mem_max_rss": "220561408", "process_out_blocks": "0", "process_user_time": 2.834139}
[0m21:26:53.017811 [debug] [MainThread]: Command `dbt run` failed at 21:26:53.017773 after 12.19 seconds
[0m21:26:53.018016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e719a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdc440>]}
[0m21:26:53.018172 [debug] [MainThread]: Flushing usage events
[0m21:26:54.715824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:51.932670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c84d0>]}


============================== 21:27:51.935793 | f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74 ==============================
[0m21:27:51.935793 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:27:51.936146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:52.936298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad9af0>]}
[0m21:27:52.959633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b62840>]}
[0m21:27:52.959947 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:27:53.053513 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:27:53.120472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:53.120886 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:27:53.231174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eac67e0>]}
[0m21:27:53.260858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:27:53.262190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:27:53.273914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea65370>]}
[0m21:27:53.274153 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:27:53.274328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e8b2060>]}
[0m21:27:53.275187 [info ] [MainThread]: 
[0m21:27:53.275372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:53.275509 [info ] [MainThread]: 
[0m21:27:53.275734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:27:53.277548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:27:53.277803 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:27:53.277972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:53.278208 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:27:53.278346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:53.278561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:54.786039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:27:54.787250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:27:54.788326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:27:54.788864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:54.789523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:54.790017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:55.385171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eaa8740>]}
[0m21:27:55.385987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:55.468499 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:27:55.468726 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:27:55.468902 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:27:55.469128 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:27:55.469389 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:27:55.469672 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:27:55.469926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m21:27:55.470123 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:27:55.470279 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m21:27:55.470436 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:27:55.470585 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:27:55.470724 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:27:55.477722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:27:55.479430 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:27:55.481064 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:27:55.481706 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:27:55.481891 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:27:55.482065 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:27:55.504823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:55.505162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:55.506332 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:27:56.022329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:27:56.025174 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:27:56.025966 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:27:56.026683 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:27:56.027021 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:27:56.028257 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:27:56.219405 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a3eee04d-4e8c-4b8c-ad57-2f73348937c7&page=queryresults
[0m21:27:56.223012 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:35f424c7-a9c0-49cc-87a6-668844916c2c&page=queryresults
[0m21:27:56.252142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8a77eae0-b0e5-4743-b548-17a1adf87961&page=queryresults
[0m21:27:57.894374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128af9700>]}
[0m21:27:57.894732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb8af90>]}
[0m21:27:57.895312 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.42s]
[0m21:27:57.896191 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:27:57.895812 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.42s]
[0m21:27:57.897568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a8da60>]}
[0m21:27:57.897978 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:27:57.898332 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:27:57.898759 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.43s]
[0m21:27:57.899207 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:27:57.899642 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:27:57.899987 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:27:57.900323 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:27:57.903265 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:27:57.903758 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:27:57.904090 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:27:57.904418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:27:57.904789 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:27:57.905077 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:27:57.906808 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:27:57.909131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:27:57.979174 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:27:57.980522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:58.352030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:27:58.354516 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:27:58.409712 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:27:58.412184 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:27:58.555214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0369d1bc-f0ea-40cf-846d-d8239dbb6ca2&page=queryresults
[0m21:27:58.625758 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3be27b43-4b9b-426b-af40-dd3db1b03941&page=queryresults
[0m21:28:00.216660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ebeba70>]}
[0m21:28:00.218399 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.31s]
[0m21:28:00.219527 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:28:00.286382 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea7f8c0>]}
[0m21:28:00.288311 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.39s]
[0m21:28:00.289436 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:28:00.290823 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m21:28:00.291689 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:28:00.292511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m21:28:00.293354 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:28:00.304066 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:28:00.306418 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:28:00.309599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:00.685310 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:28:00.687775 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:28:00.931150 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bca97df3-ab79-4ab4-8013-493802503241&page=queryresults
[0m21:28:02.948080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea7f830>]}
[0m21:28:02.949747 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.66s]
[0m21:28:02.950737 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:28:02.951992 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:28:02.952915 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:28:02.955584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m21:28:02.956532 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:28:02.963055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:28:02.964291 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:28:02.968134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:28:02.969040 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m21:28:02.969543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:03.471502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c28e6990-8d6e-478b-b2ad-57cf029ff541&page=queryresults
[0m21:28:03.535031 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c28e6990-8d6e-478b-b2ad-57cf029ff541&page=queryresults
[0m21:28:03.550536 [debug] [Thread-1 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:28:03.551381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6cf4f74-d4f3-428d-a38a-7a87bf4b0e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b1d9d0>]}
[0m21:28:03.552243 [error] [Thread-1 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.60s]
[0m21:28:03.552955 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:28:03.553828 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:28:03.556433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:03.637898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:03.638092 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:28:03.638221 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:28:03.638334 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:28:03.638443 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:28:03.638617 [info ] [MainThread]: 
[0m21:28:03.638793 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m21:28:03.639441 [debug] [MainThread]: Command end result
[0m21:28:03.649918 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:28:03.651004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:28:03.653968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:28:03.654141 [info ] [MainThread]: 
[0m21:28:03.654318 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:28:03.654464 [info ] [MainThread]: 
[0m21:28:03.654642 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:28:03.654947 [info ] [MainThread]: 
[0m21:28:03.655144 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:28:03.655404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.757259, "process_in_blocks": "0", "process_kernel_time": 0.397691, "process_mem_max_rss": "227868672", "process_out_blocks": "0", "process_user_time": 2.835469}
[0m21:28:03.655681 [debug] [MainThread]: Command `dbt run` failed at 21:28:03.655639 after 11.76 seconds
[0m21:28:03.655871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102903080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128817c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2e38c0>]}
[0m21:28:03.656050 [debug] [MainThread]: Flushing usage events
[0m21:28:05.325043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:37.228131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcc170>]}


============================== 21:28:37.231244 | 1c8b0b21-5c82-4046-8dd6-b514bde37cfc ==============================
[0m21:28:37.231244 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:28:37.231617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:38.233236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b619d0>]}
[0m21:28:38.256778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116727b00>]}
[0m21:28:38.257094 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:28:38.349411 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:28:38.414910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:28:38.415220 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:28:38.519862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c14cb0>]}
[0m21:28:38.549020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:28:38.550226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:28:38.562149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117271730>]}
[0m21:28:38.562388 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:28:38.562560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172b04d0>]}
[0m21:28:38.563415 [info ] [MainThread]: 
[0m21:28:38.563598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:38.563737 [info ] [MainThread]: 
[0m21:28:38.563965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:28:38.565774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:28:38.565995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:38.566202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:28:38.566471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:28:38.566630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:38.566794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:40.016031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:28:40.017170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:28:40.017773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:28:40.018324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:40.019155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:40.019959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:40.544405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171b5d00>]}
[0m21:28:40.545694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:40.637694 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:28:40.638026 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:28:40.638247 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:28:40.638545 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:28:40.638809 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:28:40.639083 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:28:40.639359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:28:40.639535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m21:28:40.639689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m21:28:40.639842 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:28:40.639984 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:28:40.640121 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:28:40.647059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:28:40.648843 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:28:40.650445 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:28:40.651162 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:28:40.651354 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:28:40.651514 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:28:40.674357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:40.675216 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:40.676431 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:41.176549 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:28:41.178329 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:28:41.179433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:28:41.180045 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:28:41.180375 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:28:41.180631 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:28:41.373558 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5c0d31b3-004b-4e86-adc9-aee3b92fcea0&page=queryresults
[0m21:28:41.376995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:aaaf6279-67aa-4e1e-aad8-39fcaea7da85&page=queryresults
[0m21:28:41.378976 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1fc816e6-caa0-4a0b-8d5e-8bbd7e53ddc6&page=queryresults
[0m21:28:43.043745 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11692fc50>]}
[0m21:28:43.044091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11758fc80>]}
[0m21:28:43.044361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11760c6e0>]}
[0m21:28:43.044845 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.40s]
[0m21:28:43.045408 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.40s]
[0m21:28:43.045912 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.40s]
[0m21:28:43.046378 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:28:43.046726 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:28:43.047049 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:28:43.047535 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:28:43.047777 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m21:28:43.048062 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:28:43.048412 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:28:43.048768 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:28:43.049008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m21:28:43.049250 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:28:43.049465 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:28:43.052539 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:28:43.054992 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:28:43.055485 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:28:43.055715 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m21:28:43.057319 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:28:43.058828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:43.463365 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:28:43.464980 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:28:43.493594 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:28:43.495150 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:28:43.691757 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:968e458e-d1d4-4c10-98d5-79a5b1549994&page=queryresults
[0m21:28:43.693247 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a6d045b9-5c0e-46f9-b779-231fcdc8f547&page=queryresults
[0m21:28:45.306240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11714ee10>]}
[0m21:28:45.307883 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.26s]
[0m21:28:45.309122 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m21:28:45.319867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117910e30>]}
[0m21:28:45.321022 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.27s]
[0m21:28:45.321849 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:28:45.322905 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m21:28:45.323773 [info ] [Thread-2 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:28:45.324484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.fact_rents)
[0m21:28:45.324996 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:28:45.330599 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:28:45.331605 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:28:45.334245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:45.769479 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:28:45.771932 [debug] [Thread-2 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:28:45.991965 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e9757f08-5b49-4108-83a5-327bda8e4b40&page=queryresults
[0m21:28:47.866719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179a7ad0>]}
[0m21:28:47.868456 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.54s]
[0m21:28:47.869864 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:28:47.871231 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:28:47.872157 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:28:47.872930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m21:28:47.873431 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:28:47.880268 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:28:47.881445 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:28:47.885927 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:28:47.886850 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email
    );
  
[0m21:28:47.887361 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:48.410594 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:75572610-1cfa-41c4-b5b9-5870d78c3e1e&page=queryresults
[0m21:28:48.471004 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:75572610-1cfa-41c4-b5b9-5870d78c3e1e&page=queryresults
[0m21:28:48.481851 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:28:48.482503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8b0b21-5c82-4046-8dd6-b514bde37cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179a8230>]}
[0m21:28:48.483081 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.61s]
[0m21:28:48.483629 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:28:48.484055 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:28:48.485976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:48.562116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:48.562335 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:28:48.562473 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:28:48.562590 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:28:48.562703 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:28:48.562876 [info ] [MainThread]: 
[0m21:28:48.563044 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m21:28:48.563692 [debug] [MainThread]: Command end result
[0m21:28:48.574173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:28:48.575147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:28:48.577988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:28:48.578151 [info ] [MainThread]: 
[0m21:28:48.578347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:28:48.578502 [info ] [MainThread]: 
[0m21:28:48.578699 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:28:48.578841 [info ] [MainThread]: 
[0m21:28:48.578986 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:28:48.579217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.38614, "process_in_blocks": "0", "process_kernel_time": 0.391376, "process_mem_max_rss": "230260736", "process_out_blocks": "0", "process_user_time": 2.795617}
[0m21:28:48.579467 [debug] [MainThread]: Command `dbt run` failed at 21:28:48.579432 after 11.39 seconds
[0m21:28:48.579632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116552480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45fa0>]}
[0m21:28:48.579785 [debug] [MainThread]: Flushing usage events
[0m21:28:50.570404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:08.678522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c04290>]}


============================== 21:29:08.681618 | d1914c73-7de1-4369-8984-e4c2c3f17389 ==============================
[0m21:29:08.681618 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:29:08.681975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m21:29:09.647876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f21e50>]}
[0m21:29:09.671528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3140>]}
[0m21:29:09.671858 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:29:09.768463 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:29:09.828457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:09.828778 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:29:09.934555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bd19a0>]}
[0m21:29:09.964650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:29:09.965732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:29:09.976621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b71970>]}
[0m21:29:09.976858 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:29:09.977033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155a93d0>]}
[0m21:29:09.977912 [info ] [MainThread]: 
[0m21:29:09.978104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:09.978243 [info ] [MainThread]: 
[0m21:29:09.978469 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:29:09.980265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:29:09.980522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:29:09.980687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:09.980895 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:29:09.981062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:09.981250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:11.183123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:29:11.184828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:29:11.185705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:29:11.186214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:11.186805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:11.187313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:11.687014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151e7350>]}
[0m21:29:11.688221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:11.774817 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:29:11.775084 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:29:11.775273 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:29:11.775512 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:29:11.775780 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:29:11.776043 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:29:11.776292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:29:11.776458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m21:29:11.776610 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m21:29:11.776780 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:29:11.776925 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:29:11.777061 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:29:11.784258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:29:11.786130 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:29:11.787982 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:29:11.788456 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:29:11.788644 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:29:11.788826 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:29:11.809238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:11.810209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:11.811343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:12.321941 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:29:12.323030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:29:12.323946 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:29:12.324323 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:29:12.610641 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:be85f920-fb80-44aa-abe7-b3aec8665a0d&page=queryresults
[0m21:29:12.615173 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:459f4262-4429-48e2-89f6-4c5960891425&page=queryresults
[0m21:29:12.645759 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:29:12.648063 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:29:12.975004 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:78f62dd8-791c-47c5-9ae2-ed2eb703b5de&page=queryresults
[0m21:29:14.364825 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c90f20>]}
[0m21:29:14.365189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c6a990>]}
[0m21:29:14.365893 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.59s]
[0m21:29:14.366519 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.59s]
[0m21:29:14.367239 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:29:14.367732 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:29:14.368299 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:29:14.368618 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m21:29:14.368992 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:29:14.369470 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:29:14.369904 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:29:14.370195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m21:29:14.370454 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:29:14.370682 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:29:14.373592 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:29:14.376153 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:29:14.376735 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m21:29:14.376989 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:29:14.378697 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:14.380219 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:29:14.682879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160e5eb0>]}
[0m21:29:14.683903 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.91s]
[0m21:29:14.684611 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:29:14.811716 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:29:14.814299 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:29:14.831560 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:29:14.833933 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:29:15.038646 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:eee74b5b-f389-4951-a259-ef635b2f3c77&page=queryresults
[0m21:29:15.058914 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:83277d76-d547-4d64-9ade-43ead22be805&page=queryresults
[0m21:29:16.687209 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116105dc0>]}
[0m21:29:16.691002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b7d2b0>]}
[0m21:29:16.695729 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.32s]
[0m21:29:16.734172 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.32s]
[0m21:29:16.734799 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:29:16.735076 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m21:29:16.735875 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:29:16.736142 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:29:16.736393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m21:29:16.736679 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:29:16.739960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:29:16.743907 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:29:16.746190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:17.130127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:29:17.132167 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:29:17.324393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3d66b9c1-ca68-4b80-aeed-0787e96594e8&page=queryresults
[0m21:29:18.949061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160ce9c0>]}
[0m21:29:18.950945 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.21s]
[0m21:29:18.952128 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:29:18.953474 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:29:18.954445 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:29:18.955467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:29:18.956072 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:29:18.963323 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:29:18.964513 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:29:18.968475 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:29:18.969406 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email
    );
  
[0m21:29:18.969983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:19.480030 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5c52dddb-41fa-4ae3-bc09-6390dfa8e4a3&page=queryresults
[0m21:29:19.562256 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5c52dddb-41fa-4ae3-bc09-6390dfa8e4a3&page=queryresults
[0m21:29:19.577861 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:29:19.578703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1914c73-7de1-4369-8984-e4c2c3f17389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115873590>]}
[0m21:29:19.579603 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.62s]
[0m21:29:19.580329 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:29:19.581048 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:29:19.583509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:19.664289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:19.664509 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:29:19.664645 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:29:19.664762 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:29:19.664874 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:29:19.665047 [info ] [MainThread]: 
[0m21:29:19.665209 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m21:29:19.665870 [debug] [MainThread]: Command end result
[0m21:29:19.678032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:29:19.679055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:29:19.681813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:29:19.681979 [info ] [MainThread]: 
[0m21:29:19.682159 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:29:19.682364 [info ] [MainThread]: 
[0m21:29:19.682561 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:29:19.682712 [info ] [MainThread]: 
[0m21:29:19.682881 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:29:19.683183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.040661, "process_in_blocks": "0", "process_kernel_time": 0.39684, "process_mem_max_rss": "226459648", "process_out_blocks": "0", "process_user_time": 2.783622}
[0m21:29:19.683470 [debug] [MainThread]: Command `dbt run` failed at 21:29:19.683430 after 11.04 seconds
[0m21:29:19.683665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155843b0>]}
[0m21:29:19.683836 [debug] [MainThread]: Flushing usage events
[0m21:29:21.221885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:36.204224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c64800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c644a0>]}


============================== 21:33:36.207277 | 80eec8de-af96-4ffb-ab7f-025052712420 ==============================
[0m21:33:36.207277 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:33:36.207598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:37.370063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f5070>]}
[0m21:33:37.395216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13134e330>]}
[0m21:33:37.395571 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:33:37.494254 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:33:37.561651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:37.561977 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:33:37.674538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1319b2210>]}
[0m21:33:37.705497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:33:37.707396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:33:37.719627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a65640>]}
[0m21:33:37.719857 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:33:37.720030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131aa9d00>]}
[0m21:33:37.721007 [info ] [MainThread]: 
[0m21:33:37.721201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:37.721341 [info ] [MainThread]: 
[0m21:33:37.721574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:33:37.723431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:33:37.723647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:37.723861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:33:37.724128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:33:37.724347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:37.724499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:38.899402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:33:38.900915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:33:38.901639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:38.902291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:33:38.902943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:38.903727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:39.412346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131ac6e70>]}
[0m21:33:39.413474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:39.501157 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:33:39.501457 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:33:39.501650 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:33:39.501908 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:33:39.502189 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:33:39.502471 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:33:39.502777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m21:33:39.503033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:33:39.503211 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m21:33:39.503376 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:33:39.503520 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:33:39.503660 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:33:39.510597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:33:39.512310 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:33:39.513933 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:33:39.514695 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:33:39.514889 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:33:39.515073 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:33:39.541617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:39.542834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:39.544073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:40.058340 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:33:40.059338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:33:40.059978 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:33:40.060307 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:33:40.061845 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:33:40.062785 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:33:40.262311 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8c23ac78-0cc3-4ae1-b477-5b207ad16cfb&page=queryresults
[0m21:33:40.263874 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:cb94e9bd-7dd7-4bab-8427-2c640d6f29b3&page=queryresults
[0m21:33:40.317401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2c765d29-fe90-4d00-b515-2591c981eed4&page=queryresults
[0m21:33:41.955143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b6ac90>]}
[0m21:33:41.955514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13132fc80>]}
[0m21:33:41.955799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c17dd0>]}
[0m21:33:41.956315 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.45s]
[0m21:33:41.956894 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.45s]
[0m21:33:41.957814 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:33:41.957429 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.45s]
[0m21:33:41.958272 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:33:41.958757 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:33:41.959137 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:33:41.959464 [info ] [Thread-1 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:33:41.959767 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_books
[0m21:33:41.960007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:33:41.960291 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:33:41.960554 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:33:41.960806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_books)
[0m21:33:41.963787 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:33:41.964072 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:33:41.966673 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:33:41.967146 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_books
[0m21:33:41.967383 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:33:41.969020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:41.971738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:42.357613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:33:42.359661 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:33:42.361506 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:33:42.362287 [debug] [Thread-2 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:33:42.575990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a304f082-d953-4ae2-9648-31a814a94f09&page=queryresults
[0m21:33:42.578856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:511099af-42d8-4f85-9d52-c5b947800f17&page=queryresults
[0m21:33:44.194724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131ba7bc0>]}
[0m21:33:44.196600 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.23s]
[0m21:33:44.198881 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_books
[0m21:33:44.205891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c045c0>]}
[0m21:33:44.207078 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.25s]
[0m21:33:44.207863 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:33:44.208931 [debug] [Thread-4 (]: Began running node model.dbt_dpd.fact_rents
[0m21:33:44.209710 [info ] [Thread-4 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:33:44.210503 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.fact_rents'
[0m21:33:44.210985 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:33:44.216759 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:33:44.217836 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:33:44.220681 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:45.033947 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:33:45.039408 [debug] [Thread-4 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:33:45.263389 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0330d50d-66a9-4af8-ad53-1b90d56c2ab8&page=queryresults
[0m21:33:46.921977 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131f0fd70>]}
[0m21:33:46.923998 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.71s]
[0m21:33:46.925371 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:33:46.927522 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:33:46.928464 [info ] [Thread-2 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:33:46.929223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:33:46.929765 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:33:46.942024 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:33:46.944700 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:33:46.949421 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:33:46.950290 [debug] [Thread-2 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
    );
  
[0m21:33:46.950724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:47.425934 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b083c164-73ce-48e7-98ae-153faffd2ef4&page=queryresults
[0m21:33:47.496062 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b083c164-73ce-48e7-98ae-153faffd2ef4&page=queryresults
[0m21:33:47.515598 [debug] [Thread-2 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:33:47.516547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80eec8de-af96-4ffb-ab7f-025052712420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131f218e0>]}
[0m21:33:47.517399 [error] [Thread-2 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.59s]
[0m21:33:47.518013 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:33:47.518611 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:33:47.521710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:47.600028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:47.600245 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:33:47.600384 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:33:47.600506 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:33:47.600631 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:33:47.600817 [info ] [MainThread]: 
[0m21:33:47.600988 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m21:33:47.601662 [debug] [MainThread]: Command end result
[0m21:33:47.614231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:33:47.615805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:33:47.619579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:33:47.619761 [info ] [MainThread]: 
[0m21:33:47.619975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:33:47.620144 [info ] [MainThread]: 
[0m21:33:47.620324 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:33:47.620468 [info ] [MainThread]: 
[0m21:33:47.620841 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:33:47.621667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.457693, "process_in_blocks": "0", "process_kernel_time": 0.438716, "process_mem_max_rss": "227688448", "process_out_blocks": "0", "process_user_time": 2.849031}
[0m21:33:47.622177 [debug] [MainThread]: Command `dbt run` failed at 21:33:47.622125 after 11.46 seconds
[0m21:33:47.622513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131770710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131967a70>]}
[0m21:33:47.622686 [debug] [MainThread]: Flushing usage events
[0m21:33:49.555101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:01.586039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102766db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c87e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb42f0>]}


============================== 21:45:01.589033 | fd0c1742-0f39-4b7d-9fe7-0139e24d8f11 ==============================
[0m21:45:01.589033 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:45:01.589407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:02.617804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146180>]}
[0m21:45:02.642101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a29100>]}
[0m21:45:02.642447 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:45:02.738438 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:45:02.801866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:45:02.802216 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m21:45:02.802403 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:45:02.914051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c747d0>]}
[0m21:45:02.943950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:45:02.945282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:45:02.958015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c30d70>]}
[0m21:45:02.958259 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:45:02.958432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c744d0>]}
[0m21:45:02.959302 [info ] [MainThread]: 
[0m21:45:02.959489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:45:02.959627 [info ] [MainThread]: 
[0m21:45:02.959860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:45:02.961628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:45:02.961857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:02.962106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:45:02.962366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:02.962603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:45:02.962816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:04.445287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:45:04.446141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:45:04.446719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:45:04.447099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:04.447523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:04.447862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:04.958840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c08fb0>]}
[0m21:45:04.959939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:05.046272 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:45:05.046552 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:45:05.046741 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:45:05.046995 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:45:05.047275 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:45:05.047496 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:45:05.047709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m21:45:05.047873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:45:05.048025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m21:45:05.048180 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:45:05.048322 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:45:05.048459 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:45:05.053568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:45:05.055740 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:45:05.057427 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:45:05.058866 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:45:05.059054 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:45:05.059214 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:45:05.093223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:05.094962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:45:05.095189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:45:05.597767 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:45:05.599682 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:45:05.600775 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT created_at, *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:45:05.601143 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:45:05.611216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:45:05.611786 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:45:05.919898 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b1e2b751-1c9d-4ef4-aff8-e02459036659&page=queryresults
[0m21:45:05.942029 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9468790e-2edd-4865-ac28-d87098cb4f83&page=queryresults
[0m21:45:06.003665 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b45966c8-707d-44fa-93fa-210e1dfd6dcc&page=queryresults
[0m21:45:06.151134 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b45966c8-707d-44fa-93fa-210e1dfd6dcc&page=queryresults
[0m21:45:06.163914 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:45:06.165737 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7902c0>]}
[0m21:45:06.166663 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 1.12s]
[0m21:45:06.167488 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:45:06.168138 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:45:07.655133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c9d220>]}
[0m21:45:07.655597 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ee180>]}
[0m21:45:07.656049 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.61s]
[0m21:45:07.656565 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.61s]
[0m21:45:07.656963 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:45:07.657313 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:45:07.657702 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:45:07.658073 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:45:07.658406 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:45:07.658648 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:45:07.658876 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:45:07.659176 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:45:07.661921 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:45:07.662257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:45:07.662598 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:45:07.664936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:45:07.665286 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:45:07.668000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:45:07.668307 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:45:07.669948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:45:08.210077 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:45:08.212986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:45:08.214997 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:45:08.215640 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:45:08.443542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0d82d54b-1fad-42fc-9088-f5f585635952&page=queryresults
[0m21:45:08.483589 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ffafde9c-88b9-4b96-b5bc-f6cc0af5e9fb&page=queryresults
[0m21:45:10.094496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c57b60>]}
[0m21:45:10.095783 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.43s]
[0m21:45:10.096659 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:45:10.130499 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd0c1742-0f39-4b7d-9fe7-0139e24d8f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114304560>]}
[0m21:45:10.131593 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.47s]
[0m21:45:10.132344 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:45:10.133219 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m21:45:10.133852 [info ] [Thread-2 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:45:10.134423 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:45:10.135074 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:45:10.135453 [info ] [Thread-1 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:45:10.136136 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:45:10.137939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:10.219160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:10.219486 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:45:10.219679 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:45:10.219842 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:45:10.219957 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:45:10.220160 [info ] [MainThread]: 
[0m21:45:10.220322 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m21:45:10.220940 [debug] [MainThread]: Command end result
[0m21:45:10.231071 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:45:10.232143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:45:10.235318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:45:10.235497 [info ] [MainThread]: 
[0m21:45:10.235755 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:45:10.235977 [info ] [MainThread]: 
[0m21:45:10.236433 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:45:10.236595 [info ] [MainThread]: 
[0m21:45:10.236754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:45:10.237081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.684473, "process_in_blocks": "0", "process_kernel_time": 0.351056, "process_mem_max_rss": "224395264", "process_out_blocks": "0", "process_user_time": 2.522231}
[0m21:45:10.237376 [debug] [MainThread]: Command `dbt run` failed at 21:45:10.237334 after 8.68 seconds
[0m21:45:10.237582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f34ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd9190>]}
[0m21:45:10.237761 [debug] [MainThread]: Flushing usage events
[0m21:45:11.766462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:59.360757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc4470>]}


============================== 21:45:59.363601 | 0023072e-a3d8-4d79-abd2-5b02aa6a84be ==============================
[0m21:45:59.363601 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:45:59.363923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:46:00.391612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114962d0>]}
[0m21:46:00.414826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123327a70>]}
[0m21:46:00.415153 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:46:00.511983 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:46:00.576080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:00.576539 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:46:00.688579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12574ab70>]}
[0m21:46:00.718584 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:46:00.719858 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:46:00.731971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12572d070>]}
[0m21:46:00.732205 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:46:00.732382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125163e90>]}
[0m21:46:00.733243 [info ] [MainThread]: 
[0m21:46:00.733436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:46:00.733572 [info ] [MainThread]: 
[0m21:46:00.733797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:00.735570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:46:00.735883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:46:00.736050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:00.736285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:46:00.736428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:00.736649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:01.786154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:46:01.787293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:46:01.788022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:46:01.788538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:01.789123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:01.789682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:02.252284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125538cb0>]}
[0m21:46:02.253886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:02.346575 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:46:02.346838 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:46:02.347004 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:46:02.347234 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:46:02.347529 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:46:02.347803 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:46:02.348038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m21:46:02.348208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:46:02.348362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m21:46:02.348515 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:46:02.348657 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:46:02.348791 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:46:02.353831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:46:02.355625 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:46:02.357262 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:46:02.358232 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:46:02.358437 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:46:02.358599 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:46:02.385890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:02.386181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:02.387415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:02.848559 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:46:02.850091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:46:02.850772 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:46:02.852148 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m21:46:02.852456 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:46:02.852749 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m21:46:03.064232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8e8903fe-b8fe-41b1-a4de-d637983179e0&page=queryresults
[0m21:46:03.067999 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:24c1a45a-4fa3-4b04-973e-2fe61d40d589&page=queryresults
[0m21:46:03.069696 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:993c8477-002c-45af-b5ff-0b778d737759&page=queryresults
[0m21:46:04.736156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12352fb00>]}
[0m21:46:04.736510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125538950>]}
[0m21:46:04.736783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125893260>]}
[0m21:46:04.737294 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.38s]
[0m21:46:04.737722 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.39s]
[0m21:46:04.738674 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:46:04.738189 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.39s]
[0m21:46:04.739158 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:46:04.739686 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:46:04.740108 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m21:46:04.740707 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m21:46:04.740482 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:46:04.741120 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:46:04.741495 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m21:46:04.741755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m21:46:04.742003 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:46:04.742221 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:46:04.745758 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:46:04.748349 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:46:04.748906 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m21:46:04.750581 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:46:04.820474 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m21:46:04.821976 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:05.132087 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:46:05.134647 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m21:46:05.165958 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:46:05.168193 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m21:46:05.333037 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f653ed71-455a-4ec5-8730-729f19aefa51&page=queryresults
[0m21:46:05.372620 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:15e71a3a-b655-40ca-bd4d-79859ce240ca&page=queryresults
[0m21:46:06.924123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258e0890>]}
[0m21:46:06.925768 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.18s]
[0m21:46:06.926753 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m21:46:06.962251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333a21b0>]}
[0m21:46:06.963361 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.22s]
[0m21:46:06.964173 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m21:46:06.965441 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m21:46:06.966372 [info ] [Thread-2 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m21:46:06.967094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.fact_rents)
[0m21:46:06.967541 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.fact_rents
[0m21:46:06.973533 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m21:46:06.975267 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.fact_rents
[0m21:46:06.977791 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:46:07.330785 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m21:46:07.332706 [debug] [Thread-2 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m21:46:07.558650 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:10afe391-73cf-4970-9881-c7f3a35161fa&page=queryresults
[0m21:46:09.154132 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333bfec0>]}
[0m21:46:09.155676 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.19s]
[0m21:46:09.156688 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:46:09.158097 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:46:09.159019 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m21:46:09.159761 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m21:46:09.160285 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m21:46:09.168309 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m21:46:09.169605 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m21:46:09.173508 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m21:46:09.174326 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m21:46:09.174812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:46:09.652839 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8bb6c2c6-9e13-4f2f-a898-70cfb8b12a37&page=queryresults
[0m21:46:09.723844 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8bb6c2c6-9e13-4f2f-a898-70cfb8b12a37&page=queryresults
[0m21:46:09.741049 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:46:09.741921 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0023072e-a3d8-4d79-abd2-5b02aa6a84be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ed3a70>]}
[0m21:46:09.742770 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.58s]
[0m21:46:09.743388 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:46:09.743969 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m21:46:09.746105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:09.826214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:09.826402 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:46:09.826528 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m21:46:09.826640 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m21:46:09.826753 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:46:09.826925 [info ] [MainThread]: 
[0m21:46:09.827098 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m21:46:09.827755 [debug] [MainThread]: Command end result
[0m21:46:09.838486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:46:09.839649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:46:09.842576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:46:09.842744 [info ] [MainThread]: 
[0m21:46:09.842917 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:09.843055 [info ] [MainThread]: 
[0m21:46:09.843221 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m21:46:09.843353 [info ] [MainThread]: 
[0m21:46:09.843498 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:46:09.843740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.517823, "process_in_blocks": "0", "process_kernel_time": 0.396996, "process_mem_max_rss": "223019008", "process_out_blocks": "0", "process_user_time": 2.810665}
[0m21:46:09.844008 [debug] [MainThread]: Command `dbt run` failed at 21:46:09.843970 after 10.52 seconds
[0m21:46:09.844197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f55eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc4650>]}
[0m21:46:09.844354 [debug] [MainThread]: Flushing usage events
[0m21:46:11.804776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:02.307585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e96720>]}


============================== 21:53:02.310858 | 5c0c8712-b440-4a40-997d-945e2733a83e ==============================
[0m21:53:02.310858 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:53:02.311261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:53:03.456251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f61b0>]}
[0m21:53:03.480464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bddd760>]}
[0m21:53:03.480811 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:53:03.651037 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:53:03.712370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:03.712738 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:53:03.822542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fe120>]}
[0m21:53:03.853659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:53:03.855003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:53:03.867587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114032630>]}
[0m21:53:03.867833 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:53:03.868009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c120c0>]}
[0m21:53:03.868876 [info ] [MainThread]: 
[0m21:53:03.869069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:03.869209 [info ] [MainThread]: 
[0m21:53:03.869447 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:03.871229 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:53:03.871447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:03.871699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:53:03.871970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:53:03.872160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:03.872303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:05.084421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:53:05.085672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:53:05.086507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:53:05.087030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:05.087625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:05.088129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:05.632713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e90230>]}
[0m21:53:05.634041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:05.723929 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:53:05.724186 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:53:05.724351 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:53:05.724586 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:53:05.724855 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:53:05.725117 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:53:05.725425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m21:53:05.725637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m21:53:05.725811 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m21:53:05.725981 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:53:05.726147 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:53:05.726290 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:53:05.731299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:53:05.733261 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:53:05.735357 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:53:05.736869 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:53:05.737057 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:53:05.737235 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:53:05.758401 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:53:05.760051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:53:05.761171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:06.347829 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:53:06.349450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:53:06.349920 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:53:06.350576 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:53:06.350939 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:53:06.352121 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT created_at *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:53:06.488522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:045e387c-3e20-4664-ae7d-6c917e9c273a&page=queryresults
[0m21:53:06.489759 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:045e387c-3e20-4664-ae7d-6c917e9c273a&page=queryresults
[0m21:53:06.501964 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:53:06.504317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043beea0>]}
[0m21:53:06.505163 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 0.78s]
[0m21:53:06.505678 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:53:06.506198 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:53:06.676302 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5ba3543c-1e71-404e-a3a0-b3aefb90e427&page=queryresults
[0m21:53:06.677248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d871877d-a38e-425f-9752-abca4328cb95&page=queryresults
[0m21:53:08.323779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2ff20>]}
[0m21:53:08.324137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ff500>]}
[0m21:53:08.324515 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.60s]
[0m21:53:08.324939 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.60s]
[0m21:53:08.325267 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:53:08.325554 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:53:08.325871 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:53:08.326187 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:53:08.326476 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:53:08.326679 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:53:08.326861 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:53:08.327106 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:53:08.329529 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:53:08.329800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:53:08.330061 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:53:08.332182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:53:08.332729 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:53:08.332956 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:53:08.334454 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:53:08.335886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:08.727852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:53:08.730246 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:53:08.762567 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:53:08.763831 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:53:09.012441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e7529206-d1b8-45e7-be68-d685cef1b158&page=queryresults
[0m21:53:09.061019 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:82a78e50-641a-42e3-8c8c-8ac10411200c&page=queryresults
[0m21:53:10.624436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114722210>]}
[0m21:53:10.625940 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.29s]
[0m21:53:10.627301 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:53:10.640558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0c8712-b440-4a40-997d-945e2733a83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473e570>]}
[0m21:53:10.641771 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.31s]
[0m21:53:10.642569 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:53:10.643514 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m21:53:10.644093 [info ] [Thread-2 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:53:10.644547 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:53:10.645245 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:53:10.645788 [info ] [Thread-1 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:53:10.646370 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:53:10.647838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:10.726154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:10.726396 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:53:10.726538 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:53:10.726657 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:53:10.726779 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:53:10.726989 [info ] [MainThread]: 
[0m21:53:10.727169 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m21:53:10.727827 [debug] [MainThread]: Command end result
[0m21:53:10.738097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:53:10.739126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:53:10.742346 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:53:10.742523 [info ] [MainThread]: 
[0m21:53:10.742710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:53:10.742852 [info ] [MainThread]: 
[0m21:53:10.743022 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:53:10.743155 [info ] [MainThread]: 
[0m21:53:10.743298 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:53:10.743541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.476523, "process_in_blocks": "0", "process_kernel_time": 0.415864, "process_mem_max_rss": "224182272", "process_out_blocks": "0", "process_user_time": 2.559583}
[0m21:53:10.743833 [debug] [MainThread]: Command `dbt run` failed at 21:53:10.743792 after 8.48 seconds
[0m21:53:10.744030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f48d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdcb60>]}
[0m21:53:10.744249 [debug] [MainThread]: Flushing usage events
[0m21:53:12.600944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:10.888735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105662090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579bcb0>]}


============================== 21:54:10.891737 | feed9b65-e210-4caf-99fe-91f8a76e3ae1 ==============================
[0m21:54:10.891737 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:54:10.892099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:11.908291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104796240>]}
[0m21:54:11.933303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264a89b0>]}
[0m21:54:11.933651 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:54:12.026723 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:54:12.088346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:12.088667 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:54:12.197750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386f7200>]}
[0m21:54:12.228141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:54:12.229556 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:54:12.241815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138629f70>]}
[0m21:54:12.242101 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:54:12.242288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138565190>]}
[0m21:54:12.243334 [info ] [MainThread]: 
[0m21:54:12.243555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:12.243706 [info ] [MainThread]: 
[0m21:54:12.243949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:54:12.245726 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:54:12.245963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:12.246283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:54:12.246552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:54:12.246749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:12.246894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:13.694261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:54:13.695785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:54:13.696532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:13.697070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:54:13.697588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:13.698150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:14.268100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1383b1610>]}
[0m21:54:14.269017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:14.354307 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:54:14.354564 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:54:14.354745 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:54:14.354983 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:54:14.355243 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:54:14.355490 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:54:14.355739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m21:54:14.355911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m21:54:14.356076 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:54:14.356231 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:54:14.356379 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:54:14.356521 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:54:14.361571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:54:14.363687 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:54:14.365790 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:54:14.367220 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:54:14.367412 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:54:14.367587 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:54:14.390112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:14.390446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:14.391574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:14.900893 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:54:14.901828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:54:14.902413 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:54:14.902734 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:54:14.913265 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:54:14.914103 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT created_at *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT created_at, user_id, rent_date, return_date
SELECT created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:54:15.032350 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b95b60ee-3e5a-4d9f-9fb2-6af7857d48d3&page=queryresults
[0m21:54:15.033176 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b95b60ee-3e5a-4d9f-9fb2-6af7857d48d3&page=queryresults
[0m21:54:15.044411 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:54:15.046706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473a360>]}
[0m21:54:15.047427 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 0.69s]
[0m21:54:15.047966 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:54:15.048448 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:54:15.151113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:00636564-839b-4fbd-9dc4-8e36547cbaa3&page=queryresults
[0m21:54:15.170482 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4f2950bd-098b-4398-8def-a2e2a5b259c5&page=queryresults
[0m21:54:17.039371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d2fc20>]}
[0m21:54:17.039885 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.68s]
[0m21:54:17.040256 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:54:17.040581 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m21:54:17.040867 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:54:17.041154 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m21:54:17.041343 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:54:17.043747 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:54:17.045389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b14f350>]}
[0m21:54:17.045628 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m21:54:17.047483 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:54:17.045985 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.69s]
[0m21:54:17.048011 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:54:17.114694 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m21:54:17.115189 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:54:17.115691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m21:54:17.115875 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:54:17.117765 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:54:17.118375 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m21:54:17.119628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:17.398576 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:54:17.399918 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:54:17.470513 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:54:17.471931 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:54:17.634233 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:22a8e072-ca80-49d3-8505-2db1b297c7a5&page=queryresults
[0m21:54:17.776322 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:627a9e7b-3e97-4c9c-b0fe-093f1dabe072&page=queryresults
[0m21:54:19.344038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b23deb0>]}
[0m21:54:19.345234 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.23s]
[0m21:54:19.346125 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m21:54:19.458778 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feed9b65-e210-4caf-99fe-91f8a76e3ae1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386b1280>]}
[0m21:54:19.459776 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.42s]
[0m21:54:19.460399 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m21:54:19.461169 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:54:19.461755 [info ] [Thread-1 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:54:19.462311 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:54:19.462937 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:54:19.463334 [info ] [Thread-3 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:54:19.463712 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:54:19.464663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:19.564167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:19.564410 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:54:19.564549 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:54:19.564664 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:54:19.564775 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:54:19.564959 [info ] [MainThread]: 
[0m21:54:19.565153 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m21:54:19.565743 [debug] [MainThread]: Command end result
[0m21:54:19.576723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:54:19.577988 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:54:19.581202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:54:19.581365 [info ] [MainThread]: 
[0m21:54:19.581546 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:54:19.581696 [info ] [MainThread]: 
[0m21:54:19.581868 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Syntax error: Unexpected keyword FROM at [18:5]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:54:19.582011 [info ] [MainThread]: 
[0m21:54:19.582156 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:54:19.582402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.730088, "process_in_blocks": "0", "process_kernel_time": 0.375933, "process_mem_max_rss": "224641024", "process_out_blocks": "0", "process_user_time": 2.50415}
[0m21:54:19.582680 [debug] [MainThread]: Command `dbt run` failed at 21:54:19.582640 after 8.73 seconds
[0m21:54:19.582867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380f1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c85f0>]}
[0m21:54:19.583021 [debug] [MainThread]: Flushing usage events
[0m21:54:21.117225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:10.325636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dca9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c08110>]}


============================== 21:55:10.328629 | b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc ==============================
[0m21:55:10.328629 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:55:10.328983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:55:11.352526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f32aae0>]}
[0m21:55:11.376555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046700e0>]}
[0m21:55:11.376904 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:55:11.474017 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:55:11.537626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:11.537998 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:55:11.648043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113810cb0>]}
[0m21:55:11.677964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:55:11.679720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:55:11.692054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c2ce90>]}
[0m21:55:11.692313 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:55:11.692489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cf3fe0>]}
[0m21:55:11.693370 [info ] [MainThread]: 
[0m21:55:11.693551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:11.693685 [info ] [MainThread]: 
[0m21:55:11.693909 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:11.695733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:55:11.696037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:55:11.696243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:11.696445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:55:11.696633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:11.696817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:13.360357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:55:13.361212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:55:13.361830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:13.362383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:55:13.362976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:13.364041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:13.847570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b67380>]}
[0m21:55:13.848559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:13.934319 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:55:13.934572 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:55:13.934763 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:55:13.935003 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:55:13.935275 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:55:13.935523 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:55:13.935772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m21:55:13.935943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m21:55:13.936098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:55:13.936252 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:55:13.936400 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:55:13.936547 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:55:13.941596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:55:13.943627 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:55:13.945580 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:55:13.947023 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:55:13.947211 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:55:13.947360 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:55:13.968033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:13.969558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:13.970693 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:55:14.439862 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:55:14.440802 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:55:14.442290 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:55:14.442704 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT created_at, user_id, rent_date, return_date
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:55:14.444307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:55:14.445288 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:55:14.693868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d756ab15-2e20-440e-8e28-97dc2b3c2c31&page=queryresults
[0m21:55:14.713249 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c7799b43-491f-4eea-8d5b-9407c6abb60d&page=queryresults
[0m21:55:14.734036 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:62096bf4-5739-45e5-a9af-3ce61303f881&page=queryresults
[0m21:55:14.832849 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c7799b43-491f-4eea-8d5b-9407c6abb60d&page=queryresults
[0m21:55:14.845968 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [32:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:55:14.847563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dff3b0>]}
[0m21:55:14.848125 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 0.91s]
[0m21:55:14.848607 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:55:14.848990 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [32:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:55:16.310996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f533950>]}
[0m21:55:16.311448 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.38s]
[0m21:55:16.311799 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:55:16.312112 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:55:16.312350 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:55:16.312620 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:55:16.312820 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:55:16.315079 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:55:16.315670 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:55:16.317171 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:16.389763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142232c0>]}
[0m21:55:16.390176 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.45s]
[0m21:55:16.390482 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:55:16.390793 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:55:16.391034 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:55:16.391255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:55:16.391411 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:55:16.393272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:55:16.393605 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:55:16.394742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:16.718559 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:55:16.719917 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:55:16.749566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:55:16.750668 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:55:16.981101 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:045c77ae-425c-4714-bb78-84a9e465c5f6&page=queryresults
[0m21:55:17.028440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2d52cd22-ee34-42bb-8954-2056ebeb95be&page=queryresults
[0m21:55:18.511208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a3b60>]}
[0m21:55:18.512230 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.20s]
[0m21:55:18.513016 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:55:18.869603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f8b07a-b396-4d1f-bb3b-6e3fc67363dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a3200>]}
[0m21:55:18.871143 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.48s]
[0m21:55:18.872081 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:55:18.873173 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m21:55:18.873979 [info ] [Thread-3 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:55:18.875003 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:55:18.875915 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:55:18.876545 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:55:18.877207 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:55:18.879000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:18.962097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:18.962329 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:55:18.962465 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:55:18.962583 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:55:18.962692 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:55:18.962867 [info ] [MainThread]: 
[0m21:55:18.963041 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m21:55:18.963601 [debug] [MainThread]: Command end result
[0m21:55:18.973885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:55:18.975190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:55:18.978113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:55:18.978278 [info ] [MainThread]: 
[0m21:55:18.978456 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:55:18.978601 [info ] [MainThread]: 
[0m21:55:18.978776 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [32:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:55:18.978914 [info ] [MainThread]: 
[0m21:55:18.979059 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:55:18.979294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.688763, "process_in_blocks": "0", "process_kernel_time": 0.377028, "process_mem_max_rss": "226279424", "process_out_blocks": "0", "process_user_time": 2.515571}
[0m21:55:18.979555 [debug] [MainThread]: Command `dbt run` failed at 21:55:18.979515 after 8.69 seconds
[0m21:55:18.979754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2c75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dca9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b82090>]}
[0m21:55:18.979922 [debug] [MainThread]: Flushing usage events
[0m21:55:20.867149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:14.839653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106462090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c8410>]}


============================== 21:56:14.842674 | c38cbb2b-71d8-4872-877a-328b725538f2 ==============================
[0m21:56:14.842674 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:56:14.843022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:15.851617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288261b0>]}
[0m21:56:15.875916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288fbd40>]}
[0m21:56:15.876248 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:56:15.970697 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:56:16.032315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:16.032689 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:56:16.143215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12924aa50>]}
[0m21:56:16.173517 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:56:16.175299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:56:16.187841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292316d0>]}
[0m21:56:16.188095 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:56:16.188276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1290b0e30>]}
[0m21:56:16.189174 [info ] [MainThread]: 
[0m21:56:16.189360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:16.189495 [info ] [MainThread]: 
[0m21:56:16.189720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:56:16.191488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:56:16.191802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:56:16.191970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:16.192191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:56:16.192366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:16.192565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:17.332297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:56:17.333234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:56:17.333815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:17.334347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:56:17.334892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:17.335517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:17.861175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128aad430>]}
[0m21:56:17.862471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:17.961310 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:56:17.961625 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:56:17.961820 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:56:17.962066 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:56:17.962370 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:56:17.962672 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:56:17.962950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m21:56:17.963165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m21:56:17.963357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m21:56:17.963527 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:56:17.963695 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:56:17.963841 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:56:17.969693 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:56:17.971735 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:56:17.973445 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:56:17.975012 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:56:17.975199 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:56:17.975375 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:56:17.999719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:18.000450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:56:18.001588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:56:18.534872 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:56:18.536022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:56:18.537967 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:56:18.539380 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:56:18.539719 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
SELECT rent_id, created_at, user_id, rent_date, return_date
FROM `purwadika`.`diego_library_final_project`.`rents`

)

SELECT created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:56:18.540057 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:56:18.776348 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:13b1ad07-ce16-4fab-b7d5-97c3a0b53ea7&page=queryresults
[0m21:56:18.777735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5ba3dbf0-d561-4f3c-ba37-919d79b86985&page=queryresults
[0m21:56:18.800668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e8fb280b-334a-43a8-9bee-8fa2dc7df849&page=queryresults
[0m21:56:18.900968 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5ba3dbf0-d561-4f3c-ba37-919d79b86985&page=queryresults
[0m21:56:18.916914 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:56:18.918852 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563a930>]}
[0m21:56:18.920374 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 0.95s]
[0m21:56:18.921007 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:56:18.921536 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:56:20.412140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129483a70>]}
[0m21:56:20.412493 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a2fce0>]}
[0m21:56:20.412886 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.45s]
[0m21:56:20.413275 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.45s]
[0m21:56:20.413613 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:56:20.413885 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:56:20.414333 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m21:56:20.414535 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_users
[0m21:56:20.414797 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:56:20.415068 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:56:20.415330 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m21:56:20.415516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_users)
[0m21:56:20.415702 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:56:20.415872 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:56:20.417989 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:56:20.420328 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:56:20.420824 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m21:56:20.421026 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_users
[0m21:56:20.422491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:56:20.424711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:56:20.796322 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:56:20.798699 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:56:20.801342 [debug] [Thread-2 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:56:20.802116 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:56:21.032986 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:917d4e32-4668-46d3-b339-a4a9ef925672&page=queryresults
[0m21:56:21.051457 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:cbe356be-d916-4f87-8ddc-093922d2961b&page=queryresults
[0m21:56:22.593638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a94da30>]}
[0m21:56:22.595140 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.18s]
[0m21:56:22.596213 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m21:56:22.842474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38cbb2b-71d8-4872-877a-328b725538f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292a4680>]}
[0m21:56:22.844081 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.43s]
[0m21:56:22.845203 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_users
[0m21:56:22.846596 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m21:56:22.847436 [info ] [Thread-3 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:56:22.848054 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:56:22.848790 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:56:22.849252 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:56:22.849868 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:56:22.852083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:22.937612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:22.937864 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:56:22.938004 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:56:22.938128 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:56:22.938242 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:56:22.938434 [info ] [MainThread]: 
[0m21:56:22.938613 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m21:56:22.939175 [debug] [MainThread]: Command end result
[0m21:56:22.949703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:56:22.950958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:56:22.954787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:56:22.954976 [info ] [MainThread]: 
[0m21:56:22.955168 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:56:22.955322 [info ] [MainThread]: 
[0m21:56:22.955498 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:56:22.955641 [info ] [MainThread]: 
[0m21:56:22.955791 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:56:22.956029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.149969, "process_in_blocks": "0", "process_kernel_time": 0.383992, "process_mem_max_rss": "225689600", "process_out_blocks": "0", "process_user_time": 2.584047}
[0m21:56:22.956303 [debug] [MainThread]: Command `dbt run` failed at 21:56:22.956263 after 8.15 seconds
[0m21:56:22.956485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f41160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292f75f0>]}
[0m21:56:22.956646 [debug] [MainThread]: Flushing usage events
[0m21:56:24.292581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:01.107323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ddb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123192420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234c4560>]}


============================== 21:57:01.110343 | cde76ae0-da5e-4650-ad98-c78ec4ea74f1 ==============================
[0m21:57:01.110343 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:57:01.110675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:02.165173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122394560>]}
[0m21:57:02.189498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e586d50>]}
[0m21:57:02.189847 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:57:02.281928 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:57:02.344012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:02.344356 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:57:02.455652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eef6ff0>]}
[0m21:57:02.485896 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:57:02.487266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:57:02.499457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee33440>]}
[0m21:57:02.499697 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:57:02.499869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ed8d010>]}
[0m21:57:02.500852 [info ] [MainThread]: 
[0m21:57:02.501043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:02.501178 [info ] [MainThread]: 
[0m21:57:02.501413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:57:02.503285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:57:02.503604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:57:02.503783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:02.504021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:57:02.504168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:02.504385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:04.678909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:57:04.680265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:57:04.680897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:04.681388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:57:04.681885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:04.682482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:05.160796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ec74e30>]}
[0m21:57:05.161988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:05.248541 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:57:05.248791 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:57:05.248984 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:57:05.249224 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:57:05.249483 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:57:05.249705 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:57:05.249922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:57:05.250091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:57:05.250271 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:57:05.250560 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:57:05.250741 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:57:05.250907 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:57:05.255840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:57:05.257746 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:57:05.259641 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:57:05.260426 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:57:05.260639 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:57:05.260821 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:57:05.285087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:05.286226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:57:05.287410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:57:05.782112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:57:05.783184 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:57:05.788591 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:57:05.789109 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:57:05.849076 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:57:05.849993 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
SELECT created_at, user_id, rent_date, return_date
FROM `purwadika`.`diego_library_final_project`.`rents`

)

SELECT created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:57:06.027134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4a783e77-edd8-41b4-b961-e04439555c6f&page=queryresults
[0m21:57:06.047840 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d931bb69-ec30-4e40-b8c3-585f636dba00&page=queryresults
[0m21:57:06.088489 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5f2495f0-a5e9-4adc-bddb-17f953205bc3&page=queryresults
[0m21:57:06.227970 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5f2495f0-a5e9-4adc-bddb-17f953205bc3&page=queryresults
[0m21:57:06.241824 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:57:06.243863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12233a960>]}
[0m21:57:06.244581 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 0.99s]
[0m21:57:06.245084 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:57:06.245535 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:57:07.604007 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e52fad0>]}
[0m21:57:07.604360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef69d00>]}
[0m21:57:07.604754 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.35s]
[0m21:57:07.605417 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:57:07.605145 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.35s]
[0m21:57:07.605784 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m21:57:07.606056 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:57:07.606309 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:57:07.606604 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m21:57:07.606858 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m21:57:07.607112 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:57:07.607334 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:57:07.607536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m21:57:07.609647 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:57:07.609870 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:57:07.611907 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:57:07.612318 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m21:57:07.613679 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:57:07.613903 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m21:57:07.615288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:57:08.023542 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:57:08.024512 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:57:08.043163 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:57:08.043994 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:57:08.272947 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a81d9f89-486a-4f7c-82cd-f06c0ff4a7a0&page=queryresults
[0m21:57:08.274179 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f6452157-4647-41d6-8803-d18a0f80d58e&page=queryresults
[0m21:57:09.859806 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef7f470>]}
[0m21:57:09.860603 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.25s]
[0m21:57:09.861230 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m21:57:10.088521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde76ae0-da5e-4650-ad98-c78ec4ea74f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f5a79e0>]}
[0m21:57:10.089331 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.48s]
[0m21:57:10.089965 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m21:57:10.090608 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:57:10.090971 [info ] [Thread-1 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:57:10.091334 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:57:10.091933 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:57:10.092341 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:57:10.092855 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:57:10.094011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:10.171090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:10.171327 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:57:10.171471 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:57:10.171586 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:57:10.171694 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:57:10.171870 [info ] [MainThread]: 
[0m21:57:10.172046 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m21:57:10.172609 [debug] [MainThread]: Command end result
[0m21:57:10.183119 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:57:10.184350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:57:10.187295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:57:10.187466 [info ] [MainThread]: 
[0m21:57:10.187641 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:57:10.187781 [info ] [MainThread]: 
[0m21:57:10.187952 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:57:10.188087 [info ] [MainThread]: 
[0m21:57:10.188229 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:57:10.188455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.118907, "process_in_blocks": "0", "process_kernel_time": 0.379373, "process_mem_max_rss": "226312192", "process_out_blocks": "0", "process_user_time": 2.504408}
[0m21:57:10.188715 [debug] [MainThread]: Command `dbt run` failed at 21:57:10.188676 after 9.12 seconds
[0m21:57:10.188906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12300bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d81c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12322eb40>]}
[0m21:57:10.189077 [debug] [MainThread]: Flushing usage events
[0m21:57:12.178472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:08.771885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108768710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087683b0>]}


============================== 21:58:08.775013 | 1632b96f-c1e8-4b03-ad20-e498b03e2dde ==============================
[0m21:58:08.775013 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:58:08.775371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:09.796225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170feae0>]}
[0m21:58:09.820864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171e22d0>]}
[0m21:58:09.821218 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:58:09.915010 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:58:09.976694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:09.977027 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:58:10.087932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177ff5c0>]}
[0m21:58:10.118233 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:58:10.119510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:58:10.131991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177334a0>]}
[0m21:58:10.132235 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:58:10.132414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177eff80>]}
[0m21:58:10.133306 [info ] [MainThread]: 
[0m21:58:10.133489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:10.133623 [info ] [MainThread]: 
[0m21:58:10.133846 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:58:10.135728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:58:10.136034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:58:10.136253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:10.136458 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:58:10.136647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:10.136837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:11.431991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:58:11.433180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:58:11.434181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:58:11.435048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:11.435880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:11.436408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:11.941812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177edf70>]}
[0m21:58:11.942464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:12.017630 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:58:12.017872 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:58:12.018054 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:58:12.018282 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:58:12.018552 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:58:12.018788 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:58:12.019072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:58:12.019285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m21:58:12.019462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m21:58:12.019630 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:58:12.019788 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:58:12.019928 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:58:12.025125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:58:12.027098 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:58:12.028770 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:58:12.030537 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:58:12.030787 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:58:12.037079 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:58:12.053974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:12.055329 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:12.056445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:12.629189 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:58:12.632320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:58:12.632972 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:58:12.633326 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:58:12.755826 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:58:12.756987 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
SELECT rent_id, created_at, user_id, rent_date, return_date
FROM `purwadika`.`diego_library_final_project`.`rents`

)

SELECT created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:58:12.864497 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ec045b3d-b3a4-4678-902f-18acba4c1a2d&page=queryresults
[0m21:58:12.924507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:83129e83-ca73-4a0e-a2a4-9521629ffe76&page=queryresults
[0m21:58:13.016220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6bc162bb-c0c3-45d0-9306-1436c5d2c28d&page=queryresults
[0m21:58:13.154323 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6bc162bb-c0c3-45d0-9306-1436c5d2c28d&page=queryresults
[0m21:58:13.167960 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:58:13.169640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178d5190>]}
[0m21:58:13.170207 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 1.15s]
[0m21:58:13.170656 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:58:13.171021 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:58:14.492202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117890980>]}
[0m21:58:14.492745 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.47s]
[0m21:58:14.493138 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:58:14.493470 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m21:58:14.493734 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:58:14.494013 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m21:58:14.494203 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:58:14.496434 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:58:14.496837 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m21:58:14.498344 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:14.567541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117315940>]}
[0m21:58:14.567940 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.55s]
[0m21:58:14.568264 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:58:14.568593 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m21:58:14.568802 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:58:14.569008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m21:58:14.569151 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:58:14.571003 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:58:14.571350 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m21:58:14.573381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:14.932070 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:58:14.934689 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:58:14.935890 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:58:14.936636 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:58:15.209089 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:12b6332e-501b-4871-9287-c2a67b1b5685&page=queryresults
[0m21:58:15.210245 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:50c67e9a-108a-4ba4-a267-d2768ac183c2&page=queryresults
[0m21:58:17.121188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177b1100>]}
[0m21:58:17.122690 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.63s]
[0m21:58:17.123792 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m21:58:17.382176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1632b96f-c1e8-4b03-ad20-e498b03e2dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e9c1a0>]}
[0m21:58:17.383179 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.81s]
[0m21:58:17.383938 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m21:58:17.384876 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m21:58:17.385430 [info ] [Thread-1 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:58:17.385934 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:58:17.386661 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:58:17.387115 [info ] [Thread-4 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:58:17.387571 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:58:17.388699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:17.470619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:17.470861 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m21:58:17.471001 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m21:58:17.471121 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:58:17.471237 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:58:17.471408 [info ] [MainThread]: 
[0m21:58:17.471585 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m21:58:17.472149 [debug] [MainThread]: Command end result
[0m21:58:17.482801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:58:17.484317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:58:17.487392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:58:17.487565 [info ] [MainThread]: 
[0m21:58:17.487748 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:58:17.487898 [info ] [MainThread]: 
[0m21:58:17.488074 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name rent_id not found inside DBT_INTERNAL_SOURCE at [33:37]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:58:17.488213 [info ] [MainThread]: 
[0m21:58:17.488357 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:58:17.488591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.7539625, "process_in_blocks": "0", "process_kernel_time": 0.375736, "process_mem_max_rss": "223887360", "process_out_blocks": "0", "process_user_time": 2.532853}
[0m21:58:17.488854 [debug] [MainThread]: Command `dbt run` failed at 21:58:17.488815 after 8.75 seconds
[0m21:58:17.489038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171ac350>]}
[0m21:58:17.489194 [debug] [MainThread]: Flushing usage events
[0m21:58:19.010312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:20.742326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bc440>]}


============================== 21:59:20.745644 | e4be0c05-78d5-463f-bebb-35b1671ff92f ==============================
[0m21:59:20.745644 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:59:20.746021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:21.787042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104789d00>]}
[0m21:59:21.811719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ce720>]}
[0m21:59:21.812071 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:59:21.908411 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m21:59:21.970975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:59:21.971339 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/staging/staging_rents.sql
[0m21:59:22.082537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154f74d0>]}
[0m21:59:22.113312 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:59:22.115029 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:59:22.127006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11542b530>]}
[0m21:59:22.127272 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m21:59:22.127453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153de600>]}
[0m21:59:22.128405 [info ] [MainThread]: 
[0m21:59:22.128597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:59:22.128733 [info ] [MainThread]: 
[0m21:59:22.128961 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:22.130795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:59:22.131023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:22.131287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:59:22.131586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m21:59:22.131763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:22.131941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:23.267839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m21:59:23.268473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m21:59:23.268756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:23.268994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m21:59:23.269243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:23.269482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:23.742837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150130e0>]}
[0m21:59:23.744255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:23.832767 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m21:59:23.833032 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m21:59:23.833228 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m21:59:23.833468 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m21:59:23.833755 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m21:59:23.834042 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m21:59:23.834275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m21:59:23.834469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m21:59:23.834646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m21:59:23.834810 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m21:59:23.834971 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m21:59:23.835119 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m21:59:23.840411 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m21:59:23.842307 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m21:59:23.844709 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m21:59:23.845606 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m21:59:23.845793 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m21:59:23.845963 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m21:59:23.868042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:23.869038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:59:23.870186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:59:24.335576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m21:59:24.338657 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m21:59:24.339357 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_books` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:59:24.339725 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:59:24.360317 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m21:59:24.361043 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_staging`.`staging_rents` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT rent_id, created_at, user_id, rent_date, return_date
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT rent_id, created_at, user_id, rent_date, return_date
FROM source


    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.rent_id = DBT_INTERNAL_DEST.rent_id
            )

    
    when matched then update set
        `rent_id` = DBT_INTERNAL_SOURCE.`rent_id`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`book_id` = DBT_INTERNAL_SOURCE.`book_id`,`rent_date` = DBT_INTERNAL_SOURCE.`rent_date`,`return_date` = DBT_INTERNAL_SOURCE.`return_date`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)
    values
        (`rent_id`, `user_id`, `book_id`, `rent_date`, `return_date`, `created_at`)


    
[0m21:59:24.621353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:82fab22a-7b54-43ee-9edf-6a0d732a9fb9&page=queryresults
[0m21:59:24.679493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9f831fd6-c2e4-4af1-92d9-bea56a36303f&page=queryresults
[0m21:59:24.689648 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9ade3880-f00f-472b-a1ee-92b966bdcb14&page=queryresults
[0m21:59:24.880662 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9ade3880-f00f-472b-a1ee-92b966bdcb14&page=queryresults
[0m21:59:24.897410 [debug] [Thread-2 (]: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name book_id not found inside DBT_INTERNAL_SOURCE at [37:125]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:59:24.899538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057aeed0>]}
[0m21:59:24.900257 [error] [Thread-2 (]: 2 of 7 ERROR creating sql incremental model diego_dwh_library_staging.staging_rents  [[31mERROR[0m in 1.06s]
[0m21:59:24.900812 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m21:59:24.901337 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.staging_rents' to be skipped because of status 'error'.  Reason: Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name book_id not found inside DBT_INTERNAL_SOURCE at [37:125]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql.
[0m21:59:26.288750 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115586f30>]}
[0m21:59:26.289285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115587230>]}
[0m21:59:26.289990 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.45s]
[0m21:59:26.290356 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.45s]
[0m21:59:26.290700 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m21:59:26.290973 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m21:59:26.291455 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m21:59:26.291757 [info ] [Thread-1 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m21:59:26.292021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m21:59:26.292241 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_books
[0m21:59:26.292435 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m21:59:26.292678 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m21:59:26.297476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m21:59:26.297797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_books)
[0m21:59:26.298076 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_books
[0m21:59:26.300259 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m21:59:26.300619 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m21:59:26.302210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:26.302517 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_books
[0m21:59:26.303904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:59:26.678027 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m21:59:26.679330 [debug] [Thread-2 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_books` as DBT_INTERNAL_DEST
        using (

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.book_id = DBT_INTERNAL_DEST.book_id
            )

    
    when matched then update set
        `book_id` = DBT_INTERNAL_SOURCE.`book_id`,`title` = DBT_INTERNAL_SOURCE.`title`,`author` = DBT_INTERNAL_SOURCE.`author`,`release_year` = DBT_INTERNAL_SOURCE.`release_year`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`book_id`, `title`, `author`, `release_year`, `created_at`)
    values
        (`book_id`, `title`, `author`, `release_year`, `created_at`)


    
[0m21:59:26.757127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m21:59:26.758883 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`diego_dwh_library_dimfact`.`dim_users` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        `user_id` = DBT_INTERNAL_SOURCE.`user_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`user_id`, `name`, `email`, `gender`, `created_at`)
    values
        (`user_id`, `name`, `email`, `gender`, `created_at`)


    
[0m21:59:26.905370 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f46a4450-4ee6-4d6d-8b36-dcbfc1344b95&page=queryresults
[0m21:59:27.046492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0af8f895-3cb1-43e7-abf2-e3f7a73182d6&page=queryresults
[0m21:59:28.609734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115590cb0>]}
[0m21:59:28.610903 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.32s]
[0m21:59:28.611591 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m21:59:28.731709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4be0c05-78d5-463f-bebb-35b1671ff92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155d2240>]}
[0m21:59:28.732162 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mMERGE (0.0 rows, 2.8 KiB processed)[0m in 2.43s]
[0m21:59:28.732525 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_books
[0m21:59:28.733125 [debug] [Thread-4 (]: Began running node model.dbt_dpd.fact_rents
[0m21:59:28.733483 [info ] [Thread-4 (]: 6 of 7 SKIP relation diego_dwh_library_dimfact.fact_rents ...................... [[33mSKIP[0m]
[0m21:59:28.733759 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.fact_rents
[0m21:59:28.734108 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m21:59:28.734383 [info ] [Thread-1 (]: 7 of 7 SKIP relation diego_dwh_library_marts.dmart_user_book ................... [[33mSKIP[0m]
[0m21:59:28.734681 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m21:59:28.735395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:28.802696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:28.802975 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m21:59:28.803132 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m21:59:28.803266 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_users' was properly closed.
[0m21:59:28.803487 [info ] [MainThread]: 
[0m21:59:28.803662 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m21:59:28.804635 [debug] [MainThread]: Command end result
[0m21:59:28.816264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m21:59:28.817816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m21:59:28.821476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m21:59:28.821662 [info ] [MainThread]: 
[0m21:59:28.821860 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:59:28.822007 [info ] [MainThread]: 
[0m21:59:28.822179 [error] [MainThread]:   Database Error in model staging_rents (models/staging/staging_rents.sql)
  Name book_id not found inside DBT_INTERNAL_SOURCE at [37:125]
  compiled code at target/run/dbt_dpd/models/staging/staging_rents.sql
[0m21:59:28.822325 [info ] [MainThread]: 
[0m21:59:28.822481 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m21:59:28.822805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.1156645, "process_in_blocks": "0", "process_kernel_time": 0.402618, "process_mem_max_rss": "219742208", "process_out_blocks": "0", "process_user_time": 2.536737}
[0m21:59:28.823118 [debug] [MainThread]: Command `dbt run` failed at 21:59:28.823081 after 8.12 seconds
[0m21:59:28.823347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153ba5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106436180>]}
[0m21:59:28.823506 [debug] [MainThread]: Flushing usage events
[0m21:59:30.819189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:08.119174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597f50>]}


============================== 12:35:08.122386 | f4c09144-81ae-41d6-9434-c69062c85281 ==============================
[0m12:35:08.122386 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:35:08.122713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:35:08.211913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c09144-81ae-41d6-9434-c69062c85281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107694e00>]}
[0m12:35:08.250566 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16853158, "process_in_blocks": "0", "process_kernel_time": 0.174745, "process_mem_max_rss": "97878016", "process_out_blocks": "0", "process_user_time": 0.698319}
[0m12:35:08.251007 [debug] [MainThread]: Command `dbt clean` succeeded at 12:35:08.250940 after 0.17 seconds
[0m12:35:08.251238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108756b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108597bc0>]}
[0m12:35:08.251434 [debug] [MainThread]: Flushing usage events
[0m12:35:10.146316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:17.937257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e05df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c4530>]}


============================== 12:35:17.939989 | 2f540497-85a1-448a-a663-9f0962305cec ==============================
[0m12:35:17.939989 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:35:17.940309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:21.733673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105958f80>]}
[0m12:35:21.759550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048597f0>]}
[0m12:35:21.759948 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:35:21.889246 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:35:21.889685 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:35:21.889903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121be32c0>]}
[0m12:35:22.396668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ad7680>]}
[0m12:35:22.440798 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:35:22.442427 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:35:22.456933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ad8d40>]}
[0m12:35:22.457246 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m12:35:22.457451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af71a0>]}
[0m12:35:22.458601 [info ] [MainThread]: 
[0m12:35:22.458822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:22.458974 [info ] [MainThread]: 
[0m12:35:22.459314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:22.461703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:35:22.461991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:22.462382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:35:22.462719 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:35:22.462936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:22.463103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:23.853003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m12:35:23.854678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:23.855538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m12:35:23.857851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m12:35:23.948389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:23.953493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:24.396978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce960>]}
[0m12:35:24.397818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:24.486616 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m12:35:24.487122 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m12:35:24.488092 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m12:35:24.487768 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m12:35:24.488465 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m12:35:24.488708 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m12:35:24.488977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m12:35:24.489157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m12:35:24.489320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m12:35:24.489514 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m12:35:24.489722 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m12:35:24.489878 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m12:35:24.498112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m12:35:24.500223 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m12:35:24.502121 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m12:35:24.503154 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m12:35:24.503356 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m12:35:24.509234 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m12:35:24.528823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:24.532412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:24.533810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:35:25.022454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m12:35:25.023380 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m12:35:25.023894 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m12:35:25.025101 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:35:25.025348 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m12:35:25.025641 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:35:25.314938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6359f828-5e38-4b96-84ae-cd6ad0d81452&page=queryresults
[0m12:35:25.343659 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ad2c94f0-d357-4d51-9044-3cfab5956443&page=queryresults
[0m12:35:25.513361 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:53d280b0-a038-4505-b348-991b648f564d&page=queryresults
[0m12:35:27.248543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230aea20>]}
[0m12:35:27.248937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a7c560>]}
[0m12:35:27.249830 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.76s]
[0m12:35:27.250384 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.76s]
[0m12:35:27.250888 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m12:35:27.251242 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m12:35:27.252043 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m12:35:27.252357 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m12:35:27.252709 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m12:35:27.252944 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m12:35:27.255909 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m12:35:27.256470 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m12:35:27.258363 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:35:27.349193 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b35f40>]}
[0m12:35:27.349594 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.86s]
[0m12:35:27.349901 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m12:35:27.350228 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_users
[0m12:35:27.350496 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m12:35:27.350722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_users)
[0m12:35:27.350900 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_users
[0m12:35:27.353755 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m12:35:27.354144 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_users
[0m12:35:27.355529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:27.684985 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m12:35:27.687741 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m12:35:27.701149 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m12:35:27.702935 [debug] [Thread-2 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m12:35:27.927984 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:3a4d826b-8007-47d3-b02d-c9f926f3dbac&page=queryresults
[0m12:35:28.269974 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bcdddc51-da8b-4394-ba92-1e62fa1e1728&page=queryresults
[0m12:35:29.620708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230b97f0>]}
[0m12:35:29.622283 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.37s]
[0m12:35:29.623340 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m12:35:29.946309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12314b6e0>]}
[0m12:35:29.949381 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.60s]
[0m12:35:29.950980 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_users
[0m12:35:29.952582 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m12:35:29.953319 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m12:35:29.954076 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m12:35:29.954653 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m12:35:29.962001 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m12:35:29.963195 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m12:35:29.967243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:35:30.456228 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m12:35:30.457652 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m12:35:30.741610 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ec39450e-3a24-4be5-a2b4-cfdbed37cc9e&page=queryresults
[0m12:35:32.612199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12316f110>]}
[0m12:35:32.615097 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.66s]
[0m12:35:32.616373 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m12:35:32.618430 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m12:35:32.619162 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m12:35:32.619891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m12:35:32.620636 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m12:35:32.628000 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m12:35:32.629162 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m12:35:32.633219 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m12:35:32.634280 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, DATE(fact_rents.created_at)
    );
  
[0m12:35:32.634772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:35:33.115800 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d6684a5d-5881-4b04-8aa0-a77d13f247ec&page=queryresults
[0m12:35:33.177041 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d6684a5d-5881-4b04-8aa0-a77d13f247ec&page=queryresults
[0m12:35:33.189228 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:35:33.189731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f540497-85a1-448a-a663-9f0962305cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123187770>]}
[0m12:35:33.190566 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.57s]
[0m12:35:33.191279 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m12:35:33.191990 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m12:35:33.195098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:33.279852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:33.280218 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m12:35:33.280616 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m12:35:33.280782 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m12:35:33.280936 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m12:35:33.281197 [info ] [MainThread]: 
[0m12:35:33.281478 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m12:35:33.282422 [debug] [MainThread]: Command end result
[0m12:35:33.360070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:35:33.361150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:35:33.364092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m12:35:33.364283 [info ] [MainThread]: 
[0m12:35:33.364468 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:33.364613 [info ] [MainThread]: 
[0m12:35:33.364779 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:35:33.364915 [info ] [MainThread]: 
[0m12:35:33.365061 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:35:33.365288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.463455, "process_in_blocks": "0", "process_kernel_time": 0.553547, "process_mem_max_rss": "218497024", "process_out_blocks": "0", "process_user_time": 3.370214}
[0m12:35:33.365532 [debug] [MainThread]: Command `dbt run` failed at 12:35:33.365492 after 15.46 seconds
[0m12:35:33.365722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e05df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa2360>]}
[0m12:35:33.365888 [debug] [MainThread]: Flushing usage events
[0m12:35:35.473807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:52.893031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ba180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089865a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de0530>]}


============================== 12:40:52.896201 | 8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47 ==============================
[0m12:40:52.896201 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:40:52.896536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:53.953532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108274fb0>]}
[0m12:40:53.982103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113789bb0>]}
[0m12:40:53.982515 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:40:54.087430 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:40:54.149453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:54.149779 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m12:40:54.257089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dd2900>]}
[0m12:40:54.287330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:40:54.288627 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:40:54.300498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d855b0>]}
[0m12:40:54.300738 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m12:40:54.300915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117da9190>]}
[0m12:40:54.301803 [info ] [MainThread]: 
[0m12:40:54.301993 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:54.302132 [info ] [MainThread]: 
[0m12:40:54.302356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:54.304152 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:40:54.304380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:54.304582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:40:54.304854 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:40:54.305061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:54.305200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:55.373010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m12:40:55.374195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m12:40:55.374785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:55.375260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m12:40:55.375745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:55.376233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:55.863558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117915e50>]}
[0m12:40:55.864917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:55.952944 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m12:40:55.953241 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m12:40:55.953435 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m12:40:55.953712 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m12:40:55.954026 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m12:40:55.954308 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m12:40:55.954558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m12:40:55.954735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_rents)
[0m12:40:55.954895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m12:40:55.955056 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m12:40:55.955246 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m12:40:55.955389 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m12:40:55.965521 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m12:40:55.966494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m12:40:55.968356 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m12:40:55.969253 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m12:40:55.969460 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m12:40:56.000445 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m12:40:56.004123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:56.005118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:56.006407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:56.484476 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m12:40:56.485331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m12:40:56.486880 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m12:40:56.487689 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:40:56.488024 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:40:56.488305 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m12:40:56.757993 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c5e9ef23-a4b8-4a74-8208-0efdc0df96b8&page=queryresults
[0m12:40:56.807234 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:55580a44-dd43-4b92-8b21-5ea3add821d2&page=queryresults
[0m12:40:56.809788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:abe3e63d-91d4-473e-bc1d-f6da8f6a80b0&page=queryresults
[0m12:40:58.542441 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f9c5c0>]}
[0m12:40:58.542829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370bb30>]}
[0m12:40:58.543669 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f9d5b0>]}
[0m12:40:58.543305 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.59s]
[0m12:40:58.544091 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.59s]
[0m12:40:58.544473 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.59s]
[0m12:40:58.544950 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m12:40:58.545274 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m12:40:58.545589 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m12:40:58.546165 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m12:40:58.546450 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_users
[0m12:40:58.546722 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m12:40:58.547094 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m12:40:58.547509 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m12:40:58.547789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_users)
[0m12:40:58.548040 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m12:40:58.548276 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_users
[0m12:40:58.551066 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m12:40:58.553396 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m12:40:58.553946 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_users
[0m12:40:58.554185 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m12:40:58.555793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:58.558026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:40:58.933504 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m12:40:58.935906 [debug] [Thread-3 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m12:40:58.953101 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m12:40:58.955169 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m12:40:59.183580 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9464438f-48e3-46ca-b995-12961022b359&page=queryresults
[0m12:40:59.186449 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bdf6b4c9-4c52-4dae-a882-165047be5d39&page=queryresults
[0m12:41:00.841016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13601c9e0>]}
[0m12:41:00.842600 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.29s]
[0m12:41:00.843604 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_users
[0m12:41:01.093374 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1360006e0>]}
[0m12:41:01.095521 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.55s]
[0m12:41:01.096657 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m12:41:01.098703 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m12:41:01.100230 [info ] [Thread-2 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m12:41:01.101050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.fact_rents)
[0m12:41:01.101541 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.fact_rents
[0m12:41:01.108695 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m12:41:01.109942 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.fact_rents
[0m12:41:01.113216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:01.438508 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m12:41:01.440789 [debug] [Thread-2 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m12:41:01.665630 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b9f7e4c7-e6ea-499b-a973-eb1dfb78a826&page=queryresults
[0m12:41:03.644690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13602e300>]}
[0m12:41:03.646402 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.54s]
[0m12:41:03.647433 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m12:41:03.648548 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dmart_user_book
[0m12:41:03.649320 [info ] [Thread-3 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m12:41:03.650023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m12:41:03.650564 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m12:41:03.657050 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m12:41:03.658044 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m12:41:03.661366 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m12:41:03.662522 [debug] [Thread-3 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by created_at
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date
    );
  
[0m12:41:03.662928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:04.115140 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e7fb25a0-442d-4fbf-acce-f19771a7d48d&page=queryresults
[0m12:41:04.196699 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e7fb25a0-442d-4fbf-acce-f19771a7d48d&page=queryresults
[0m12:41:04.223694 [debug] [Thread-3 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:41:04.224405 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d17ee7d-e4c0-4896-85d3-b6b2f9e1ef47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c86780>]}
[0m12:41:04.224962 [error] [Thread-3 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.57s]
[0m12:41:04.225280 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m12:41:04.225588 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m12:41:04.227690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:04.301507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:04.301806 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m12:41:04.301970 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m12:41:04.302101 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m12:41:04.302216 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m12:41:04.302439 [info ] [MainThread]: 
[0m12:41:04.302628 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m12:41:04.303364 [debug] [MainThread]: Command end result
[0m12:41:04.317739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:41:04.319502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:41:04.323692 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m12:41:04.324051 [info ] [MainThread]: 
[0m12:41:04.324557 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:41:04.324718 [info ] [MainThread]: 
[0m12:41:04.324907 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  Unrecognized name: created_at at [8:18]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:41:04.325054 [info ] [MainThread]: 
[0m12:41:04.325421 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:41:04.325845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.471072, "process_in_blocks": "0", "process_kernel_time": 0.431683, "process_mem_max_rss": "220790784", "process_out_blocks": "0", "process_user_time": 2.815794}
[0m12:41:04.326188 [debug] [MainThread]: Command `dbt run` failed at 12:41:04.326144 after 11.47 seconds
[0m12:41:04.326408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178f1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ba180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370bb30>]}
[0m12:41:04.326569 [debug] [MainThread]: Flushing usage events
[0m12:41:06.033269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:03.981899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107476c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c8500>]}


============================== 12:42:03.990304 | ed224d11-d22d-40f2-bb54-6ad0a447f43e ==============================
[0m12:42:03.990304 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:42:03.990992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:05.200153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111758ef0>]}
[0m12:42:05.224635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249fa420>]}
[0m12:42:05.224999 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:42:05.322536 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:42:05.384269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:05.384614 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m12:42:05.492410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dd29f0>]}
[0m12:42:05.522291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:42:05.524349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:42:05.537438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d651f0>]}
[0m12:42:05.537743 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m12:42:05.537969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125915bb0>]}
[0m12:42:05.539003 [info ] [MainThread]: 
[0m12:42:05.539210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:05.539359 [info ] [MainThread]: 
[0m12:42:05.539618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:05.541633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:42:05.541875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:05.542093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:42:05.542379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:42:05.542567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:05.542763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:06.778730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m12:42:06.779252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m12:42:06.779552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:06.779811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m12:42:06.780032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:06.780289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:07.234760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125db2240>]}
[0m12:42:07.235904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:07.325086 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m12:42:07.325391 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m12:42:07.325593 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m12:42:07.325840 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m12:42:07.326115 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m12:42:07.326343 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m12:42:07.326568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_books)
[0m12:42:07.326734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m12:42:07.326882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m12:42:07.327036 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m12:42:07.327293 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m12:42:07.327458 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m12:42:07.334510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m12:42:07.336184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m12:42:07.337820 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m12:42:07.339091 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m12:42:07.339302 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m12:42:07.357661 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m12:42:07.367811 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:42:07.369628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:07.370992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:07.862761 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m12:42:07.863893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m12:42:07.864271 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m12:42:07.865755 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:42:07.866099 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:42:07.866392 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m12:42:08.127114 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:289f2525-2fd4-4651-b657-64fa4cf9e882&page=queryresults
[0m12:42:08.129216 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:192b7ed5-bb75-4f25-9040-39dc9bd358ce&page=queryresults
[0m12:42:08.148759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4254d4ec-d8d2-4b41-a077-f6bd2d99ccd3&page=queryresults
[0m12:42:09.900510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124b2fd40>]}
[0m12:42:09.900923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e98710>]}
[0m12:42:09.901535 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.57s]
[0m12:42:09.902400 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m12:42:09.901982 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.57s]
[0m12:42:09.902908 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m12:42:09.903257 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m12:42:09.903584 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m12:42:09.903930 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m12:42:09.904167 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m12:42:09.907000 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m12:42:09.907489 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m12:42:09.909284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:42:10.083696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ecd190>]}
[0m12:42:10.084342 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.76s]
[0m12:42:10.084876 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m12:42:10.085365 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m12:42:10.085812 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m12:42:10.086269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_users)
[0m12:42:10.086547 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m12:42:10.089533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m12:42:10.090144 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m12:42:10.093641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:10.291587 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m12:42:10.293523 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m12:42:10.420945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m12:42:10.422572 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m12:42:10.674946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:defa1f57-7059-431d-85d3-2b4940d47f78&page=queryresults
[0m12:42:11.678849 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b8b0a2fc-f3fe-46b5-b02f-ff1967c749b3&page=queryresults
[0m12:42:12.621338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126977f20>]}
[0m12:42:12.623756 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.53s]
[0m12:42:12.624758 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m12:42:13.288401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126aacd70>]}
[0m12:42:13.290087 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.38s]
[0m12:42:13.291230 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m12:42:13.294452 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m12:42:13.295470 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m12:42:13.296536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m12:42:13.297201 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m12:42:13.310907 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m12:42:13.312171 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m12:42:13.314726 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:42:13.646031 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m12:42:13.648863 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m12:42:14.047457 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7b87ee27-517b-40b4-a414-cae8b3215bfd&page=queryresults
[0m12:42:15.764053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e950d0>]}
[0m12:42:15.766294 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.47s]
[0m12:42:15.767339 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m12:42:15.768711 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dmart_user_book
[0m12:42:15.769538 [info ] [Thread-1 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m12:42:15.770186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m12:42:15.770654 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m12:42:15.777331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m12:42:15.778627 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m12:42:15.782365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m12:42:15.783757 [debug] [Thread-1 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(AVG(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY)), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented -- Tahun rilis buku tertua yang dipinjam oleh user

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date
    );
  
[0m12:42:15.784424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:16.290243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5ae397ce-f338-4ffd-a16d-613ec0415b77&page=queryresults
[0m12:42:18.536068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed224d11-d22d-40f2-bb54-6ad0a447f43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126adb8f0>]}
[0m12:42:18.537217 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model diego_dwh_library_marts.dmart_user_book  [[32mCREATE TABLE (16.0 rows, 2.1 KiB processed)[0m in 2.77s]
[0m12:42:18.538124 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m12:42:18.540739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:18.629015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:18.629296 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m12:42:18.629442 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m12:42:18.629566 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m12:42:18.629682 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m12:42:18.629893 [info ] [MainThread]: 
[0m12:42:18.630084 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.09 seconds (13.09s).
[0m12:42:18.630791 [debug] [MainThread]: Command end result
[0m12:42:18.642047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:42:18.647072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:42:18.651372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m12:42:18.651554 [info ] [MainThread]: 
[0m12:42:18.651752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:18.651891 [info ] [MainThread]: 
[0m12:42:18.652049 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:42:18.652391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.793405, "process_in_blocks": "0", "process_kernel_time": 0.46367, "process_mem_max_rss": "221118464", "process_out_blocks": "0", "process_user_time": 2.917428}
[0m12:42:18.652758 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:18.652716 after 14.79 seconds
[0m12:42:18.652963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112542240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124752450>]}
[0m12:42:18.653119 [debug] [MainThread]: Flushing usage events
[0m12:42:20.506391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:06.989932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c83b0>]}


============================== 12:53:06.992912 | 2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d ==============================
[0m12:53:06.992912 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:53:06.993257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:08.056954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6fbd70>]}
[0m12:53:08.080990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d9b80>]}
[0m12:53:08.081314 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:53:08.176511 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:53:08.237857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:08.238203 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m12:53:08.348003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbd5a90>]}
[0m12:53:08.377820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:53:08.379195 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:53:08.391207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb656d0>]}
[0m12:53:08.391448 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m12:53:08.391628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbbac60>]}
[0m12:53:08.392512 [info ] [MainThread]: 
[0m12:53:08.392714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:08.392853 [info ] [MainThread]: 
[0m12:53:08.393078 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:53:08.394923 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:53:08.395173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:08.395383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:53:08.395644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:53:08.395842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:08.395992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:10.732418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m12:53:10.733590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m12:53:10.734192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m12:53:10.734672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:10.735031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:10.735355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:11.224778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdf260>]}
[0m12:53:11.226245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:11.319495 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m12:53:11.319799 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m12:53:11.319996 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m12:53:11.320282 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m12:53:11.320545 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m12:53:11.320806 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m12:53:11.321199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m12:53:11.321384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m12:53:11.321545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_users)
[0m12:53:11.321718 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m12:53:11.321870 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m12:53:11.322010 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m12:53:11.331527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m12:53:11.333271 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m12:53:11.334985 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m12:53:11.335875 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m12:53:11.336061 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m12:53:11.336241 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m12:53:11.359814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:11.361190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:11.362660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:11.853182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m12:53:11.853727 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m12:53:11.854597 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m12:53:11.856062 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:53:11.856399 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m12:53:11.856722 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:53:12.159221 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5e5ae2c0-cfeb-4395-ad31-c521facb5c82&page=queryresults
[0m12:53:12.161671 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7829acdd-c6da-45a7-80a7-ffdc09e9ace5&page=queryresults
[0m12:53:12.163454 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:27e20448-15a3-4817-97ce-0e140e4a2f48&page=queryresults
[0m12:53:13.885060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f72bda0>]}
[0m12:53:13.885316 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc6ec30>]}
[0m12:53:13.885541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3ed7f0>]}
[0m12:53:13.885955 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.56s]
[0m12:53:13.886317 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.56s]
[0m12:53:13.886700 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.56s]
[0m12:53:13.887294 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m12:53:13.887605 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m12:53:13.887911 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m12:53:13.888444 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m12:53:13.888948 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m12:53:13.888764 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m12:53:13.889536 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m12:53:13.889235 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m12:53:13.889793 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m12:53:13.890018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m12:53:13.892454 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m12:53:13.892677 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m12:53:13.894811 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m12:53:13.895270 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m12:53:13.896682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:13.896897 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m12:53:13.898308 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:14.292812 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m12:53:14.295536 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m12:53:14.297836 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m12:53:14.298573 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m12:53:14.543891 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6673c911-97f6-442d-9134-f6a56af6f506&page=queryresults
[0m12:53:14.565089 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:421ea192-c9cc-4103-b80d-d0aba5f421cd&page=queryresults
[0m12:53:16.194871 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc8ea50>]}
[0m12:53:16.196780 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.30s]
[0m12:53:16.197841 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m12:53:16.482042 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c028470>]}
[0m12:53:16.482884 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.59s]
[0m12:53:16.483717 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m12:53:16.484945 [debug] [Thread-2 (]: Began running node model.dbt_dpd.fact_rents
[0m12:53:16.485469 [info ] [Thread-2 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m12:53:16.485991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.fact_rents)
[0m12:53:16.486527 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.fact_rents
[0m12:53:16.499372 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m12:53:16.500629 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.fact_rents
[0m12:53:16.503182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:16.862066 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m12:53:16.864855 [debug] [Thread-2 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m12:53:17.068297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c90e3cdd-f909-42a3-8775-c395a08730e8&page=queryresults
[0m12:53:18.799254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c08e870>]}
[0m12:53:18.800930 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.31s]
[0m12:53:18.801985 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.fact_rents
[0m12:53:18.803307 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m12:53:18.804066 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m12:53:18.804976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m12:53:18.805607 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m12:53:18.810743 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m12:53:18.811807 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m12:53:18.814685 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:19.295243 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m12:53:19.297548 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(GREATEST(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m12:53:19.583497 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:107434a7-7811-4441-a192-70cd08a8bb56&page=queryresults
[0m12:53:21.324281 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7c8e1c-4c09-40f9-bb9b-2c8c958fbc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bef8ef0>]}
[0m12:53:21.325971 [info ] [Thread-4 (]: 7 of 7 OK created sql incremental model diego_dwh_library_marts.dmart_user_book  [[32mCREATE TABLE (20.0 rows, 2.1 KiB processed)[0m in 2.52s]
[0m12:53:21.326980 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m12:53:21.329549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:21.417661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:21.417911 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m12:53:21.418051 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m12:53:21.418171 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m12:53:21.418288 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m12:53:21.418510 [info ] [MainThread]: 
[0m12:53:21.418684 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.03 seconds (13.03s).
[0m12:53:21.419400 [debug] [MainThread]: Command end result
[0m12:53:21.431127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:53:21.435311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:53:21.439578 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m12:53:21.439757 [info ] [MainThread]: 
[0m12:53:21.439958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:21.440100 [info ] [MainThread]: 
[0m12:53:21.440268 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:21.440733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.488693, "process_in_blocks": "0", "process_kernel_time": 0.45017, "process_mem_max_rss": "222740480", "process_out_blocks": "0", "process_user_time": 2.847084}
[0m12:53:21.441090 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:21.441046 after 14.49 seconds
[0m12:53:21.441515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4223f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034aee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3efa40>]}
[0m12:53:21.441736 [debug] [MainThread]: Flushing usage events
[0m12:53:23.633566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:35.123891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107020740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070201a0>]}


============================== 12:57:35.127012 | 63c37c40-06af-4618-bcd6-1c8ec9776dc7 ==============================
[0m12:57:35.127012 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:57:35.127367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:57:36.196648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12524d730>]}
[0m12:57:36.220506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125286ba0>]}
[0m12:57:36.220832 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:57:36.320165 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m12:57:36.383354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:36.383688 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m12:57:36.518696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263d2900>]}
[0m12:57:36.549896 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:57:36.551282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:57:36.564030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263854c0>]}
[0m12:57:36.564288 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m12:57:36.564469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261deb70>]}
[0m12:57:36.565408 [info ] [MainThread]: 
[0m12:57:36.565608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:36.565745 [info ] [MainThread]: 
[0m12:57:36.565977 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:36.568031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:57:36.568270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:36.568478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:57:36.568826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:36.569022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m12:57:36.643196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:37.853570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m12:57:37.854711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m12:57:37.855372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m12:57:37.855857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:37.856355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:37.856786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:38.361082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255153d0>]}
[0m12:57:38.362811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:38.458051 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m12:57:38.458343 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m12:57:38.458925 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m12:57:38.458696 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m12:57:38.459237 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m12:57:38.459622 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m12:57:38.459919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m12:57:38.460199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m12:57:38.460429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m12:57:38.460699 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m12:57:38.460884 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m12:57:38.461041 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m12:57:38.473479 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m12:57:38.475583 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m12:57:38.477432 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m12:57:38.478016 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m12:57:38.478201 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m12:57:38.478376 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m12:57:38.500808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:38.501121 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:38.502493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:39.007213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m12:57:39.008696 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m12:57:39.009070 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m12:57:39.010974 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:57:39.011296 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m12:57:39.012135 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m12:57:39.213311 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:beb9da69-0924-4a9d-82de-8b405fc7741f&page=queryresults
[0m12:57:39.256401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:74e5b010-1be6-42fe-b7e6-b89431c406a1&page=queryresults
[0m12:57:39.336682 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2c0c1abd-3bbc-4c93-be10-97f9cfe0c798&page=queryresults
[0m12:57:40.970125 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125499dc0>]}
[0m12:57:40.971182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125516300>]}
[0m12:57:40.973643 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.51s]
[0m12:57:40.975493 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m12:57:40.974127 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.51s]
[0m12:57:40.977741 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m12:57:40.978961 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m12:57:40.980358 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_books
[0m12:57:40.980036 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m12:57:40.981720 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m12:57:40.982246 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m12:57:40.980982 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m12:57:40.987462 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m12:57:40.988140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.dim_books)
[0m12:57:40.988867 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_books
[0m12:57:40.994873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m12:57:40.995325 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m12:57:40.998071 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:40.998333 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_books
[0m12:57:41.000135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:41.073290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126365700>]}
[0m12:57:41.134649 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.61s]
[0m12:57:41.137946 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m12:57:41.454423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m12:57:41.455907 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m12:57:41.457436 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m12:57:41.458096 [debug] [Thread-1 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m12:57:41.702510 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d27a8e99-0c25-4651-8007-a4a27dc945fc&page=queryresults
[0m12:57:41.704386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:faa637b1-a561-4899-904d-5adc5ef2ffb2&page=queryresults
[0m12:57:43.363013 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261a1d90>]}
[0m12:57:43.364740 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.38s]
[0m12:57:43.366923 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m12:57:43.379504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268a3f20>]}
[0m12:57:43.380545 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.39s]
[0m12:57:43.381333 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_books
[0m12:57:43.382680 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m12:57:43.383230 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m12:57:43.383758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m12:57:43.384194 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m12:57:43.392599 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m12:57:43.393692 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m12:57:43.396053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:43.770288 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m12:57:43.773624 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m12:57:43.996677 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7ead28f7-d109-41e3-9bee-1b4ff9ba4ad4&page=queryresults
[0m12:57:45.680053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268a1ee0>]}
[0m12:57:45.681826 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.30s]
[0m12:57:45.682820 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m12:57:45.689096 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m12:57:45.691012 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m12:57:45.692005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m12:57:45.692336 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m12:57:45.696190 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m12:57:45.696751 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m12:57:45.698816 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:46.143387 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m12:57:46.145797 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(ABS(DATE_DIFF(fact_rents.return_date, fact_rents.created_at, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m12:57:46.401267 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:14bbba47-59de-4495-b58d-0992c1d479f4&page=queryresults
[0m12:57:46.471729 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:14bbba47-59de-4495-b58d-0992c1d479f4&page=queryresults
[0m12:57:46.484197 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:57:46.485292 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c37c40-06af-4618-bcd6-1c8ec9776dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268185c0>]}
[0m12:57:46.486271 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.79s]
[0m12:57:46.487048 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m12:57:46.487999 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m12:57:46.490615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:46.571500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:46.571742 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m12:57:46.571883 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m12:57:46.572005 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m12:57:46.572127 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m12:57:46.572346 [info ] [MainThread]: 
[0m12:57:46.572529 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m12:57:46.573241 [debug] [MainThread]: Command end result
[0m12:57:46.584551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m12:57:46.587410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m12:57:46.593309 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m12:57:46.593484 [info ] [MainThread]: 
[0m12:57:46.593674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:57:46.593852 [info ] [MainThread]: 
[0m12:57:46.594067 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m12:57:46.594227 [info ] [MainThread]: 
[0m12:57:46.594407 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:57:46.594999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.511016, "process_in_blocks": "0", "process_kernel_time": 0.481084, "process_mem_max_rss": "217890816", "process_out_blocks": "0", "process_user_time": 2.84046}
[0m12:57:46.595427 [debug] [MainThread]: Command `dbt run` failed at 12:57:46.595388 after 11.51 seconds
[0m12:57:46.595720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252b0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb9eb0>]}
[0m12:57:46.595877 [debug] [MainThread]: Flushing usage events
[0m12:57:49.223008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:36.997060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f3bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11416a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c8350>]}


============================== 13:01:37.000690 | a8a612d5-9f83-420f-bdcb-50d5be8aed6e ==============================
[0m13:01:37.000690 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:01:37.001033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m13:01:38.012969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185a2a0>]}
[0m13:01:38.037449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f38980>]}
[0m13:01:38.037802 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:01:38.131109 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:01:38.192256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:38.192574 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m13:01:38.300327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ead2ba0>]}
[0m13:01:38.330110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:01:38.331511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:01:38.343491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea85820>]}
[0m13:01:38.343738 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:01:38.343919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eaa90d0>]}
[0m13:01:38.344804 [info ] [MainThread]: 
[0m13:01:38.344995 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:38.345134 [info ] [MainThread]: 
[0m13:01:38.345366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:38.347209 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:01:38.347423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:38.347626 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:01:38.347893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:01:38.348095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:38.348249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:41.797081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m13:01:41.797978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m13:01:41.798590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:41.799157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m13:01:41.799850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:41.800954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:42.282284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e84ecc0>]}
[0m13:01:42.283156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:42.368346 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m13:01:42.368584 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m13:01:42.368768 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m13:01:42.369017 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m13:01:42.369305 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m13:01:42.369544 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m13:01:42.369761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_books)
[0m13:01:42.369929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_rents)
[0m13:01:42.370079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_users)
[0m13:01:42.370234 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m13:01:42.370376 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m13:01:42.370512 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m13:01:42.377654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m13:01:42.379317 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m13:01:42.380918 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m13:01:42.382060 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m13:01:42.382232 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m13:01:42.382375 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m13:01:42.409570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:42.410829 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:01:42.411215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:01:43.016810 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m13:01:43.017392 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m13:01:43.018325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m13:01:43.019150 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:01:43.019447 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:01:43.019716 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:01:43.317480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6b5cd88e-a63e-4152-8761-8199ce52f9e4&page=queryresults
[0m13:01:43.318703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7b02756b-98d7-4e30-a4ce-468aeffbff33&page=queryresults
[0m13:01:43.344235 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c4a3fb9e-12e7-494e-9e97-4309daa618e4&page=queryresults
[0m13:01:45.107738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb6e510>]}
[0m13:01:45.108151 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e22f9e0>]}
[0m13:01:45.110472 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.73s]
[0m13:01:45.111553 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m13:01:45.110970 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.73s]
[0m13:01:45.112398 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m13:01:45.113032 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m13:01:45.113316 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m13:01:45.113688 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m13:01:45.113914 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:01:45.119187 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:01:45.119937 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m13:01:45.122861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:01:45.393501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e85f8c0>]}
[0m13:01:45.394852 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.02s]
[0m13:01:45.395700 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m13:01:45.396409 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m13:01:45.397031 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m13:01:45.397580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m13:01:45.398006 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:01:45.403739 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:01:45.404606 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m13:01:45.407092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:01:45.491610 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:01:45.492326 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m13:01:45.777793 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:01:45.780352 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m13:01:45.781317 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b440de37-a688-4b5c-b4aa-2e335985d9e3&page=queryresults
[0m13:01:46.073234 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9253e75f-79db-41a6-8617-29e97bb0f762&page=queryresults
[0m13:01:47.522366 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef07b30>]}
[0m13:01:47.524332 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.41s]
[0m13:01:47.525688 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m13:01:47.670598 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e515f10>]}
[0m13:01:47.671808 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.27s]
[0m13:01:47.672718 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m13:01:47.674086 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m13:01:47.674854 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m13:01:47.675522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m13:01:47.676055 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:01:47.683080 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:01:47.684158 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:01:47.686680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:48.179043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:01:48.180798 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:01:48.434793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:16d1ee3e-9ccf-4bfc-8149-04f63c7dd175&page=queryresults
[0m13:01:50.105513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eecba10>]}
[0m13:01:50.107913 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.43s]
[0m13:01:50.108715 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:01:50.110065 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:01:50.110903 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m13:01:50.111431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m13:01:50.111809 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:01:50.117971 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:01:50.119314 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:01:50.123006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:01:50.484899 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:01:50.487412 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(ABS(DATE_DIFF(fact_rents.rent_date, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m13:01:50.749838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dc1a534c-0891-4a02-8783-e4f1f0c054c0&page=queryresults
[0m13:01:50.850597 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dc1a534c-0891-4a02-8783-e4f1f0c054c0&page=queryresults
[0m13:01:50.865320 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:01:50.866130 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8a612d5-9f83-420f-bdcb-50d5be8aed6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13efb5dc0>]}
[0m13:01:50.867376 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.75s]
[0m13:01:50.868235 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:01:50.869116 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m13:01:50.872049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:50.952853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:50.953069 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:01:50.953205 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m13:01:50.953326 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m13:01:50.953441 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:01:50.953635 [info ] [MainThread]: 
[0m13:01:50.953815 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m13:01:50.954518 [debug] [MainThread]: Command end result
[0m13:01:50.969552 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:01:50.971200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:01:50.974819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:01:50.974996 [info ] [MainThread]: 
[0m13:01:50.975181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:01:50.975340 [info ] [MainThread]: 
[0m13:01:50.975558 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:01:50.975722 [info ] [MainThread]: 
[0m13:01:50.975897 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:01:50.976228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.016716, "process_in_blocks": "0", "process_kernel_time": 0.426326, "process_mem_max_rss": "222920704", "process_out_blocks": "0", "process_user_time": 2.856951}
[0m13:01:50.976547 [debug] [MainThread]: Command `dbt run` failed at 13:01:50.976511 after 14.02 seconds
[0m13:01:50.976749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e859550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11400acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e515f10>]}
[0m13:01:50.976906 [debug] [MainThread]: Flushing usage events
[0m13:01:53.238070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:36.496692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c8470>]}


============================== 13:02:36.499936 | 0f4a8283-a9da-49b2-afdf-975cbb6b1988 ==============================
[0m13:02:36.499936 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:02:36.500280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:37.509728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116945f0>]}
[0m13:02:37.533570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e08b60>]}
[0m13:02:37.533911 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:02:37.629636 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:02:37.698011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:37.698388 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m13:02:37.821120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274d2990>]}
[0m13:02:37.852380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:02:37.853820 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:02:37.868656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127485550>]}
[0m13:02:37.868920 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:02:37.869101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274d3c20>]}
[0m13:02:37.869982 [info ] [MainThread]: 
[0m13:02:37.870172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:37.870312 [info ] [MainThread]: 
[0m13:02:37.870544 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:02:37.872397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:02:37.872633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:37.872830 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:02:37.873108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:02:37.873316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:37.873495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:39.294980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m13:02:39.296273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m13:02:39.297068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m13:02:39.297605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:39.298351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:39.299345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:39.811888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274baa80>]}
[0m13:02:39.813290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:39.912599 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m13:02:39.912894 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m13:02:39.913122 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m13:02:39.913477 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m13:02:39.913759 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m13:02:39.914037 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m13:02:39.914322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m13:02:39.914519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m13:02:39.914689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m13:02:39.914862 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m13:02:39.915014 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m13:02:39.915485 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m13:02:39.923969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m13:02:39.925975 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m13:02:39.928075 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m13:02:39.928667 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m13:02:39.928872 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m13:02:39.929056 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m13:02:39.956154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:39.956944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:39.958205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:40.946473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m13:02:40.947354 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m13:02:40.948570 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:02:40.948833 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:02:41.298202 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m13:02:41.300994 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:02:42.157964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a307e7b0-0ba6-4819-a1aa-39f02a580b83&page=queryresults
[0m13:02:42.453605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d7bd3244-4506-4fa4-8e18-3e04a5a88d03&page=queryresults
[0m13:02:42.878256 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:774c95c1-fd38-4ecd-94dd-d3ad67b617aa&page=queryresults
[0m13:02:46.672920 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d2f9b0>]}
[0m13:02:46.674057 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 6.76s]
[0m13:02:46.674693 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m13:02:46.675633 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m13:02:46.676137 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m13:02:46.676656 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m13:02:46.676961 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:02:46.681183 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:02:46.682154 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m13:02:46.684594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:02:46.760341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275dbc50>]}
[0m13:02:46.760687 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 6.85s]
[0m13:02:46.760983 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m13:02:46.761295 [debug] [Thread-3 (]: Began running node model.dbt_dpd.dim_books
[0m13:02:46.761539 [info ] [Thread-3 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m13:02:46.761752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.dim_books)
[0m13:02:46.761963 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:02:46.763834 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:02:46.764222 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.dim_books
[0m13:02:46.765502 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:47.876978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275ce240>]}
[0m13:02:47.879128 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 7.96s]
[0m13:02:47.880086 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m13:02:48.415360 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:02:48.416646 [debug] [Thread-3 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m13:02:48.469685 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:02:48.470372 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m13:02:48.808093 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:84ca2d4d-018a-4945-b2f9-4a0535225c7d&page=queryresults
[0m13:02:48.810045 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:244fc275-9b0c-47a3-b960-9611a7a92251&page=queryresults
[0m13:02:50.839924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d274a0>]}
[0m13:02:50.841657 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 4.16s]
[0m13:02:50.842709 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m13:02:51.106421 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d9ed80>]}
[0m13:02:51.106929 [info ] [Thread-3 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 4.34s]
[0m13:02:51.107295 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.dim_books
[0m13:02:51.110895 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m13:02:51.111375 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m13:02:51.111753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_books, now model.dbt_dpd.fact_rents)
[0m13:02:51.112054 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:02:51.120166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:02:51.121033 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:02:51.123256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:51.525596 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:02:51.527995 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:02:51.767960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0f990c96-cbfa-43ff-b3f8-54253e1b26dd&page=queryresults
[0m13:02:53.811823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ccab40>]}
[0m13:02:53.813456 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.70s]
[0m13:02:53.814384 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:02:53.816128 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:02:53.817053 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m13:02:53.817748 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m13:02:53.818306 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:02:53.824456 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:02:53.825636 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:02:53.829186 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:54.304470 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:02:54.307166 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(ABS(DATE_DIFF(fact_rents.created_at, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m13:02:54.636333 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2f32d3d3-383b-453f-9bfe-9621a1a178b6&page=queryresults
[0m13:02:54.718027 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2f32d3d3-383b-453f-9bfe-9621a1a178b6&page=queryresults
[0m13:02:54.734210 [debug] [Thread-4 (]: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:02:54.735323 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f4a8283-a9da-49b2-afdf-975cbb6b1988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273de3c0>]}
[0m13:02:54.736237 [error] [Thread-4 (]: 7 of 7 ERROR creating sql incremental model diego_dwh_library_marts.dmart_user_book  [[31mERROR[0m in 0.92s]
[0m13:02:54.737016 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:02:54.737835 [debug] [Thread-7 (]: Marking all children of 'model.dbt_dpd.dmart_user_book' to be skipped because of status 'error'.  Reason: Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql.
[0m13:02:54.740693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:54.824313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:54.824539 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:02:54.824672 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_rents' was properly closed.
[0m13:02:54.824792 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m13:02:54.824903 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:02:54.825100 [info ] [MainThread]: 
[0m13:02:54.825285 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 16.95 seconds (16.95s).
[0m13:02:54.825987 [debug] [MainThread]: Command end result
[0m13:02:54.838458 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:02:54.840492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:02:54.844368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:02:54.844565 [info ] [MainThread]: 
[0m13:02:54.844761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:02:54.844915 [info ] [MainThread]: 
[0m13:02:54.845107 [error] [MainThread]:   Database Error in model dmart_user_book (models/datamart/dmart_user_book.sql)
  No matching signature for function ABS
    Argument types: INT64, INT64
    Signature: ABS(INT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(FLOAT64)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(NUMERIC)
      Signature accepts at most 1 argument, found 2 arguments
    Signature: ABS(BIGNUMERIC)
      Signature accepts at most 1 argument, found 2 arguments at [36:23]
  compiled code at target/run/dbt_dpd/models/datamart/dmart_user_book.sql
[0m13:02:54.845264 [info ] [MainThread]: 
[0m13:02:54.845426 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:02:54.845784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 18.387789, "process_in_blocks": "0", "process_kernel_time": 0.428164, "process_mem_max_rss": "217907200", "process_out_blocks": "0", "process_user_time": 2.836562}
[0m13:02:54.846099 [debug] [MainThread]: Command `dbt run` failed at 13:02:54.846059 after 18.39 seconds
[0m13:02:54.846327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bcbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127597290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274b9bb0>]}
[0m13:02:54.846503 [debug] [MainThread]: Flushing usage events
[0m13:02:56.225826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:39.951379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109018680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090180e0>]}


============================== 13:03:39.954888 | 49cba1c3-37a8-4b86-b488-4c5a57048e2e ==============================
[0m13:03:39.954888 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:03:39.955282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:03:41.026228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084aa1b0>]}
[0m13:03:41.050395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084dfce0>]}
[0m13:03:41.050729 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:03:41.145961 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:03:41.207985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:03:41.208308 [debug] [MainThread]: Partial parsing: updated file: dbt_dpd://models/datamart/dmart_user_book.sql
[0m13:03:41.318530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154d24b0>]}
[0m13:03:41.351482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:03:41.352893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:03:41.366813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115480d10>]}
[0m13:03:41.367061 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:03:41.367253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b0ec0>]}
[0m13:03:41.368140 [info ] [MainThread]: 
[0m13:03:41.368336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:41.368475 [info ] [MainThread]: 
[0m13:03:41.368706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:03:41.370558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:03:41.370782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:41.370984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:03:41.371242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:03:41.371435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:41.371573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:43.091493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m13:03:43.092923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m13:03:43.093697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_staging)
[0m13:03:43.094088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:43.094532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:43.095082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:43.625310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150162a0>]}
[0m13:03:43.627578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:43.716581 [debug] [Thread-1 (]: Began running node model.dbt_dpd.staging_books
[0m13:03:43.716859 [debug] [Thread-2 (]: Began running node model.dbt_dpd.staging_rents
[0m13:03:43.717072 [debug] [Thread-3 (]: Began running node model.dbt_dpd.staging_users
[0m13:03:43.717371 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_staging.staging_books ..... [RUN]
[0m13:03:43.717691 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_staging.staging_rents ..... [RUN]
[0m13:03:43.717963 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_staging.staging_users ..... [RUN]
[0m13:03:43.718220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.staging_books)
[0m13:03:43.718396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.staging_rents)
[0m13:03:43.718552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_staging, now model.dbt_dpd.staging_users)
[0m13:03:43.718718 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.staging_books
[0m13:03:43.718870 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.staging_rents
[0m13:03:43.719010 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.staging_users
[0m13:03:43.726911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.staging_books"
[0m13:03:43.728620 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.staging_rents"
[0m13:03:43.730259 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.staging_users"
[0m13:03:43.730764 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.staging_rents
[0m13:03:43.730956 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.staging_books
[0m13:03:43.731107 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.staging_users
[0m13:03:43.765870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:43.766426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:43.767186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:03:44.299888 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.staging_books"
[0m13:03:44.300313 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.staging_rents"
[0m13:03:44.300600 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.staging_users"
[0m13:03:44.301568 [debug] [Thread-1 (]: On model.dbt_dpd.staging_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:03:44.301919 [debug] [Thread-2 (]: On model.dbt_dpd.staging_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:03:44.302206 [debug] [Thread-3 (]: On model.dbt_dpd.staging_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.staging_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_staging`.`staging_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:03:44.522392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5c80d906-dbae-4107-87f4-1aa8b060a1eb&page=queryresults
[0m13:03:44.525344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:292e1bfa-9d38-45c7-a7f0-56ce2af62358&page=queryresults
[0m13:03:44.556288 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fcb774c9-ce8b-4a2f-945e-a40a841941c6&page=queryresults
[0m13:03:46.255621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d2fc20>]}
[0m13:03:46.256064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11559c890>]}
[0m13:03:46.256745 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_staging.staging_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.53s]
[0m13:03:46.257276 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_staging.staging_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 2.53s]
[0m13:03:46.257764 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.staging_books
[0m13:03:46.258148 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.staging_rents
[0m13:03:46.258844 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m13:03:46.259194 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m13:03:46.259554 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m13:03:46.259789 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:03:46.262992 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:03:46.263532 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m13:03:46.265548 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:03:46.489325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ee0d40>]}
[0m13:03:46.489848 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_staging.staging_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.77s]
[0m13:03:46.490263 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.staging_users
[0m13:03:46.490676 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_users
[0m13:03:46.491054 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m13:03:46.491399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_rents, now model.dbt_dpd.dim_users)
[0m13:03:46.491656 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:03:46.494776 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:03:46.495999 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_users
[0m13:03:46.499602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:46.709279 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:03:46.711229 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_books` 
)

SELECT * FROM books

    );
  
[0m13:03:46.970321 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:03:46.972182 [debug] [Thread-2 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_users`
)

SELECT * FROM source

    );
  
[0m13:03:47.048265 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1f3261f8-6ad3-43d6-adb8-acdf8cc36895&page=queryresults
[0m13:03:47.186945 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:994e6b3c-cb88-4b03-8056-13de90a0f060&page=queryresults
[0m13:03:48.855766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207ecbf0>]}
[0m13:03:48.858690 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.36s]
[0m13:03:48.859812 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_users
[0m13:03:48.945476 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12077c7d0>]}
[0m13:03:48.946324 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.69s]
[0m13:03:48.947034 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m13:03:48.947910 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m13:03:48.948371 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m13:03:48.948690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.staging_users, now model.dbt_dpd.fact_rents)
[0m13:03:48.948946 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:03:48.952804 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:03:48.953373 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:03:48.956456 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:03:49.285120 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:03:49.287380 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_staging`.`staging_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:03:49.503322 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:50d96fd1-34ef-4520-953b-3f9c17436dbf&page=queryresults
[0m13:03:51.159811 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125099010>]}
[0m13:03:51.162040 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.21s]
[0m13:03:51.163280 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:03:51.164702 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:03:51.167160 [info ] [Thread-2 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m13:03:51.168343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m13:03:51.169190 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:03:51.175364 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:03:51.177023 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:03:51.180259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:51.531126 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:03:51.534985 [debug] [Thread-2 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(GREATEST(DATE_DIFF(fact_rents.created_at, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m13:03:51.747683 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f82f1649-abd5-41f3-8052-4cc0010b8a86&page=queryresults
[0m13:03:53.674298 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49cba1c3-37a8-4b86-b488-4c5a57048e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125099250>]}
[0m13:03:53.675293 [info ] [Thread-2 (]: 7 of 7 OK created sql incremental model diego_dwh_library_marts.dmart_user_book  [[32mCREATE TABLE (20.0 rows, 2.1 KiB processed)[0m in 2.51s]
[0m13:03:53.675874 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:03:53.677551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:53.754027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:53.754275 [debug] [MainThread]: Connection 'model.dbt_dpd.staging_books' was properly closed.
[0m13:03:53.754415 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:03:53.754547 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:03:53.754663 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m13:03:53.754895 [info ] [MainThread]: 
[0m13:03:53.755074 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m13:03:53.755799 [debug] [MainThread]: Command end result
[0m13:03:53.767475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:03:53.769122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:03:53.774363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:03:53.774542 [info ] [MainThread]: 
[0m13:03:53.774734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:53.774902 [info ] [MainThread]: 
[0m13:03:53.775215 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:03:53.776584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.866149, "process_in_blocks": "0", "process_kernel_time": 0.467744, "process_mem_max_rss": "221675520", "process_out_blocks": "0", "process_user_time": 2.894787}
[0m13:03:53.777079 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:53.776998 after 13.87 seconds
[0m13:03:53.777395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154d3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f2600>]}
[0m13:03:53.777617 [debug] [MainThread]: Flushing usage events
[0m13:03:55.978145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:13.573446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218c4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218c43b0>]}


============================== 13:18:13.576659 | d9f8f144-0860-42e1-b527-426f75836cfc ==============================
[0m13:18:13.576659 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:18:13.576997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m13:18:14.657830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207297c0>]}
[0m13:18:14.687239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134af16a0>]}
[0m13:18:14.687712 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:18:14.786075 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:18:14.824144 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:18:14.824409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ad9580>]}
[0m13:18:15.328564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13561ef30>]}
[0m13:18:15.358881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:18:15.360239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:18:15.372430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355ff080>]}
[0m13:18:15.372664 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:18:15.372837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135638bf0>]}
[0m13:18:15.373723 [info ] [MainThread]: 
[0m13:18:15.373984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:15.374155 [info ] [MainThread]: 
[0m13:18:15.374396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:15.376225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:18:15.376453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:15.376720 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:18:15.377020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:18:15.377235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:15.377397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:16.672066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_diego_dwh_library_preparation)
[0m13:18:16.674461 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "diego_dwh_library_preparation"
"
[0m13:18:16.689472 [debug] [ThreadPool]: On create_purwadika_diego_dwh_library_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "connection_name": "create_purwadika_diego_dwh_library_preparation"} */
create schema if not exists `purwadika`.`diego_dwh_library_preparation`
  
[0m13:18:16.690084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:17.166624 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a0a7a52e-7ba1-48c3-8560-7551b1b4f6a9&page=queryresults
[0m13:18:20.083514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m13:18:20.084140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_diego_dwh_library_preparation, now list_purwadika_diego_dwh_library_preparation)
[0m13:18:20.084451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:20.084766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m13:18:20.085084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:20.158326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:20.782351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134952720>]}
[0m13:18:20.784140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:20.878232 [debug] [Thread-1 (]: Began running node model.dbt_dpd.prep_books
[0m13:18:20.878518 [debug] [Thread-2 (]: Began running node model.dbt_dpd.prep_rents
[0m13:18:20.878711 [debug] [Thread-3 (]: Began running node model.dbt_dpd.prep_users
[0m13:18:20.878996 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_preparation.prep_books .... [RUN]
[0m13:18:20.879275 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_preparation.prep_rents .... [RUN]
[0m13:18:20.879500 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_preparation.prep_users .... [RUN]
[0m13:18:20.879720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.prep_books)
[0m13:18:20.879884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_preparation, now model.dbt_dpd.prep_rents)
[0m13:18:20.880038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.prep_users)
[0m13:18:20.880205 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.prep_books
[0m13:18:20.880357 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.prep_rents
[0m13:18:20.880495 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.prep_users
[0m13:18:20.885510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.prep_books"
[0m13:18:20.887811 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.prep_rents"
[0m13:18:20.889766 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.prep_users"
[0m13:18:20.890639 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.prep_users
[0m13:18:20.890868 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.prep_rents
[0m13:18:20.891045 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.prep_books
[0m13:18:20.942411 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.prep_users"
[0m13:18:20.944696 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.prep_rents"
[0m13:18:20.946124 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.prep_books"
[0m13:18:20.947218 [debug] [Thread-2 (]: On model.dbt_dpd.prep_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:18:20.947456 [debug] [Thread-1 (]: On model.dbt_dpd.prep_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:18:20.947674 [debug] [Thread-3 (]: On model.dbt_dpd.prep_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:18:20.947896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:18:20.948099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:20.948260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:18:21.995341 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ab319693-6417-4e1f-9a50-53e2dba52b83&page=queryresults
[0m13:18:21.997353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b55f72a5-e098-4bbc-a2d4-10c8fbe709c9&page=queryresults
[0m13:18:21.999270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ca14bcac-6e69-4312-94f6-36e41dad0ddc&page=queryresults
[0m13:18:24.005131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffeea0>]}
[0m13:18:24.005390 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ae1f40>]}
[0m13:18:24.005758 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.12s]
[0m13:18:24.006114 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.12s]
[0m13:18:24.006718 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.prep_users
[0m13:18:24.006994 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.prep_rents
[0m13:18:24.007356 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_users
[0m13:18:24.007597 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m13:18:24.007933 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_users'
[0m13:18:24.008118 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:18:24.010209 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:18:24.010807 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_users
[0m13:18:24.012189 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:18:24.091341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135623620>]}
[0m13:18:24.091737 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.21s]
[0m13:18:24.092058 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.prep_books
[0m13:18:24.092367 [debug] [Thread-2 (]: Began running node model.dbt_dpd.dim_books
[0m13:18:24.092629 [info ] [Thread-2 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m13:18:24.092871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.prep_rents, now model.dbt_dpd.dim_books)
[0m13:18:24.093036 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:18:24.095025 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:18:24.096765 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.dim_books
[0m13:18:24.098199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:18:24.410028 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:18:24.412416 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:18:24.414713 [debug] [Thread-4 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_users`
)

SELECT * FROM source

    );
  
[0m13:18:24.415364 [debug] [Thread-2 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_books` 
)

SELECT * FROM books

    );
  
[0m13:18:24.667379 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a62d1e11-7663-48f8-9af3-26983ce8ef6b&page=queryresults
[0m13:18:24.681554 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:653fa88c-2da6-4c8a-b373-76d7702a975e&page=queryresults
[0m13:18:26.310773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b08440>]}
[0m13:18:26.311175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135451550>]}
[0m13:18:26.311914 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.30s]
[0m13:18:26.312316 [info ] [Thread-2 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.22s]
[0m13:18:26.312690 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_users
[0m13:18:26.312962 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.dim_books
[0m13:18:26.313743 [debug] [Thread-1 (]: Began running node model.dbt_dpd.fact_rents
[0m13:18:26.313992 [info ] [Thread-1 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m13:18:26.314219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.prep_books, now model.dbt_dpd.fact_rents)
[0m13:18:26.314391 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:18:26.324333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:18:26.325048 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:18:26.326962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:26.736960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:18:26.738793 [debug] [Thread-1 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:18:27.015271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:005ddfc9-956d-4d97-aa28-85ada2517c1a&page=queryresults
[0m13:18:28.826552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135450bc0>]}
[0m13:18:28.829170 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.51s]
[0m13:18:28.829963 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:18:28.832221 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:18:28.833174 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m13:18:28.833944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_users, now model.dbt_dpd.dmart_user_book)
[0m13:18:28.834444 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:18:28.843639 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:18:28.844296 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:18:28.846482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:18:29.192122 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:18:29.195481 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(GREATEST(DATE_DIFF(fact_rents.created_at, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m13:18:29.429725 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c5e15ac2-644a-404b-a0ef-e5193bc6cbf8&page=queryresults
[0m13:18:31.103895 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9f8f144-0860-42e1-b527-426f75836cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ff13d0>]}
[0m13:18:31.110564 [info ] [Thread-4 (]: 7 of 7 OK created sql incremental model diego_dwh_library_marts.dmart_user_book  [[32mCREATE TABLE (20.0 rows, 2.1 KiB processed)[0m in 2.27s]
[0m13:18:31.111281 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:18:31.115455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:31.194552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:31.194800 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:18:31.194939 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_books' was properly closed.
[0m13:18:31.195063 [debug] [MainThread]: Connection 'model.dbt_dpd.prep_users' was properly closed.
[0m13:18:31.195176 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:18:31.195413 [info ] [MainThread]: 
[0m13:18:31.195613 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 15.82 seconds (15.82s).
[0m13:18:31.196305 [debug] [MainThread]: Command end result
[0m13:18:31.207073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:18:31.210125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:18:31.216230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:18:31.216393 [info ] [MainThread]: 
[0m13:18:31.216588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:31.216738 [info ] [MainThread]: 
[0m13:18:31.216902 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:18:31.217310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.682106, "process_in_blocks": "0", "process_kernel_time": 0.528699, "process_mem_max_rss": "221102080", "process_out_blocks": "0", "process_user_time": 3.345861}
[0m13:18:31.217680 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:31.217642 after 17.68 seconds
[0m13:18:31.217907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135541520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201b9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ead520>]}
[0m13:18:31.218060 [debug] [MainThread]: Flushing usage events
[0m13:18:33.146856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:17.576574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113505af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ec8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ec8290>]}


============================== 13:50:17.579834 | cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296 ==============================
[0m13:50:17.579834 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:17.580201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:18.737779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e962a0>]}
[0m13:50:18.762599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c7bf20>]}
[0m13:50:18.762957 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:50:18.860769 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:50:18.940669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:18.940957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:18.956765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b98ef0>]}
[0m13:50:18.988067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:50:18.989366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:50:19.002770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131db2de0>]}
[0m13:50:19.003019 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:50:19.003198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd5c6d9-9fc6-47f9-a11b-5eb64fb4b296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c10320>]}
[0m13:50:19.004129 [info ] [MainThread]: 
[0m13:50:19.004311 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:19.004446 [info ] [MainThread]: 
[0m13:50:19.004682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:50:19.006503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:50:19.006729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:50:19.006998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:19.007195 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:50:19.007374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:19.007595 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:50:19.007729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:19.007891 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:50:19.008158 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:50:19.008477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:19.008742 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:50:19.008928 [info ] [MainThread]: 
[0m13:50:19.009097 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:50:19.009873 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/usr/app/dbt/credentials.json'
[0m13:50:19.010122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4738262, "process_in_blocks": "0", "process_kernel_time": 0.380026, "process_mem_max_rss": "211992576", "process_out_blocks": "0", "process_user_time": 1.376875}
[0m13:50:19.010379 [debug] [MainThread]: Command `dbt run` failed at 13:50:19.010332 after 1.47 seconds
[0m13:50:19.010551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e41fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131adf140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132b73fb0>]}
[0m13:50:19.010712 [debug] [MainThread]: Flushing usage events
[0m13:50:20.659638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:54.144212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dc5c0>]}


============================== 13:50:54.148368 | 9509735a-df12-4be1-932e-76f3e0a10cb0 ==============================
[0m13:50:54.148368 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:50:54.149697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target preparation', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:54.152180 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_dpd' does not have a target named 'preparation'. The valid target names for this profile are:
   - dev
[0m13:50:54.153865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.056355126, "process_in_blocks": "0", "process_kernel_time": 0.129547, "process_mem_max_rss": "95715328", "process_out_blocks": "0", "process_user_time": 0.622933}
[0m13:50:54.154260 [debug] [MainThread]: Command `dbt run` failed at 13:50:54.154199 after 0.06 seconds
[0m13:50:54.154463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885a240>]}
[0m13:50:54.154654 [debug] [MainThread]: Flushing usage events
[0m13:50:55.225056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:13.070550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104868920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104868470>]}


============================== 13:51:13.073526 | 7a4f073e-3501-4e0f-95e0-a48c870dbdc3 ==============================
[0m13:51:13.073526 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:51:13.073850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --target dev', 'send_anonymous_usage_stats': 'True'}
[0m13:51:14.161365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a4f073e-3501-4e0f-95e0-a48c870dbdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cfa2a0>]}
[0m13:51:14.187704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a4f073e-3501-4e0f-95e0-a48c870dbdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c95e0>]}
[0m13:51:14.188085 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:51:14.294096 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:51:14.356718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:14.356959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:14.371729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4f073e-3501-4e0f-95e0-a48c870dbdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110533f50>]}
[0m13:51:14.403057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:51:14.404302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:51:14.417434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4f073e-3501-4e0f-95e0-a48c870dbdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b5fd0>]}
[0m13:51:14.417719 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:51:14.417910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4f073e-3501-4e0f-95e0-a48c870dbdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110198b30>]}
[0m13:51:14.418819 [info ] [MainThread]: 
[0m13:51:14.419014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:14.419154 [info ] [MainThread]: 
[0m13:51:14.419395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:51:14.421315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:51:14.421534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:14.421729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:51:14.422071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:51:14.422307 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:51:14.422448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:14.422594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:14.422876 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:51:14.423042 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:51:14.423318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:14.423468 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/usr/app/dbt/credentials.json''
[0m13:51:14.423629 [info ] [MainThread]: 
[0m13:51:14.423775 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:51:14.424713 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/usr/app/dbt/credentials.json'
[0m13:51:14.424989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3887662, "process_in_blocks": "0", "process_kernel_time": 0.325577, "process_mem_max_rss": "214581248", "process_out_blocks": "0", "process_user_time": 1.293938}
[0m13:51:14.425283 [debug] [MainThread]: Command `dbt run` failed at 13:51:14.425231 after 1.39 seconds
[0m13:51:14.425474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110553e00>]}
[0m13:51:14.425656 [debug] [MainThread]: Flushing usage events
[0m13:51:15.758310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:58.973299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105301220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe4440>]}


============================== 13:51:58.982962 | 4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a ==============================
[0m13:51:58.982962 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:51:58.984789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:00.067661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084762a0>]}
[0m13:52:00.091608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084762a0>]}
[0m13:52:00.091938 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:52:00.195914 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:52:00.258085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:00.258301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:00.272934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b011700>]}
[0m13:52:00.305393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:52:00.306601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:52:00.320052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b37f470>]}
[0m13:52:00.320339 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:52:00.320523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e05223a-c9a5-4baf-96ec-e4bf9c6ae92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828baa0>]}
[0m13:52:00.321511 [info ] [MainThread]: 
[0m13:52:00.321700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:00.321836 [info ] [MainThread]: 
[0m13:52:00.322075 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:52:00.324076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:00.324322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:00.324539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:00.324887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:00.325114 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:00.325281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:00.325438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:00.325800 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:00.325985 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:00.326309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:00.326492 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:00.326749 [info ] [MainThread]: 
[0m13:52:00.327727 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:52:00.328698 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/root/.dbt/credentials.json'
[0m13:52:00.328974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4057522, "process_in_blocks": "0", "process_kernel_time": 0.344643, "process_mem_max_rss": "212860928", "process_out_blocks": "0", "process_user_time": 1.310132}
[0m13:52:00.329254 [debug] [MainThread]: Command `dbt run` failed at 13:52:00.329204 after 1.41 seconds
[0m13:52:00.329434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b36fcb0>]}
[0m13:52:00.329596 [debug] [MainThread]: Flushing usage events
[0m13:52:01.971514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:18.787400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104614890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046143e0>]}


============================== 13:52:18.790261 | 51ea627a-760d-4faf-9350-de08854cfd0c ==============================
[0m13:52:18.790261 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:52:18.790744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'debug': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:52:19.839029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51ea627a-760d-4faf-9350-de08854cfd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa6120>]}
[0m13:52:19.865172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51ea627a-760d-4faf-9350-de08854cfd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11302db20>]}
[0m13:52:19.865861 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:52:19.964402 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:52:20.024668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:20.024952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:20.045487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51ea627a-760d-4faf-9350-de08854cfd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113123b90>]}
[0m13:52:20.085879 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:52:20.087489 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:52:20.099331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51ea627a-760d-4faf-9350-de08854cfd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b5d30>]}
[0m13:52:20.099742 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:52:20.099944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ea627a-760d-4faf-9350-de08854cfd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134900e0>]}
[0m13:52:20.100881 [info ] [MainThread]: 
[0m13:52:20.101073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:20.101209 [info ] [MainThread]: 
[0m13:52:20.101460 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:52:20.103366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:20.103578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:20.103780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:20.104104 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:20.104296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:52:20.104435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:20.104693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:20.104904 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:20.105130 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:20.105313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:20.105469 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/root/.dbt/credentials.json''
[0m13:52:20.105656 [info ] [MainThread]: 
[0m13:52:20.105811 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:52:20.106665 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/root/.dbt/credentials.json'
[0m13:52:20.106942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3578418, "process_in_blocks": "0", "process_kernel_time": 0.345594, "process_mem_max_rss": "209911808", "process_out_blocks": "0", "process_user_time": 1.349052}
[0m13:52:20.107232 [debug] [MainThread]: Command `dbt run` failed at 13:52:20.107188 after 1.36 seconds
[0m13:52:20.107409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104443950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130dd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113084050>]}
[0m13:52:20.107560 [debug] [MainThread]: Flushing usage events
[0m13:52:21.162575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:43.301670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e39f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec8290>]}


============================== 13:53:43.304749 | ac39509a-0703-4692-b95c-99eadb2fb902 ==============================
[0m13:53:43.304749 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:53:43.305109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target prep_books', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:43.306856 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_dpd' does not have a target named 'prep_books'. The valid target names for this profile are:
   - dev
[0m13:53:43.308105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04845729, "process_in_blocks": "0", "process_kernel_time": 0.129981, "process_mem_max_rss": "96124928", "process_out_blocks": "0", "process_user_time": 0.610384}
[0m13:53:43.308383 [debug] [MainThread]: Command `dbt run` failed at 13:53:43.308335 after 0.05 seconds
[0m13:53:43.308561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107732c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647e930>]}
[0m13:53:43.308722 [debug] [MainThread]: Flushing usage events
[0m13:53:44.729490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:53.517293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061859d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056da6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c8440>]}


============================== 13:53:53.520152 | 577eb933-c4ae-441b-84cd-e4bee00cf529 ==============================
[0m13:53:53.520152 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:53:53.520471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'version_check': 'True', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:54.650143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '577eb933-c4ae-441b-84cd-e4bee00cf529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12131eae0>]}
[0m13:53:54.675966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '577eb933-c4ae-441b-84cd-e4bee00cf529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cbe0f0>]}
[0m13:53:54.676321 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:53:54.781972 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:53:54.844783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:54.845002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:54.860630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '577eb933-c4ae-441b-84cd-e4bee00cf529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216a8890>]}
[0m13:53:54.893246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:53:54.894570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:53:54.908072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '577eb933-c4ae-441b-84cd-e4bee00cf529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c7ee10>]}
[0m13:53:54.908331 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:53:54.908509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '577eb933-c4ae-441b-84cd-e4bee00cf529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b27c20>]}
[0m13:53:54.909414 [info ] [MainThread]: 
[0m13:53:54.909626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:54.909766 [info ] [MainThread]: 
[0m13:53:54.910001 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:54.911849 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:53:54.912074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:54.912273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:53:54.912613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:53:54.912792 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/credentials.json''
[0m13:53:54.912958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:54.913086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:54.913379 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/credentials.json''
[0m13:53:54.913541 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/credentials.json''
[0m13:53:54.913828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:54.913983 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/credentials.json''
[0m13:53:54.914137 [info ] [MainThread]: 
[0m13:53:54.914276 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m13:53:54.915053 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'final_project/dbt/dbt_dpd/credentials.json'
[0m13:53:54.915286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4340993, "process_in_blocks": "0", "process_kernel_time": 0.304052, "process_mem_max_rss": "214007808", "process_out_blocks": "0", "process_user_time": 1.316287}
[0m13:53:54.915542 [debug] [MainThread]: Command `dbt run` failed at 13:53:54.915495 after 1.43 seconds
[0m13:53:54.915708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f33bf0>]}
[0m13:53:54.915856 [debug] [MainThread]: Flushing usage events
[0m13:53:55.970967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:32.285915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104658920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104658470>]}


============================== 13:54:32.289168 | 58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e ==============================
[0m13:54:32.289168 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:54:32.289505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --target dev', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:33.519373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f44dbb0>]}
[0m13:54:33.548275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec036b0>]}
[0m13:54:33.548719 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:54:33.659531 [debug] [MainThread]: checksum: eea1a9e9f56a74d304aa4a9e5e9c8fc1dea4ccd2b0ec98e366756009c99c5c94, vars: {}, profile: , target: dev, version: 1.9.2
[0m13:54:33.722737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:33.722978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:33.739749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f7c80>]}
[0m13:54:33.774885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:54:33.776392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:54:33.791919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7b60f0>]}
[0m13:54:33.792239 [info ] [MainThread]: Found 7 models, 3 sources, 491 macros
[0m13:54:33.792429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f52e0>]}
[0m13:54:33.793390 [info ] [MainThread]: 
[0m13:54:33.793579 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:33.793716 [info ] [MainThread]: 
[0m13:54:33.793962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:33.795991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:54:33.796233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:33.796451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:54:33.796836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m13:54:33.797087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:33.797254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:35.252667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_preparation)
[0m13:54:35.254171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_dimfact)
[0m13:54:35.254893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_diego_dwh_library_marts)
[0m13:54:35.255466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:35.255986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:35.256429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:35.825403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eec3620>]}
[0m13:54:35.827116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:35.928843 [debug] [Thread-1 (]: Began running node model.dbt_dpd.prep_books
[0m13:54:35.929174 [debug] [Thread-2 (]: Began running node model.dbt_dpd.prep_rents
[0m13:54:35.929395 [debug] [Thread-3 (]: Began running node model.dbt_dpd.prep_users
[0m13:54:35.929865 [info ] [Thread-1 (]: 1 of 7 START sql incremental model diego_dwh_library_preparation.prep_books .... [RUN]
[0m13:54:35.930298 [info ] [Thread-2 (]: 2 of 7 START sql incremental model diego_dwh_library_preparation.prep_rents .... [RUN]
[0m13:54:35.930635 [info ] [Thread-3 (]: 3 of 7 START sql incremental model diego_dwh_library_preparation.prep_users .... [RUN]
[0m13:54:35.930943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_preparation, now model.dbt_dpd.prep_books)
[0m13:54:35.931188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_dimfact, now model.dbt_dpd.prep_rents)
[0m13:54:35.931374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_purwadika_diego_dwh_library_marts, now model.dbt_dpd.prep_users)
[0m13:54:35.931596 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.prep_books
[0m13:54:35.932490 [debug] [Thread-2 (]: Began compiling node model.dbt_dpd.prep_rents
[0m13:54:35.933193 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.prep_users
[0m13:54:35.989782 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dpd.prep_rents"
[0m13:54:35.991107 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.prep_books"
[0m13:54:35.991708 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.prep_users"
[0m13:54:35.993392 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.prep_users
[0m13:54:35.993706 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.prep_books
[0m13:54:36.000234 [debug] [Thread-2 (]: Began executing node model.dbt_dpd.prep_rents
[0m13:54:36.030580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:36.031283 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:36.033169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:36.645688 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.prep_users"
[0m13:54:36.646090 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dpd.prep_rents"
[0m13:54:36.646831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.prep_books"
[0m13:54:36.647554 [debug] [Thread-3 (]: On model.dbt_dpd.prep_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`users`
),

cleaned AS (
    SELECT
        user_id,
        name,
        email,
        gender,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:54:36.647917 [debug] [Thread-1 (]: On model.dbt_dpd.prep_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`books`
),

cleaned AS (
    SELECT
        book_id,
        title,
        author,
        release_year,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m13:54:36.648241 [debug] [Thread-2 (]: On model.dbt_dpd.prep_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.prep_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_preparation`.`prep_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_library_final_project`.`rents`
)

SELECT *
FROM source

    );
  
[0m13:54:36.950580 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:32be2bb1-a7a5-4aeb-b760-c7ccbad8d7c3&page=queryresults
[0m13:54:36.994679 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:861b6e30-f392-43b2-a6cd-e701d4209fd7&page=queryresults
[0m13:54:37.087078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b3b56ef3-3461-46b1-97e6-b76af0a2dc59&page=queryresults
[0m13:54:39.479834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa35040>]}
[0m13:54:39.481149 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_books  [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 3.55s]
[0m13:54:39.481718 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.prep_books
[0m13:54:39.482551 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dim_books
[0m13:54:39.483284 [info ] [Thread-4 (]: 4 of 7 START sql incremental model diego_dwh_library_dimfact.dim_books ......... [RUN]
[0m13:54:39.483725 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_dpd.dim_books'
[0m13:54:39.484011 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dim_books
[0m13:54:39.492087 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dim_books"
[0m13:54:39.493219 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dim_books
[0m13:54:39.496404 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:54:39.609719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdcb800>]}
[0m13:54:39.610236 [info ] [Thread-2 (]: 2 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_rents  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.68s]
[0m13:54:39.610599 [debug] [Thread-2 (]: Finished running node model.dbt_dpd.prep_rents
[0m13:54:39.718815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa6c4a0>]}
[0m13:54:39.719310 [info ] [Thread-3 (]: 3 of 7 OK created sql incremental model diego_dwh_library_preparation.prep_users  [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 3.79s]
[0m13:54:39.719732 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.prep_users
[0m13:54:39.720099 [debug] [Thread-1 (]: Began running node model.dbt_dpd.dim_users
[0m13:54:39.720488 [info ] [Thread-1 (]: 5 of 7 START sql incremental model diego_dwh_library_dimfact.dim_users ......... [RUN]
[0m13:54:39.720873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.prep_books, now model.dbt_dpd.dim_users)
[0m13:54:39.721102 [debug] [Thread-1 (]: Began compiling node model.dbt_dpd.dim_users
[0m13:54:39.723956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dpd.dim_users"
[0m13:54:39.724481 [debug] [Thread-1 (]: Began executing node model.dbt_dpd.dim_users
[0m13:54:39.726371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:39.960581 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dim_books"
[0m13:54:39.962352 [debug] [Thread-4 (]: On model.dbt_dpd.dim_books: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_books"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_books` 
)

SELECT * FROM books

    );
  
[0m13:54:40.087907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dpd.dim_users"
[0m13:54:40.089105 [debug] [Thread-1 (]: On model.dbt_dpd.dim_users: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dim_users"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_users`
)

SELECT * FROM source

    );
  
[0m13:54:40.210068 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:43db6025-d7c0-47a4-94b9-e73920711d20&page=queryresults
[0m13:54:40.408251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8954925c-0708-44da-8086-91c28a19a513&page=queryresults
[0m13:54:41.957239 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdaf050>]}
[0m13:54:41.959238 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_books .... [[32mCREATE TABLE (26.0 rows, 1.4 KiB processed)[0m in 2.47s]
[0m13:54:41.960142 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dim_books
[0m13:54:42.417222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe32de0>]}
[0m13:54:42.418556 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model diego_dwh_library_dimfact.dim_users .... [[32mCREATE TABLE (22.0 rows, 1.4 KiB processed)[0m in 2.70s]
[0m13:54:42.419564 [debug] [Thread-1 (]: Finished running node model.dbt_dpd.dim_users
[0m13:54:42.421757 [debug] [Thread-3 (]: Began running node model.dbt_dpd.fact_rents
[0m13:54:42.422806 [info ] [Thread-3 (]: 6 of 7 START sql incremental model diego_dwh_library_dimfact.fact_rents ........ [RUN]
[0m13:54:42.423627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.prep_users, now model.dbt_dpd.fact_rents)
[0m13:54:42.424226 [debug] [Thread-3 (]: Began compiling node model.dbt_dpd.fact_rents
[0m13:54:42.434495 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dpd.fact_rents"
[0m13:54:42.436750 [debug] [Thread-3 (]: Began executing node model.dbt_dpd.fact_rents
[0m13:54:42.440517 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:42.871036 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dpd.fact_rents"
[0m13:54:42.874258 [debug] [Thread-3 (]: On model.dbt_dpd.fact_rents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.fact_rents"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH dim_books AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
),

dim_users AS (

    SELECT * 
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

rents_staging AS (

    SELECT *
    FROM `purwadika`.`diego_dwh_library_preparation`.`prep_rents`
)

SELECT
rents_staging.rent_id,
rents_staging.rent_date AS rent_date,
rents_staging.return_date AS return_date,
dim_users.user_id,
dim_users.name AS user_name,
dim_users.email AS email,
dim_books.book_id,
dim_books.title,
dim_books.author,
dim_books.release_year,
rents_staging.created_at

FROM rents_staging

LEFT JOIN dim_users
on rents_staging.user_id = dim_users.user_id

LEFT JOIN dim_books
on rents_staging.book_id = dim_books.book_id


    );
  
[0m13:54:43.172020 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fce6d908-ecbc-4709-8e8f-8b7352c44b05&page=queryresults
[0m13:54:44.849933 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa6c4a0>]}
[0m13:54:44.850801 [info ] [Thread-3 (]: 6 of 7 OK created sql incremental model diego_dwh_library_dimfact.fact_rents ... [[32mCREATE TABLE (20.0 rows, 3.2 KiB processed)[0m in 2.43s]
[0m13:54:44.851447 [debug] [Thread-3 (]: Finished running node model.dbt_dpd.fact_rents
[0m13:54:44.852340 [debug] [Thread-4 (]: Began running node model.dbt_dpd.dmart_user_book
[0m13:54:44.852951 [info ] [Thread-4 (]: 7 of 7 START sql incremental model diego_dwh_library_marts.dmart_user_book ..... [RUN]
[0m13:54:44.853467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dpd.dim_books, now model.dbt_dpd.dmart_user_book)
[0m13:54:44.853848 [debug] [Thread-4 (]: Began compiling node model.dbt_dpd.dmart_user_book
[0m13:54:44.858370 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dpd.dmart_user_book"
[0m13:54:44.859430 [debug] [Thread-4 (]: Began executing node model.dbt_dpd.dmart_user_book
[0m13:54:44.862555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:45.219232 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dpd.dmart_user_book"
[0m13:54:45.222011 [debug] [Thread-4 (]: On model.dbt_dpd.dmart_user_book: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_dpd", "target_name": "dev", "node_id": "model.dbt_dpd.dmart_user_book"} */

  
    

    create or replace table `purwadika`.`diego_dwh_library_marts`.`dmart_user_book`
      
    partition by rent_date
    

    OPTIONS()
    as (
      

WITH fact_rents AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`fact_rents`
),

dim_users AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_users`
),

dim_books AS (
    SELECT *
    FROM `purwadika`.`diego_dwh_library_dimfact`.`dim_books`
)

SELECT 
    fact_rents.user_id,
    fact_rents.user_name,
    dim_users.email,
    DATE(fact_rents.created_at) AS rent_date,
    COUNT(fact_rents.book_id) AS sum_of_book, -- Total jumlah buku yang disewa
    COALESCE(CEIL(AVG(GREATEST(DATE_DIFF(fact_rents.created_at, fact_rents.return_date, DAY),0))), 0) AS avg_rent_duration, -- Rata-rata lama peminjaman dalam hari
    COALESCE(MIN(dim_books.release_year), 0) AS oldest_book_rented, -- Tahun rilis buku tertua yang dipinjam oleh user
    fact_rents.created_at

FROM fact_rents 
LEFT JOIN dim_users  ON fact_rents.user_id = dim_users.user_id
LEFT JOIN dim_books  ON fact_rents.book_id = dim_books.book_id
GROUP BY fact_rents.user_id, fact_rents.user_name, dim_users.email, rent_date, fact_rents.created_at
    );
  
[0m13:54:45.646416 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b683433d-e0ae-4963-a3e2-7beaecfcf211&page=queryresults
[0m13:54:47.305718 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d5e6e8-b2a6-4f63-9ead-f5ee4ef1f96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe6b800>]}
[0m13:54:47.307184 [info ] [Thread-4 (]: 7 of 7 OK created sql incremental model diego_dwh_library_marts.dmart_user_book  [[32mCREATE TABLE (20.0 rows, 2.1 KiB processed)[0m in 2.45s]
[0m13:54:47.308021 [debug] [Thread-4 (]: Finished running node model.dbt_dpd.dmart_user_book
[0m13:54:47.311431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:47.396126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:47.396389 [debug] [MainThread]: Connection 'model.dbt_dpd.dim_users' was properly closed.
[0m13:54:47.396535 [debug] [MainThread]: Connection 'model.dbt_dpd.prep_rents' was properly closed.
[0m13:54:47.396660 [debug] [MainThread]: Connection 'model.dbt_dpd.fact_rents' was properly closed.
[0m13:54:47.396781 [debug] [MainThread]: Connection 'model.dbt_dpd.dmart_user_book' was properly closed.
[0m13:54:47.397036 [info ] [MainThread]: 
[0m13:54:47.397225 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m13:54:47.398045 [debug] [MainThread]: Command end result
[0m13:54:47.412199 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/manifest.json
[0m13:54:47.414042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/semantic_manifest.json
[0m13:54:47.418335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/Dewangga/Documents/purwa/final_project/dbt/dbt_dpd/target/run_results.json
[0m13:54:47.418561 [info ] [MainThread]: 
[0m13:54:47.418823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:47.418995 [info ] [MainThread]: 
[0m13:54:47.419177 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:54:47.419534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.180965, "process_in_blocks": "0", "process_kernel_time": 0.537262, "process_mem_max_rss": "204292096", "process_out_blocks": "0", "process_user_time": 2.945323}
[0m13:54:47.419892 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:47.419848 after 15.18 seconds
[0m13:54:47.420128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104658650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044be180>]}
[0m13:54:47.420298 [debug] [MainThread]: Flushing usage events
[0m13:54:48.956723 [debug] [MainThread]: An error was encountered while trying to flush usage events
